(()=>{var et=Object.create;var Se=Object.defineProperty;var tt=Object.getOwnPropertyDescriptor;var nt=Object.getOwnPropertyNames;var it=Object.getPrototypeOf,rt=Object.prototype.hasOwnProperty;var oe=(f,n)=>()=>(n||f((n={exports:{}}).exports,n),n.exports);var st=(f,n,e,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let d of nt(n))!rt.call(f,d)&&d!==e&&Se(f,d,{get:()=>n[d],enumerable:!(s=tt(n,d))||s.enumerable});return f};var ye=(f,n,e)=>(e=f!=null?et(it(f)):{},st(n||!f||!f.__esModule?Se(e,"default",{value:f,enumerable:!0}):e,f));var Oe=oe((Dt,pe)=>{(function(f,n){"use strict";var e=function(p,i){return new e.Instance(p,i||{})};e.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},e.HAS_POINTEREVENTS=f.navigator.pointerEnabled||f.navigator.msPointerEnabled,e.HAS_TOUCHEVENTS="ontouchstart"in f,e.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,e.NO_MOUSEEVENTS=e.HAS_TOUCHEVENTS&&f.navigator.userAgent.match(e.MOBILE_REGEX),e.EVENT_TYPES={},e.DIRECTION_DOWN="down",e.DIRECTION_LEFT="left",e.DIRECTION_UP="up",e.DIRECTION_RIGHT="right",e.POINTER_MOUSE="mouse",e.POINTER_TOUCH="touch",e.POINTER_PEN="pen",e.UPDATE_VELOCITY_INTERVAL=20,e.EVENT_START="start",e.EVENT_MOVE="move",e.EVENT_END="end",e.DOCUMENT=f.document,e.plugins=e.plugins||{},e.gestures=e.gestures||{},e.READY=!1;function s(){e.READY||(e.event.determineEventTypes(),e.utils.each(e.gestures,function(p){e.detection.register(p)}),e.event.onTouch(e.DOCUMENT,e.EVENT_MOVE,e.detection.detect),e.event.onTouch(e.DOCUMENT,e.EVENT_END,e.detection.detect),e.READY=!0)}e.utils={extend:function(i,u,a){for(var l in u)i[l]!==n&&a||(i[l]=u[l]);return i},each:function(p,i,u){var a,l;if("forEach"in p)p.forEach(i,u);else if(p.length!==n){for(a=0,l=p.length;a<l;a++)if(i.call(u,p[a],a,p)===!1)return}else for(a in p)if(p.hasOwnProperty(a)&&i.call(u,p[a],a,p)===!1)return},hasParent:function(p,i){for(;p;){if(p==i)return!0;p=p.parentNode}return!1},getCenter:function(i){var u=[],a=[];return e.utils.each(i,function(l){u.push(typeof l.clientX<"u"?l.clientX:l.pageX),a.push(typeof l.clientY<"u"?l.clientY:l.pageY)}),{pageX:(Math.min.apply(Math,u)+Math.max.apply(Math,u))/2,pageY:(Math.min.apply(Math,a)+Math.max.apply(Math,a))/2}},getVelocity:function(i,u,a){return{x:Math.abs(u/i)||0,y:Math.abs(a/i)||0}},getAngle:function(i,u){var a=u.pageY-i.pageY,l=u.pageX-i.pageX;return Math.atan2(a,l)*180/Math.PI},getDirection:function(i,u){var a=Math.abs(i.pageX-u.pageX),l=Math.abs(i.pageY-u.pageY);return a>=l?i.pageX-u.pageX>0?e.DIRECTION_LEFT:e.DIRECTION_RIGHT:i.pageY-u.pageY>0?e.DIRECTION_UP:e.DIRECTION_DOWN},getDistance:function(i,u){var a=u.pageX-i.pageX,l=u.pageY-i.pageY;return Math.sqrt(a*a+l*l)},getScale:function(i,u){return i.length>=2&&u.length>=2?this.getDistance(u[0],u[1])/this.getDistance(i[0],i[1]):1},getRotation:function(i,u){return i.length>=2&&u.length>=2?this.getAngle(u[1],u[0])-this.getAngle(i[1],i[0]):0},isVertical:function(i){return i==e.DIRECTION_UP||i==e.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(i,u){!u||!i||!i.style||(e.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(a){e.utils.each(u,function(l,y){a&&(y=a+y.substring(0,1).toUpperCase()+y.substring(1)),y in i.style&&(i.style[y]=l)})}),u.userSelect=="none"&&(i.onselectstart=function(){return!1}),u.userDrag=="none"&&(i.ondragstart=function(){return!1}))},startDefaultBrowserBehavior:function(i,u){!u||!i||!i.style||(e.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(a){e.utils.each(u,function(l,y){a&&(y=a+y.substring(0,1).toUpperCase()+y.substring(1)),y in i.style&&(i.style[y]="")})}),u.userSelect=="none"&&(i.onselectstart=null),u.userDrag=="none"&&(i.ondragstart=null))}},e.Instance=function(p,i){var u=this;return s(),this.element=p,this.enabled=!0,this.options=e.utils.extend(e.utils.extend({},e.defaults),i||{}),this.options.stop_browser_behavior&&e.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),this._eventStartHandler=e.event.onTouch(p,e.EVENT_START,function(a){u.enabled&&e.detection.startDetect(u,a)}),this._eventHandler=[],this},e.Instance.prototype={on:function(i,u){var a=i.split(" ");return e.utils.each(a,function(l){this.element.addEventListener(l,u,!1),this._eventHandler.push({gesture:l,handler:u})},this),this},off:function(i,u){var a=i.split(" ");return e.utils.each(a,function(l){this.element.removeEventListener(l,u,!1);var y=-1;e.utils.each(this._eventHandler,function(b,P){y===-1&&b.gesture===l&&b.handler===u&&(y=P)},this),y>-1&&this._eventHandler.splice(y,1)},this),this},trigger:function(i,u){u||(u={});var a=e.DOCUMENT.createEvent("Event");a.initEvent(i,!0,!0),a.gesture=u;var l=this.element;return e.utils.hasParent(u.target,l)&&(l=u.target),l.dispatchEvent(a),this},enable:function(i){return this.enabled=i,this},dispose:function(){return this.options.stop_browser_behavior&&e.utils.startDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),e.utils.each(this._eventHandler,function(i){this.element.removeEventListener(i.gesture,i.handler,!1)},this),this._eventHandler.length=0,e.event.unbindDom(this.element,e.EVENT_TYPES[e.EVENT_START],this._eventStartHandler),this}};var d=null,E=!1,v=!1;e.event={bindDom:function(p,i,u){var a=i.split(" ");e.utils.each(a,function(l){p.addEventListener(l,u,!1)})},unbindDom:function(p,i,u){var a=i.split(" ");e.utils.each(a,function(l){p.removeEventListener(l,u,!1)})},onTouch:function(i,u,a){var l=this,y=function(P){var S=P.type.toLowerCase();if(!(S.match(/mouse/)&&v)){S.match(/touch/)||S.match(/pointerdown/)||S.match(/mouse/)&&P.which===1?E=!0:S.match(/mouse/)&&!P.which&&(E=!1),S.match(/touch|pointer/)&&(v=!0);var x=0;E&&(e.HAS_POINTEREVENTS&&u!=e.EVENT_END?x=e.PointerEvent.updatePointer(u,P):S.match(/touch/)?x=P.touches.length:v||(x=S.match(/up/)?0:1),x>0&&u==e.EVENT_END?u=e.EVENT_MOVE:x||(u=e.EVENT_END),(x||d===null)&&(d=P),a.call(e.detection,l.collectEventData(i,u,l.getTouchList(d,u),P)),e.HAS_POINTEREVENTS&&u==e.EVENT_END&&(x=e.PointerEvent.updatePointer(u,P))),x||(d=null,E=!1,v=!1,e.PointerEvent.reset())}};return this.bindDom(i,e.EVENT_TYPES[u],y),y},determineEventTypes:function(){var i;e.HAS_POINTEREVENTS?i=e.PointerEvent.getEvents():e.NO_MOUSEEVENTS?i=["touchstart","touchmove","touchend touchcancel"]:i=["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],e.EVENT_TYPES[e.EVENT_START]=i[0],e.EVENT_TYPES[e.EVENT_MOVE]=i[1],e.EVENT_TYPES[e.EVENT_END]=i[2]},getTouchList:function(i){return e.HAS_POINTEREVENTS?e.PointerEvent.getTouchList():i.touches?i.touches:(i.identifier=1,[i])},collectEventData:function(i,u,a,l){var y=e.POINTER_TOUCH;return(l.type.match(/mouse/)||e.PointerEvent.matchType(e.POINTER_MOUSE,l))&&(y=e.POINTER_MOUSE),{center:e.utils.getCenter(a),timeStamp:new Date().getTime(),target:l.target,touches:a,eventType:u,pointerType:y,srcEvent:l,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return e.detection.stopDetect()}}}},e.PointerEvent={pointers:{},getTouchList:function(){var p=this,i=[];return e.utils.each(p.pointers,function(u){i.push(u)}),i},updatePointer:function(p,i){return p==e.EVENT_END?delete this.pointers[i.pointerId]:(i.identifier=i.pointerId,this.pointers[i.pointerId]=i),Object.keys(this.pointers).length},matchType:function(p,i){if(!i.pointerType)return!1;var u=i.pointerType,a={};return a[e.POINTER_MOUSE]=u===i.MSPOINTER_TYPE_MOUSE||u===e.POINTER_MOUSE,a[e.POINTER_TOUCH]=u===i.MSPOINTER_TYPE_TOUCH||u===e.POINTER_TOUCH,a[e.POINTER_PEN]=u===i.MSPOINTER_TYPE_PEN||u===e.POINTER_PEN,a[p]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},e.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(i,u){this.current||(this.stopped=!1,this.current={inst:i,startEvent:e.utils.extend({},u),lastEvent:!1,lastVEvent:!1,velocity:!1,name:""},this.detect(u))},detect:function(i){if(!(!this.current||this.stopped)){i=this.extendEventData(i);var u=this.current.inst.options;return e.utils.each(this.gestures,function(a){if(!this.stopped&&u[a.name]!==!1&&a.handler.call(a,i,this.current.inst)===!1)return this.stopDetect(),!1},this),this.current&&(this.current.lastEvent=i),i.eventType==e.EVENT_END&&!i.touches.length-1&&this.stopDetect(),i}},stopDetect:function(){this.previous=e.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(i){var u=this.current.startEvent,a=this.current.lastVEvent;u&&(i.touches.length!=u.touches.length||i.touches===u.touches)&&(u.touches=[],e.utils.each(i.touches,function(F){u.touches.push(e.utils.extend({},F))}));var l=i.timeStamp-u.timeStamp,y=i.center.pageX-u.center.pageX,b=i.center.pageY-u.center.pageY,P,S,x=this.current.velocity;return a!==!1&&i.timeStamp-a.timeStamp>e.UPDATE_VELOCITY_INTERVAL?(x=e.utils.getVelocity(i.timeStamp-a.timeStamp,i.center.pageX-a.center.pageX,i.center.pageY-a.center.pageY),this.current.lastVEvent=i,x.x>0&&x.y>0&&(this.current.velocity=x)):this.current.velocity===!1&&(x=e.utils.getVelocity(l,y,b),this.current.velocity=x,this.current.lastVEvent=i),i.eventType==="end"?(P=this.current.lastEvent&&this.current.lastEvent.interimAngle,S=this.current.lastEvent&&this.current.lastEvent.interimDirection):(P=this.current.lastEvent&&e.utils.getAngle(this.current.lastEvent.center,i.center),S=this.current.lastEvent&&e.utils.getDirection(this.current.lastEvent.center,i.center)),e.utils.extend(i,{deltaTime:l,deltaX:y,deltaY:b,velocityX:x.x,velocityY:x.y,distance:e.utils.getDistance(u.center,i.center),angle:e.utils.getAngle(u.center,i.center),interimAngle:P,direction:e.utils.getDirection(u.center,i.center),interimDirection:S,scale:e.utils.getScale(u.touches,i.touches),rotation:e.utils.getRotation(u.touches,i.touches),startEvent:u}),i},register:function(i){var u=i.defaults||{};return u[i.name]===n&&(u[i.name]=!0),e.utils.extend(e.defaults,u,!0),i.index=i.index||1e3,this.gestures.push(i),this.gestures.sort(function(a,l){return a.index<l.index?-1:a.index>l.index?1:0}),this.gestures}},e.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(i,u){if(e.detection.current.name!=this.name&&this.triggered){u.trigger(this.name+"end",i),this.triggered=!1;return}if(!(u.options.drag_max_touches>0&&i.touches.length>u.options.drag_max_touches))switch(i.eventType){case e.EVENT_START:this.triggered=!1;break;case e.EVENT_MOVE:if(i.distance<u.options.drag_min_distance&&e.detection.current.name!=this.name)return;if(e.detection.current.name!=this.name&&(e.detection.current.name=this.name,u.options.correct_for_drag_min_distance&&i.distance>0)){var a=Math.abs(u.options.drag_min_distance/i.distance);e.detection.current.startEvent.center.pageX+=i.deltaX*a,e.detection.current.startEvent.center.pageY+=i.deltaY*a,i=e.detection.extendEventData(i)}(e.detection.current.lastEvent.drag_locked_to_axis||u.options.drag_lock_to_axis&&u.options.drag_lock_min_distance<=i.distance)&&(i.drag_locked_to_axis=!0);var l=e.detection.current.lastEvent.direction;i.drag_locked_to_axis&&l!==i.direction&&(e.utils.isVertical(l)?i.direction=i.deltaY<0?e.DIRECTION_UP:e.DIRECTION_DOWN:i.direction=i.deltaX<0?e.DIRECTION_LEFT:e.DIRECTION_RIGHT),this.triggered||(u.trigger(this.name+"start",i),this.triggered=!0),u.trigger(this.name,i),u.trigger(this.name+i.direction,i),(u.options.drag_block_vertical&&e.utils.isVertical(i.direction)||u.options.drag_block_horizontal&&!e.utils.isVertical(i.direction))&&i.preventDefault();break;case e.EVENT_END:this.triggered&&u.trigger(this.name+"end",i),this.triggered=!1;break}}},e.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(i,u){switch(i.eventType){case e.EVENT_START:clearTimeout(this.timer),e.detection.current.name=this.name,this.timer=setTimeout(function(){e.detection.current.name=="hold"&&u.trigger("hold",i)},u.options.hold_timeout);break;case e.EVENT_MOVE:i.distance>u.options.hold_threshold&&clearTimeout(this.timer);break;case e.EVENT_END:clearTimeout(this.timer);break}}},e.gestures.Release={name:"release",index:1/0,handler:function(i,u){i.eventType==e.EVENT_END&&u.trigger(this.name,i)}},e.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(i,u){if(i.eventType==e.EVENT_END){if(u.options.swipe_max_touches>0&&i.touches.length<u.options.swipe_min_touches&&i.touches.length>u.options.swipe_max_touches)return;(i.velocityX>u.options.swipe_velocity||i.velocityY>u.options.swipe_velocity)&&(u.trigger(this.name,i),u.trigger(this.name+i.direction,i))}}},e.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(i,u){if(i.eventType==e.EVENT_MOVE&&!e.detection.current.reachedTapMaxDistance)e.detection.current.reachedTapMaxDistance=i.distance>u.options.tap_max_distance;else if(i.eventType==e.EVENT_END&&i.srcEvent.type!="touchcancel"){var a=e.detection.previous,l=!1;if(e.detection.current.reachedTapMaxDistance||i.deltaTime>u.options.tap_max_touchtime)return;a&&a.name=="tap"&&i.timeStamp-a.lastEvent.timeStamp<u.options.doubletap_interval&&i.distance<u.options.doubletap_distance&&(u.trigger("doubletap",i),l=!0),(!l||u.options.tap_always)&&(e.detection.current.name="tap",u.trigger(e.detection.current.name,i))}}},e.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(i,u){if(u.options.prevent_mouseevents&&i.pointerType==e.POINTER_MOUSE){i.stopDetect();return}u.options.prevent_default&&i.preventDefault(),i.eventType==e.EVENT_START&&u.trigger(this.name,i)}},e.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(i,u){if(e.detection.current.name!=this.name&&this.triggered){u.trigger(this.name+"end",i),this.triggered=!1;return}if(!(i.touches.length<2))switch(u.options.transform_always_block&&i.preventDefault(),i.eventType){case e.EVENT_START:this.triggered=!1;break;case e.EVENT_MOVE:var a=Math.abs(1-i.scale),l=Math.abs(i.rotation);if(a<u.options.transform_min_scale&&l<u.options.transform_min_rotation)return;e.detection.current.name=this.name,this.triggered||(u.trigger(this.name+"start",i),this.triggered=!0),u.trigger(this.name,i),l>u.options.transform_min_rotation&&u.trigger("rotate",i),a>u.options.transform_min_scale&&(u.trigger("pinch",i),u.trigger("pinch"+(i.scale<1?"in":"out"),i));break;case e.EVENT_END:this.triggered&&u.trigger(this.name+"end",i),this.triggered=!1;break}}},typeof define=="function"&&define.amd?define(function(){return e}):typeof pe=="object"&&pe.exports?pe.exports=e:f.Hammer=e})(window)});var xe=oe((Rt,de)=>{(function(){for(var f={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},n={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},e={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},s={option:"alt",command:"meta",return:"enter",escape:"esc"},d,E={},v={},p={},i,u=!1,a=!1,l=1;l<20;++l)f[111+l]="f"+l;for(l=0;l<=9;++l)f[l+96]=l;function y(m,_,O){if(m.addEventListener){m.addEventListener(_,O,!1);return}m.attachEvent("on"+_,O)}function b(m){return m.type=="keypress"?String.fromCharCode(m.which):f[m.which]?f[m.which]:n[m.which]?n[m.which]:String.fromCharCode(m.which).toLowerCase()}function P(m,_){return m.sort().join(",")===_.sort().join(",")}function S(m){m=m||{};var _=!1,O;for(O in p){if(m[O]){_=!0;continue}p[O]=0}_||(a=!1)}function x(m,_,O,D,G){var Y,B,k=[],$=O.type;if(!E[m])return[];for($=="keyup"&&H(m)&&(_=[m]),Y=0;Y<E[m].length;++Y)B=E[m][Y],!(B.seq&&p[B.seq]!=B.level)&&$==B.action&&($=="keypress"&&!O.metaKey&&!O.ctrlKey||P(_,B.modifiers))&&(D&&B.combo==G&&E[m].splice(Y,1),k.push(B));return k}function F(m){var _=[];return m.shiftKey&&_.push("shift"),m.altKey&&_.push("alt"),m.ctrlKey&&_.push("ctrl"),m.metaKey&&_.push("meta"),_}function X(m,_){m(_)===!1&&(_.preventDefault&&_.preventDefault(),_.stopPropagation&&_.stopPropagation(),_.returnValue=!1,_.cancelBubble=!0)}function te(m,_){if(!V.stopCallback(_,_.target||_.srcElement)){var O=x(m,F(_),_),D,G={},Y=!1;for(D=0;D<O.length;++D){if(O[D].seq){Y=!0,G[O[D].seq]=1,X(O[D].callback,_);continue}!Y&&!a&&X(O[D].callback,_)}_.type==a&&!H(m)&&S(G)}}function j(m){m.which=typeof m.which=="number"?m.which:m.keyCode;var _=b(m);if(_){if(m.type=="keyup"&&u==_){u=!1;return}te(_,m)}}function H(m){return m=="shift"||m=="ctrl"||m=="alt"||m=="meta"}function L(){clearTimeout(i),i=setTimeout(S,1e3)}function o(){if(!d){d={};for(var m in f)m>95&&m<112||f.hasOwnProperty(m)&&(d[f[m]]=m)}return d}function I(m,_,O){return O||(O=o()[m]?"keydown":"keypress"),O=="keypress"&&_.length&&(O="keydown"),O}function ne(m,_,O,D){p[m]=0,D||(D=I(_[0],[]));var G=function(k){a=D,++p[m],L()},Y=function(k){X(O,k),D!=="keyup"&&(u=b(k)),setTimeout(S,10)},B;for(B=0;B<_.length;++B)W(_[B],B<_.length-1?G:Y,D,m,B)}function W(m,_,O,D,G){m=m.replace(/\s+/g," ");var Y=m.split(" "),B,k,$,z=[];if(Y.length>1){ne(m,Y,_,O);return}for($=m==="+"?["+"]:m.split("+"),B=0;B<$.length;++B)k=$[B],s[k]&&(k=s[k]),O&&O!="keypress"&&e[k]&&(k=e[k],z.push("shift")),H(k)&&z.push(k);O=I(k,z,O),E[k]||(E[k]=[]),x(k,z,{type:O},!D,m),E[k][D?"unshift":"push"]({callback:_,modifiers:z,action:O,seq:D,level:G,combo:m})}function T(m,_,O){for(var D=0;D<m.length;++D)W(m[D],_,O)}y(document,"keypress",j),y(document,"keydown",j),y(document,"keyup",j);var V={bind:function(m,_,O){return T(m instanceof Array?m:[m],_,O),v[m+":"+O]=_,this},unbind:function(m,_){return v[m+":"+_]&&(delete v[m+":"+_],this.bind(m,function(){},_)),this},trigger:function(m,_){return v[m+":"+_](),this},reset:function(){return E={},v={},this},stopCallback:function(m,_){return(" "+_.className+" ").indexOf(" mousetrap ")>-1?!1:_.tagName=="INPUT"||_.tagName=="SELECT"||_.tagName=="TEXTAREA"||_.contentEditable&&_.contentEditable=="true"}};window.Mousetrap=V,typeof define=="function"&&define.amd&&define("mousetrap",function(){return V}),typeof de=="object"&&de.exports&&(de.exports=V)})()});var Ue=oe((qt,_e)=>{"use strict";var re=typeof Reflect=="object"?Reflect:null,Be=re&&typeof re.apply=="function"?re.apply:function(n,e,s){return Function.prototype.apply.call(n,e,s)},ge;re&&typeof re.ownKeys=="function"?ge=re.ownKeys:Object.getOwnPropertySymbols?ge=function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:ge=function(n){return Object.getOwnPropertyNames(n)};function ht(f){console&&console.warn&&console.warn(f)}var Le=Number.isNaN||function(n){return n!==n};function R(){R.init.call(this)}_e.exports=R;_e.exports.once=vt;R.EventEmitter=R;R.prototype._events=void 0;R.prototype._eventsCount=0;R.prototype._maxListeners=void 0;var ke=10;function ve(f){if(typeof f!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof f)}Object.defineProperty(R,"defaultMaxListeners",{enumerable:!0,get:function(){return ke},set:function(f){if(typeof f!="number"||f<0||Le(f))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+f+".");ke=f}});R.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};R.prototype.setMaxListeners=function(n){if(typeof n!="number"||n<0||Le(n))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+".");return this._maxListeners=n,this};function Ae(f){return f._maxListeners===void 0?R.defaultMaxListeners:f._maxListeners}R.prototype.getMaxListeners=function(){return Ae(this)};R.prototype.emit=function(n){for(var e=[],s=1;s<arguments.length;s++)e.push(arguments[s]);var d=n==="error",E=this._events;if(E!==void 0)d=d&&E.error===void 0;else if(!d)return!1;if(d){var v;if(e.length>0&&(v=e[0]),v instanceof Error)throw v;var p=new Error("Unhandled error."+(v?" ("+v.message+")":""));throw p.context=v,p}var i=E[n];if(i===void 0)return!1;if(typeof i=="function")Be(i,this,e);else for(var u=i.length,a=Xe(i,u),s=0;s<u;++s)Be(a[s],this,e);return!0};function He(f,n,e,s){var d,E,v;if(ve(e),E=f._events,E===void 0?(E=f._events=Object.create(null),f._eventsCount=0):(E.newListener!==void 0&&(f.emit("newListener",n,e.listener?e.listener:e),E=f._events),v=E[n]),v===void 0)v=E[n]=e,++f._eventsCount;else if(typeof v=="function"?v=E[n]=s?[e,v]:[v,e]:s?v.unshift(e):v.push(e),d=Ae(f),d>0&&v.length>d&&!v.warned){v.warned=!0;var p=new Error("Possible EventEmitter memory leak detected. "+v.length+" "+String(n)+" listeners added. Use emitter.setMaxListeners() to increase limit");p.name="MaxListenersExceededWarning",p.emitter=f,p.type=n,p.count=v.length,ht(p)}return f}R.prototype.addListener=function(n,e){return He(this,n,e,!1)};R.prototype.on=R.prototype.addListener;R.prototype.prependListener=function(n,e){return He(this,n,e,!0)};function pt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ve(f,n,e){var s={fired:!1,wrapFn:void 0,target:f,type:n,listener:e},d=pt.bind(s);return d.listener=e,s.wrapFn=d,d}R.prototype.once=function(n,e){return ve(e),this.on(n,Ve(this,n,e)),this};R.prototype.prependOnceListener=function(n,e){return ve(e),this.prependListener(n,Ve(this,n,e)),this};R.prototype.removeListener=function(n,e){var s,d,E,v,p;if(ve(e),d=this._events,d===void 0)return this;if(s=d[n],s===void 0)return this;if(s===e||s.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete d[n],d.removeListener&&this.emit("removeListener",n,s.listener||e));else if(typeof s!="function"){for(E=-1,v=s.length-1;v>=0;v--)if(s[v]===e||s[v].listener===e){p=s[v].listener,E=v;break}if(E<0)return this;E===0?s.shift():dt(s,E),s.length===1&&(d[n]=s[0]),d.removeListener!==void 0&&this.emit("removeListener",n,p||e)}return this};R.prototype.off=R.prototype.removeListener;R.prototype.removeAllListeners=function(n){var e,s,d;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[n]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[n]),this;if(arguments.length===0){var E=Object.keys(s),v;for(d=0;d<E.length;++d)v=E[d],v!=="removeListener"&&this.removeAllListeners(v);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=s[n],typeof e=="function")this.removeListener(n,e);else if(e!==void 0)for(d=e.length-1;d>=0;d--)this.removeListener(n,e[d]);return this};function Ye(f,n,e){var s=f._events;if(s===void 0)return[];var d=s[n];return d===void 0?[]:typeof d=="function"?e?[d.listener||d]:[d]:e?gt(d):Xe(d,d.length)}R.prototype.listeners=function(n){return Ye(this,n,!0)};R.prototype.rawListeners=function(n){return Ye(this,n,!1)};R.listenerCount=function(f,n){return typeof f.listenerCount=="function"?f.listenerCount(n):Fe.call(f,n)};R.prototype.listenerCount=Fe;function Fe(f){var n=this._events;if(n!==void 0){var e=n[f];if(typeof e=="function")return 1;if(e!==void 0)return e.length}return 0}R.prototype.eventNames=function(){return this._eventsCount>0?ge(this._events):[]};function Xe(f,n){for(var e=new Array(n),s=0;s<n;++s)e[s]=f[s];return e}function dt(f,n){for(;n+1<f.length;n++)f[n]=f[n+1];f.pop()}function gt(f){for(var n=new Array(f.length),e=0;e<n.length;++e)n[e]=f[e].listener||f[e];return n}function vt(f,n){return new Promise(function(e,s){function d(v){f.removeListener(n,E),s(v)}function E(){typeof f.removeListener=="function"&&f.removeListener("error",d),e([].slice.call(arguments))}We(f,n,E,{once:!0}),n!=="error"&&mt(f,d,{once:!0})})}function mt(f,n,e){typeof f.on=="function"&&We(f,"error",n,e)}function We(f,n,e,s){if(typeof f.on=="function")s.once?f.once(n,e):f.on(n,e);else if(typeof f.addEventListener=="function")f.addEventListener(n,function d(E){s.once&&f.removeEventListener(n,d),e(E)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof f)}});var qe=oe((ue,me)=>{(function(){var f=this,n=f._,e={},s=Array.prototype,d=Object.prototype,E=Function.prototype,v=s.push,p=s.slice,i=s.concat,u=d.toString,a=d.hasOwnProperty,l=s.forEach,y=s.map,b=s.reduce,P=s.reduceRight,S=s.filter,x=s.every,F=s.some,X=s.indexOf,te=s.lastIndexOf,j=Array.isArray,H=Object.keys,L=E.bind,o=function(t){if(t instanceof o)return t;if(!(this instanceof o))return new o(t);this._wrapped=t};typeof ue<"u"?(typeof me<"u"&&me.exports&&(ue=me.exports=o),ue._=o):f._=o,o.VERSION="1.6.0";var I=o.each=o.forEach=function(t,r,c){if(t==null)return t;if(l&&t.forEach===l)t.forEach(r,c);else if(t.length===+t.length){for(var h=0,g=t.length;h<g;h++)if(r.call(c,t[h],h,t)===e)return}else for(var w=o.keys(t),h=0,g=w.length;h<g;h++)if(r.call(c,t[w[h]],w[h],t)===e)return;return t};o.map=o.collect=function(t,r,c){var h=[];return t==null?h:y&&t.map===y?t.map(r,c):(I(t,function(g,w,M){h.push(r.call(c,g,w,M))}),h)};var ne="Reduce of empty array with no initial value";o.reduce=o.foldl=o.inject=function(t,r,c,h){var g=arguments.length>2;if(t==null&&(t=[]),b&&t.reduce===b)return h&&(r=o.bind(r,h)),g?t.reduce(r,c):t.reduce(r);if(I(t,function(w,M,N){g?c=r.call(h,c,w,M,N):(c=w,g=!0)}),!g)throw new TypeError(ne);return c},o.reduceRight=o.foldr=function(t,r,c,h){var g=arguments.length>2;if(t==null&&(t=[]),P&&t.reduceRight===P)return h&&(r=o.bind(r,h)),g?t.reduceRight(r,c):t.reduceRight(r);var w=t.length;if(w!==+w){var M=o.keys(t);w=M.length}if(I(t,function(N,C,A){C=M?M[--w]:--w,g?c=r.call(h,c,t[C],C,A):(c=t[C],g=!0)}),!g)throw new TypeError(ne);return c},o.find=o.detect=function(t,r,c){var h;return W(t,function(g,w,M){if(r.call(c,g,w,M))return h=g,!0}),h},o.filter=o.select=function(t,r,c){var h=[];return t==null?h:S&&t.filter===S?t.filter(r,c):(I(t,function(g,w,M){r.call(c,g,w,M)&&h.push(g)}),h)},o.reject=function(t,r,c){return o.filter(t,function(h,g,w){return!r.call(c,h,g,w)},c)},o.every=o.all=function(t,r,c){r||(r=o.identity);var h=!0;return t==null?h:x&&t.every===x?t.every(r,c):(I(t,function(g,w,M){if(!(h=h&&r.call(c,g,w,M)))return e}),!!h)};var W=o.some=o.any=function(t,r,c){r||(r=o.identity);var h=!1;return t==null?h:F&&t.some===F?t.some(r,c):(I(t,function(g,w,M){if(h||(h=r.call(c,g,w,M)))return e}),!!h)};o.contains=o.include=function(t,r){return t==null?!1:X&&t.indexOf===X?t.indexOf(r)!=-1:W(t,function(c){return c===r})},o.invoke=function(t,r){var c=p.call(arguments,2),h=o.isFunction(r);return o.map(t,function(g){return(h?r:g[r]).apply(g,c)})},o.pluck=function(t,r){return o.map(t,o.property(r))},o.where=function(t,r){return o.filter(t,o.matches(r))},o.findWhere=function(t,r){return o.find(t,o.matches(r))},o.max=function(t,r,c){if(!r&&o.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var h=-1/0,g=-1/0;return I(t,function(w,M,N){var C=r?r.call(c,w,M,N):w;C>g&&(h=w,g=C)}),h},o.min=function(t,r,c){if(!r&&o.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var h=1/0,g=1/0;return I(t,function(w,M,N){var C=r?r.call(c,w,M,N):w;C<g&&(h=w,g=C)}),h},o.shuffle=function(t){var r,c=0,h=[];return I(t,function(g){r=o.random(c++),h[c-1]=h[r],h[r]=g}),h},o.sample=function(t,r,c){return r==null||c?(t.length!==+t.length&&(t=o.values(t)),t[o.random(t.length-1)]):o.shuffle(t).slice(0,Math.max(0,r))};var T=function(t){return t==null?o.identity:o.isFunction(t)?t:o.property(t)};o.sortBy=function(t,r,c){return r=T(r),o.pluck(o.map(t,function(h,g,w){return{value:h,index:g,criteria:r.call(c,h,g,w)}}).sort(function(h,g){var w=h.criteria,M=g.criteria;if(w!==M){if(w>M||w===void 0)return 1;if(w<M||M===void 0)return-1}return h.index-g.index}),"value")};var V=function(t){return function(r,c,h){var g={};return c=T(c),I(r,function(w,M){var N=c.call(h,w,M,r);t(g,N,w)}),g}};o.groupBy=V(function(t,r,c){o.has(t,r)?t[r].push(c):t[r]=[c]}),o.indexBy=V(function(t,r,c){t[r]=c}),o.countBy=V(function(t,r){o.has(t,r)?t[r]++:t[r]=1}),o.sortedIndex=function(t,r,c,h){c=T(c);for(var g=c.call(h,r),w=0,M=t.length;w<M;){var N=w+M>>>1;c.call(h,t[N])<g?w=N+1:M=N}return w},o.toArray=function(t){return t?o.isArray(t)?p.call(t):t.length===+t.length?o.map(t,o.identity):o.values(t):[]},o.size=function(t){return t==null?0:t.length===+t.length?t.length:o.keys(t).length},o.first=o.head=o.take=function(t,r,c){if(t!=null)return r==null||c?t[0]:r<0?[]:p.call(t,0,r)},o.initial=function(t,r,c){return p.call(t,0,t.length-(r==null||c?1:r))},o.last=function(t,r,c){if(t!=null)return r==null||c?t[t.length-1]:p.call(t,Math.max(t.length-r,0))},o.rest=o.tail=o.drop=function(t,r,c){return p.call(t,r==null||c?1:r)},o.compact=function(t){return o.filter(t,o.identity)};var m=function(t,r,c){return r&&o.every(t,o.isArray)?i.apply(c,t):(I(t,function(h){o.isArray(h)||o.isArguments(h)?r?v.apply(c,h):m(h,r,c):c.push(h)}),c)};o.flatten=function(t,r){return m(t,r,[])},o.without=function(t){return o.difference(t,p.call(arguments,1))},o.partition=function(t,r){var c=[],h=[];return I(t,function(g){(r(g)?c:h).push(g)}),[c,h]},o.uniq=o.unique=function(t,r,c,h){o.isFunction(r)&&(h=c,c=r,r=!1);var g=c?o.map(t,c,h):t,w=[],M=[];return I(g,function(N,C){(r?!C||M[M.length-1]!==N:!o.contains(M,N))&&(M.push(N),w.push(t[C]))}),w},o.union=function(){return o.uniq(o.flatten(arguments,!0))},o.intersection=function(t){var r=p.call(arguments,1);return o.filter(o.uniq(t),function(c){return o.every(r,function(h){return o.contains(h,c)})})},o.difference=function(t){var r=i.apply(s,p.call(arguments,1));return o.filter(t,function(c){return!o.contains(r,c)})},o.zip=function(){for(var t=o.max(o.pluck(arguments,"length").concat(0)),r=new Array(t),c=0;c<t;c++)r[c]=o.pluck(arguments,""+c);return r},o.object=function(t,r){if(t==null)return{};for(var c={},h=0,g=t.length;h<g;h++)r?c[t[h]]=r[h]:c[t[h][0]]=t[h][1];return c},o.indexOf=function(t,r,c){if(t==null)return-1;var h=0,g=t.length;if(c)if(typeof c=="number")h=c<0?Math.max(0,g+c):c;else return h=o.sortedIndex(t,r),t[h]===r?h:-1;if(X&&t.indexOf===X)return t.indexOf(r,c);for(;h<g;h++)if(t[h]===r)return h;return-1},o.lastIndexOf=function(t,r,c){if(t==null)return-1;var h=c!=null;if(te&&t.lastIndexOf===te)return h?t.lastIndexOf(r,c):t.lastIndexOf(r);for(var g=h?c:t.length;g--;)if(t[g]===r)return g;return-1},o.range=function(t,r,c){arguments.length<=1&&(r=t||0,t=0),c=arguments[2]||1;for(var h=Math.max(Math.ceil((r-t)/c),0),g=0,w=new Array(h);g<h;)w[g++]=t,t+=c;return w};var _=function(){};o.bind=function(t,r){var c,h;if(L&&t.bind===L)return L.apply(t,p.call(arguments,1));if(!o.isFunction(t))throw new TypeError;return c=p.call(arguments,2),h=function(){if(!(this instanceof h))return t.apply(r,c.concat(p.call(arguments)));_.prototype=t.prototype;var g=new _;_.prototype=null;var w=t.apply(g,c.concat(p.call(arguments)));return Object(w)===w?w:g}},o.partial=function(t){var r=p.call(arguments,1);return function(){for(var c=0,h=r.slice(),g=0,w=h.length;g<w;g++)h[g]===o&&(h[g]=arguments[c++]);for(;c<arguments.length;)h.push(arguments[c++]);return t.apply(this,h)}},o.bindAll=function(t){var r=p.call(arguments,1);if(r.length===0)throw new Error("bindAll must be passed function names");return I(r,function(c){t[c]=o.bind(t[c],t)}),t},o.memoize=function(t,r){var c={};return r||(r=o.identity),function(){var h=r.apply(this,arguments);return o.has(c,h)?c[h]:c[h]=t.apply(this,arguments)}},o.delay=function(t,r){var c=p.call(arguments,2);return setTimeout(function(){return t.apply(null,c)},r)},o.defer=function(t){return o.delay.apply(o,[t,1].concat(p.call(arguments,1)))},o.throttle=function(t,r,c){var h,g,w,M=null,N=0;c||(c={});var C=function(){N=c.leading===!1?0:o.now(),M=null,w=t.apply(h,g),h=g=null};return function(){var A=o.now();!N&&c.leading===!1&&(N=A);var U=r-(A-N);return h=this,g=arguments,U<=0?(clearTimeout(M),M=null,N=A,w=t.apply(h,g),h=g=null):!M&&c.trailing!==!1&&(M=setTimeout(C,U)),w}},o.debounce=function(t,r,c){var h,g,w,M,N,C=function(){var A=o.now()-M;A<r?h=setTimeout(C,r-A):(h=null,c||(N=t.apply(w,g),w=g=null))};return function(){w=this,g=arguments,M=o.now();var A=c&&!h;return h||(h=setTimeout(C,r)),A&&(N=t.apply(w,g),w=g=null),N}},o.once=function(t){var r=!1,c;return function(){return r||(r=!0,c=t.apply(this,arguments),t=null),c}},o.wrap=function(t,r){return o.partial(r,t)},o.compose=function(){var t=arguments;return function(){for(var r=arguments,c=t.length-1;c>=0;c--)r=[t[c].apply(this,r)];return r[0]}},o.after=function(t,r){return function(){if(--t<1)return r.apply(this,arguments)}},o.keys=function(t){if(!o.isObject(t))return[];if(H)return H(t);var r=[];for(var c in t)o.has(t,c)&&r.push(c);return r},o.values=function(t){for(var r=o.keys(t),c=r.length,h=new Array(c),g=0;g<c;g++)h[g]=t[r[g]];return h},o.pairs=function(t){for(var r=o.keys(t),c=r.length,h=new Array(c),g=0;g<c;g++)h[g]=[r[g],t[r[g]]];return h},o.invert=function(t){for(var r={},c=o.keys(t),h=0,g=c.length;h<g;h++)r[t[c[h]]]=c[h];return r},o.functions=o.methods=function(t){var r=[];for(var c in t)o.isFunction(t[c])&&r.push(c);return r.sort()},o.extend=function(t){return I(p.call(arguments,1),function(r){if(r)for(var c in r)t[c]=r[c]}),t},o.pick=function(t){var r={},c=i.apply(s,p.call(arguments,1));return I(c,function(h){h in t&&(r[h]=t[h])}),r},o.omit=function(t){var r={},c=i.apply(s,p.call(arguments,1));for(var h in t)o.contains(c,h)||(r[h]=t[h]);return r},o.defaults=function(t){return I(p.call(arguments,1),function(r){if(r)for(var c in r)t[c]===void 0&&(t[c]=r[c])}),t},o.clone=function(t){return o.isObject(t)?o.isArray(t)?t.slice():o.extend({},t):t},o.tap=function(t,r){return r(t),t};var O=function(t,r,c,h){if(t===r)return t!==0||1/t==1/r;if(t==null||r==null)return t===r;t instanceof o&&(t=t._wrapped),r instanceof o&&(r=r._wrapped);var g=u.call(t);if(g!=u.call(r))return!1;switch(g){case"[object String]":return t==String(r);case"[object Number]":return t!=+t?r!=+r:t==0?1/t==1/r:t==+r;case"[object Date]":case"[object Boolean]":return+t==+r;case"[object RegExp]":return t.source==r.source&&t.global==r.global&&t.multiline==r.multiline&&t.ignoreCase==r.ignoreCase}if(typeof t!="object"||typeof r!="object")return!1;for(var w=c.length;w--;)if(c[w]==t)return h[w]==r;var M=t.constructor,N=r.constructor;if(M!==N&&!(o.isFunction(M)&&M instanceof M&&o.isFunction(N)&&N instanceof N)&&"constructor"in t&&"constructor"in r)return!1;c.push(t),h.push(r);var C=0,A=!0;if(g=="[object Array]"){if(C=t.length,A=C==r.length,A)for(;C--&&(A=O(t[C],r[C],c,h)););}else{for(var U in t)if(o.has(t,U)&&(C++,!(A=o.has(r,U)&&O(t[U],r[U],c,h))))break;if(A){for(U in r)if(o.has(r,U)&&!C--)break;A=!C}}return c.pop(),h.pop(),A};o.isEqual=function(t,r){return O(t,r,[],[])},o.isEmpty=function(t){if(t==null)return!0;if(o.isArray(t)||o.isString(t))return t.length===0;for(var r in t)if(o.has(t,r))return!1;return!0},o.isElement=function(t){return!!(t&&t.nodeType===1)},o.isArray=j||function(t){return u.call(t)=="[object Array]"},o.isObject=function(t){return t===Object(t)},I(["Arguments","Function","String","Number","Date","RegExp"],function(t){o["is"+t]=function(r){return u.call(r)=="[object "+t+"]"}}),o.isArguments(arguments)||(o.isArguments=function(t){return!!(t&&o.has(t,"callee"))}),typeof/./!="function"&&(o.isFunction=function(t){return typeof t=="function"}),o.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},o.isNaN=function(t){return o.isNumber(t)&&t!=+t},o.isBoolean=function(t){return t===!0||t===!1||u.call(t)=="[object Boolean]"},o.isNull=function(t){return t===null},o.isUndefined=function(t){return t===void 0},o.has=function(t,r){return a.call(t,r)},o.noConflict=function(){return f._=n,this},o.identity=function(t){return t},o.constant=function(t){return function(){return t}},o.property=function(t){return function(r){return r[t]}},o.matches=function(t){return function(r){if(r===t)return!0;for(var c in t)if(t[c]!==r[c])return!1;return!0}},o.times=function(t,r,c){for(var h=Array(Math.max(0,t)),g=0;g<t;g++)h[g]=r.call(c,g);return h},o.random=function(t,r){return r==null&&(r=t,t=0),t+Math.floor(Math.random()*(r-t+1))},o.now=Date.now||function(){return new Date().getTime()};var D={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};D.unescape=o.invert(D.escape);var G={escape:new RegExp("["+o.keys(D.escape).join("")+"]","g"),unescape:new RegExp("("+o.keys(D.unescape).join("|")+")","g")};o.each(["escape","unescape"],function(t){o[t]=function(r){return r==null?"":(""+r).replace(G[t],function(c){return D[t][c]})}}),o.result=function(t,r){if(t!=null){var c=t[r];return o.isFunction(c)?c.call(t):c}},o.mixin=function(t){I(o.functions(t),function(r){var c=o[r]=t[r];o.prototype[r]=function(){var h=[this._wrapped];return v.apply(h,arguments),z.call(this,c.apply(o,h))}})};var Y=0;o.uniqueId=function(t){var r=++Y+"";return t?t+r:r},o.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var B=/(.)^/,k={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},$=/\\|'|\r|\n|\t|\u2028|\u2029/g;o.template=function(t,r,c){var h;c=o.defaults({},c,o.templateSettings);var g=new RegExp([(c.escape||B).source,(c.interpolate||B).source,(c.evaluate||B).source].join("|")+"|$","g"),w=0,M="__p+='";t.replace(g,function(C,A,U,Me,Pe){return M+=t.slice(w,Pe).replace($,function(je){return"\\"+k[je]}),A&&(M+=`'+
((__t=(`+A+`))==null?'':_.escape(__t))+
'`),U&&(M+=`'+
((__t=(`+U+`))==null?'':__t)+
'`),Me&&(M+=`';
`+Me+`
__p+='`),w=Pe+C.length,C}),M+=`';
`,c.variable||(M=`with(obj||{}){
`+M+`}
`),M=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+M+`return __p;
`;try{h=new Function(c.variable||"obj","_",M)}catch(C){throw C.source=M,C}if(r)return h(r,o);var N=function(C){return h.call(this,C,o)};return N.source="function("+(c.variable||"obj")+`){
`+M+"}",N},o.chain=function(t){return o(t).chain()};var z=function(t){return this._chain?o(t).chain():t};o.mixin(o),I(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var r=s[t];o.prototype[t]=function(){var c=this._wrapped;return r.apply(c,arguments),(t=="shift"||t=="splice")&&c.length===0&&delete c[0],z.call(this,c)}}),I(["concat","join","slice"],function(t){var r=s[t];o.prototype[t]=function(){return z.call(this,r.apply(this._wrapped,arguments))}}),o.extend(o.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),typeof define=="function"&&define.amd&&define("underscore",[],function(){return o})}).call(ue)});var Ge=oe((fe,Ee)=>{(function(){var s=this,f=Ue().EventEmitter,n=qe(),e=/([0-9\.]+)(ms|s|m|h)?/,s=globalThis||window;typeof Function.prototype.inherits>"u"&&(Function.prototype.inherits=function(p){this.prototype=Object.create(p.prototype)}),typeof Array.prototype.removeOne>"u"&&(Array.prototype.removeOne=function(){for(var p,i=arguments,u=i.length,a;u&&this.length;)for(p=i[--u];(a=this.indexOf(p))!==-1;)return this.splice(a,1)});function d(p){for(var i=1,u=n.min(p);i!==0;)i=n.reduce(p,function(a,l){return a+l%u},0),i!==0&&(u-=10);return u}function E(p){var i=e.exec(p);if(!i)throw new Error("I don't understand that particular interval");var u=+i[1],a=i[2]||"ms";if(a==="s")u=u*1e3;else if(a==="m")u=u*1e3*60;else if(a==="h")u=u*1e3*60*60;else if(a&&a!=="ms")throw new Error("You can only specify intervals of ms, s, m, or h");if(u<10||u%10!==0)throw new Error("You can only specify 10s of milliseconds, trust me on this one");return{amount:u,type:a}}function v(){this.intervalId=void 0,this.intervalLength=void 0,this.intervalsToEmit={},this.currentTick=1,this.maxTicks=0,this.listeningForFocus=!1;var p=function(){var i=d(n.keys(this.intervalsToEmit)),u=!1;return this.intervalLength?i!==this.intervalLength&&(this.intervalLength=i,u=!0):this.intervalLength=i,this.maxTicks=n.max(n.map(n.keys(this.intervalsToEmit),function(a){return+a}))/this.intervalLength,u}.bind(this);this.on("newListener",function(i){if(!(i==="removeListener"||i==="newListener")){var u=E(i),a=u.amount;this.intervalsToEmit[+a]=n.union(this.intervalsToEmit[+a]||[],[i]),p()&&this.isStarted()&&this.stop().start()}}),this.on("removeListener",function(i){if(!(f.listenerCount(this,i)>0)){var u=E(i),a=u.amount,l=this.intervalsToEmit[+a].removeOne(i);this.intervalsToEmit[+a].length===0&&delete this.intervalsToEmit[+a],console.log("Determining interval length after removal of",l),p(),p()&&this.isStarted()&&this.stop().start()}})}v.inherits(f),v.prototype.tick=function(){var p=this.currentTick*this.intervalLength;return n.each(this.intervalsToEmit,function(i,u){p%u===0&&n.each(i,function(a){this.emit(a,a,u)}.bind(this))}.bind(this)),this.currentTick+=1,this.currentTick>this.maxTicks&&(this.currentTick=1),this},v.prototype.start=function(){if(!this.intervalLength)throw new Error("You haven't specified any interval callbacks. Use EventedLoop.on('500ms', function () { ... }) to do so, and then you can start");return this.intervalId?console.log("No need to start the loop again, it's already started."):(this.intervalId=setInterval(this.tick.bind(this),this.intervalLength),s&&!this.listeningForFocus&&s.addEventListener&&(s.addEventListener("focus",function(){this.start()}.bind(this)),s.addEventListener("blur",function(){this.stop()}.bind(this)),this.listeningForFocus=!0),this)},v.prototype.stop=function(){return clearInterval(this.intervalId),this.intervalId=void 0,this},v.prototype.isStarted=function(){return!!this.intervalId},v.prototype.every=v.prototype.on,typeof fe<"u"&&(typeof Ee<"u"&&Ee.exports&&(fe=Ee.exports=v),fe.EventedLoop=v),typeof window<"u"&&(window.EventedLoop=v)}).call(fe)});CanvasRenderingContext2D.prototype.storeLoadedImage=function(f,n){this.images||(this.images={}),this.images[f]=n};CanvasRenderingContext2D.prototype.getLoadedImage=function(f){if(this.images[f])return this.images[f]};CanvasRenderingContext2D.prototype.followSprite=function(f){this.centralSprite=f};CanvasRenderingContext2D.prototype.getCentralPosition=function(){return{map:this.centralSprite.mapPosition,canvas:[Math.round(this.canvas.width*.5),Math.round(this.canvas.height*.5),0]}};CanvasRenderingContext2D.prototype.mapPositionToCanvasPosition=function(f){var n=this.getCentralPosition(),e=n.map,s=n.canvas,d=e[0]-f[0],E=e[1]-f[1];return[s[0]-d,s[1]-E]};CanvasRenderingContext2D.prototype.canvasPositionToMapPosition=function(f){var n=this.getCentralPosition(),e=n.map,s=n.canvas,d=s[0]-f[0],E=s[1]-f[1];return[e[0]-d,e[1]-E]};CanvasRenderingContext2D.prototype.getCentreOfViewport=function(){return Math.floor(this.canvas.width/2)};CanvasRenderingContext2D.prototype.getMiddleOfViewport=function(){return Math.floor(this.canvas.height/2)};CanvasRenderingContext2D.prototype.getBelowViewport=function(){return Math.floor(this.canvas.height)};CanvasRenderingContext2D.prototype.getMapBelowViewport=function(){var f=this.getBelowViewport();return this.canvasPositionToMapPosition([0,f])[1]};CanvasRenderingContext2D.prototype.getRandomlyInTheCentreOfCanvas=function(f){var n=0,e=this.canvas.width;return f&&(n-=f,e+=f),Math.floor(Math.random()*(e-n+1))+n};CanvasRenderingContext2D.prototype.getRandomlyInTheCentreOfMap=function(f){var n=this.getRandomlyInTheCentreOfCanvas(f);return this.canvasPositionToMapPosition([n,0])[0]};CanvasRenderingContext2D.prototype.getRandomMapPositionBelowViewport=function(){var f=this.getRandomlyInTheCentreOfCanvas(),n=this.getBelowViewport();return this.canvasPositionToMapPosition([f,n])};CanvasRenderingContext2D.prototype.getRandomMapPositionAboveViewport=function(){var f=this.getRandomlyInTheCentreOfCanvas(),n=this.getAboveViewport();return this.canvasPositionToMapPosition([f,n])};CanvasRenderingContext2D.prototype.getTopOfViewport=function(){return this.canvasPositionToMapPosition([0,0])[1]};CanvasRenderingContext2D.prototype.getAboveViewport=function(){return 0-Math.floor(this.canvas.height/4)};Function.prototype.method=function(f,n){return Object.defineProperty(this.prototype,f,{value:n,enumerable:!1,writable:!0,configurable:!0}),this};Object.method("superior",function(f){var n=this,e=n[f];return function(){return e.apply(n,arguments)}});(function(){for(var f,n=function(){},e=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],s=e.length,d=window.console=window.console||{};s--;)f=e[s],d[f]||(d[f]=n)})();var Ze=ye(Oe(),1),J=ye(xe(),1);function ot(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}var Ce=ot;function ae(){return this.pushHandlers=[],this}ae.prototype=Object.create(Array.prototype);ae.prototype.onPush=function(f,n){this.pushHandlers.push(f),n&&this.forEach(f)};ae.prototype.push=function(f){Array.prototype.push.call(this,f),this.pushHandlers.forEach(function(n){n(f)})};ae.prototype.cull=function(){this.forEach(function(f,n){if(f.deleted)return delete this[n]})};var ie=ae;function at(){var f=function(){return Math.floor(Math.random()*65536).toString(16)};return f()+f()+"-"+f()+"-"+f()+"-"+f()+"-"+f()+f()+f()}var be=at;function we(f){var n={},e=[0],s=this,d;s.direction=void 0,s.mapPosition=[0,0,0],s.id=be(),s.canvasX=0,s.canvasY=0,s.canvasZ=0,s.height=0,s.speed=0,s.data=f||{parts:{}},s.movingToward=[0,0],s.metresDownTheMountain=0,s.movingWithConviction=!1,s.deleted=!1,s.data.parts||(s.data.parts={}),s.maxHeight=(function(){var a=Object.values(s.data.parts).map(function(l){return l[3]});return a.length?Math.max.apply(null,a):void 0})(),s.isMoving=!0,f&&f.id&&(s.id=f.id),f&&f.zIndexesOccupied&&(e=f.zIndexesOccupied);function E(a){s.canvasX+=parseFloat(a)}function v(a){s.canvasY+=parseFloat(a)}function p(a){if(s.data.hitBoxes&&f.hitBoxes[a])return f.hitBoxes[a]}function i(a){return a=Math.round(a*2)/2,a}function u(){if(s.isMoving){var a=s.mapPosition[0],l=s.mapPosition[1];if(typeof s.direction<"u"){var y=s.direction-90;y<0&&(y=360+y),a+=i(s.speed*Math.cos(y*(Math.PI/180))),l+=i(s.speed*Math.sin(y*(Math.PI/180)))}else typeof s.movingToward[0]<"u"&&(a>s.movingToward[0]?a-=Math.min(s.getSpeedX(),Math.abs(a-s.movingToward[0])):a<s.movingToward[0]&&(a+=Math.min(s.getSpeedX(),Math.abs(a-s.movingToward[0])))),typeof s.movingToward[1]<"u"&&(l>s.movingToward[1]?l-=Math.min(s.getSpeedY(),Math.abs(l-s.movingToward[1])):l<s.movingToward[1]&&(l+=Math.min(s.getSpeedY(),Math.abs(l-s.movingToward[1]))));s.setMapPosition(a,l)}}return this.draw=function(a,l){var y=s.data.parts[l];s.height=y[3],s.width=y[2];var b=a.mapPositionToCanvasPosition(s.mapPosition);s.setCanvasPosition(b[0],b[1]),a.drawImage(a.getLoadedImage(s.data.$imageFile),y[0],y[1],y[2],y[3],s.canvasX,s.canvasY,y[2],y[3])},this.setMapPosition=function(a,l,y){typeof a>"u"&&(a=s.mapPosition[0]),typeof l>"u"&&(l=s.mapPosition[1]),typeof y>"u"?y=s.mapPosition[2]:s.zIndexesOccupied=[y],s.mapPosition=[a,l,y]},this.setCanvasPosition=function(a,l){a&&(typeof a=="string"&&(a[0]==="+"||a[0]==="-")?E(a):s.canvasX=a),l&&(typeof l=="string"&&(l[0]==="+"||l[0]==="-")?v(l):s.canvasY=l)},this.getCanvasPositionX=function(){return s.canvasX},this.getCanvasPositionY=function(){return s.canvasY},this.getLeftHitBoxEdge=function(a){a=a||0;var l=this.getCanvasPositionX();return p(a)&&(l+=p(a)[0]),l},this.getTopHitBoxEdge=function(a){a=a||0;var l=this.getCanvasPositionY();return p(a)&&(l+=p(a)[1]),l},this.getRightHitBoxEdge=function(a){return a=a||0,p(a)?s.canvasX+p(a)[2]:s.canvasX+s.width},this.getBottomHitBoxEdge=function(a){return a=a||0,p(a)?s.canvasY+p(a)[3]:s.canvasY+s.height},this.getPositionInFrontOf=function(){return[s.canvasX,s.canvasY+s.height]},this.setSpeed=function(a){s.speed=a,s.speedX=a,s.speedY=a},this.incrementSpeedBy=function(a){s.speed+=a},s.getSpeed=function(){return s.speed},s.getSpeedX=function(){return s.speed},s.getSpeedY=function(){return s.speed},this.setHeight=function(a){s.height=a},this.setWidth=function(a){s.width=a},this.getMaxHeight=function(){return s.maxHeight},s.getMovingTowardOpposite=function(){if(!s.isMoving)return[0,0];var a=s.movingToward[0]-s.mapPosition[0],l=s.movingToward[1]-s.mapPosition[1],y=Math.abs(a)>75?0-a:0,b=-l;return[y,b]},this.checkHittableObjects=function(){Object.keys(n).forEach(function(a){var l=n[a];l.object.deleted?delete n[a]:l.object.hits(s)&&l.callbacks.forEach(function(y){y(s,l.object)})})},this.cycle=function(){s.checkHittableObjects(),d&&s.setMapPositionTarget(d.mapPosition[0],d.mapPosition[1],!0),u()},this.setMapPositionTarget=function(a,l,y){y&&(s.movingWithConviction=!1),s.movingWithConviction||(typeof a>"u"&&(a=s.movingToward[0]),typeof l>"u"&&(l=s.movingToward[1]),s.movingToward=[a,l],s.movingWithConviction=!1)},this.setDirection=function(a){a>=360&&(a=360-a),s.direction=a,s.movingToward=void 0},this.resetDirection=function(){s.direction=void 0},this.setMapPositionTargetWithConviction=function(a,l){s.setMapPositionTarget(a,l),s.movingWithConviction=!0},this.follow=function(a){d=a},this.stopFollowing=function(){d=!1},this.onHitting=function(a,l){if(n[a.id])return n[a.id].callbacks.push(l);n[a.id]={object:a,callbacks:[l]}},this.deleteOnNextCycle=function(){s.deleted=!0},this.occupiesZIndex=function(a){return e.indexOf(a)>=0},this.hits=function(a){var l=!1,y=!1;return a.getTopHitBoxEdge(s.mapPosition[2])<=s.getBottomHitBoxEdge(s.mapPosition[2])&&a.getBottomHitBoxEdge(s.mapPosition[2])>=s.getBottomHitBoxEdge(s.mapPosition[2])&&(l=!0),a.getTopHitBoxEdge(s.mapPosition[2])<=s.getTopHitBoxEdge(s.mapPosition[2])&&a.getBottomHitBoxEdge(s.mapPosition[2])>=s.getTopHitBoxEdge(s.mapPosition[2])&&(l=!0),a.getLeftHitBoxEdge(s.mapPosition[2])<=s.getRightHitBoxEdge(s.mapPosition[2])&&a.getRightHitBoxEdge(s.mapPosition[2])>=s.getRightHitBoxEdge(s.mapPosition[2])&&(y=!0),a.getLeftHitBoxEdge(s.mapPosition[2])<=s.getLeftHitBoxEdge(s.mapPosition[2])&&a.getRightHitBoxEdge(s.mapPosition[2])>=s.getLeftHitBoxEdge(s.mapPosition[2])&&(y=!0),l&&y},this.isAboveOnCanvas=function(a){return s.canvasY+s.height<a},this.isBelowOnCanvas=function(a){return s.canvasY>a},s}we.createObjects=function(n,e){Array.isArray(n)||(n=[n]),e=Object.assign({rateModifier:0,dropRate:1,position:[0,0]},e);function s(E){var v=e.position;if(Math.floor(Math.random()*(101+e.rateModifier))<=E.dropRate){var p=new we(E.sprite);return p.setSpeed(0),typeof v=="function"&&(v=v()),p.setMapPosition(v[0],v[1]),E.sprite.hitBehaviour&&E.sprite.hitBehaviour.skier&&e.player&&p.onHitting(e.player,E.sprite.hitBehaviour.skier),p}}var d=n.map(s).filter(function(E){return E!==void 0});return d};var Z=we;function ut(f){var n=new Z(f),e=n.superior("draw"),s=1,d=0,E=6;n.isEating=!1,n.isFull=!1,n.setSpeed(E),n.draw=function(p){var i=function(){var u=n.movingToward[0]-n.canvasX;if(n.isEating)return"eating"+d;if(s+.1>2?s=.1:s+=.1,u>=0)return"sEast"+Math.ceil(s);if(u<0)return"sWest"+Math.ceil(s)};return e(p,i())};function v(p){d+=1,n.isEating=!0,n.isMoving=!1,d<6?setTimeout(function(){v(p)},300):(d=0,n.isEating=!1,n.isMoving=!0,p())}return n.startEating=v,n}var Ne=ut;function ft(f){var n=new Z(f),e={draw:n.superior("draw"),cycle:n.superior("cycle")},s={sEast:function(v){return v>0},sWest:function(v){return v<=0}},d=3;n.setSpeed(d);function E(){var v=n.movingToward[0]-n.mapPosition[0],p=n.movingToward[1]-n.mapPosition[1];return s.sEast(v)?"sEast":"sWest"}return n.cycle=function(v){Math.floor(Math.random()*11)===1&&(n.setMapPositionTarget(v.getRandomlyInTheCentreOfMap()),n.setSpeed(d+Math.floor(Math.random()*3)-1)),n.setMapPositionTarget(void 0,v.getMapBelowViewport()+600),e.cycle()},n.draw=function(v){var p=function(){return E()};return e.draw(v,p())},n}var De=ft;typeof navigator<"u"?navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate:globalThis.navigator={vibrate:!1};function ct(f){var n={west:270,wsWest:240,sWest:195,south:180,sEast:165,esEast:120,east:90},e=new Z(f),s={draw:e.superior("draw"),cycle:e.superior("cycle"),getSpeedX:e.superior("getSpeedX"),getSpeedY:e.superior("getSpeedY"),hits:e.superior("hits")},d={esEast:function(T){return T>300},sEast:function(T){return T>75},wsWest:function(T){return T<-300},sWest:function(T){return T<-75}},E,v,p=!0,i=[],u=0,a=5,l=2,y=70,b=0,P=0,S=0,x=1,F=0;e.isMoving=!0,e.hasBeenHit=!1,e.isJumping=!1,e.isPerformingTrick=!1,e.onHitObstacleCb=function(){},e.setSpeed(a),e.reset=function(){i=[],u=0,e.isMoving=!0,e.hasBeenHit=!1,p=!0,X()};function X(){e.setSpeed(a),e.isMoving=!0,e.hasBeenHit=!1,e.isJumping=!1,e.isPerformingTrick=!1,v&&clearInterval(v),e.setMapPosition(void 0,void 0,0)}function te(){e.isMoving=!1,e.hasBeenHit=!0,e.isJumping=!1,e.isPerformingTrick=!1,v&&clearInterval(v),e.setMapPosition(void 0,void 0,0)}function j(){var T=e.getSpeed();e.setSpeed(T+2),e.setSpeedY(T+2),e.isMoving=!0,e.hasBeenHit=!1,e.isJumping=!0,e.setMapPosition(void 0,void 0,1)}function H(){if(e.direction)return e.direction<=90?"east":e.direction>90&&e.direction<150?"esEast":e.direction>=150&&e.direction<180?"sEast":e.direction===180?"south":e.direction>180&&e.direction<=210?"sWest":e.direction>210&&e.direction<270?"wsWest":e.direction>=270?"west":"south";var T=e.movingToward[0]-e.mapPosition[0],V=e.movingToward[1]-e.mapPosition[1];return V<=0?T>0?"east":"west":d.esEast(T)?"esEast":d.sEast(T)?"sEast":d.wsWest(T)?"wsWest":d.sWest(T)?"sWest":"south"}function L(T){n[T]&&e.setDirection(n[T]),T==="west"||T==="east"?e.isMoving=!1:e.isMoving=!0}function o(){return"blank"}function I(){return"jumping"}function ne(){return console.log("Trick step is",F),F===0?"jumping":F===1?"somersault1":"somersault2"}e.stop=function(){e.direction>180?L("west"):L("east")},e.turnEast=function(){if(!e.hasBeenHit){var T=H();switch(T){case"west":L("wsWest");break;case"wsWest":L("sWest");break;case"sWest":L("south");break;case"south":L("sEast");break;case"sEast":L("esEast");break;case"esEast":L("east");break;default:L("south");break}}},e.turnWest=function(){if(!e.hasBeenHit){var T=H();switch(T){case"east":L("esEast");break;case"esEast":L("sEast");break;case"sEast":L("south");break;case"south":L("sWest");break;case"sWest":L("wsWest");break;case"wsWest":L("west");break;default:L("south");break}}},e.stepWest=function(){e.hasBeenHit||(e.mapPosition[0]-=e.speed*2)},e.stepEast=function(){e.hasBeenHit||(e.mapPosition[0]+=e.speed*2)},e.setMapPositionTarget=function(T,V){e.hasBeenHit||(Math.abs(e.mapPosition[0]-T)<=75&&(T=e.mapPosition[0]),e.movingToward=[T,V])},e.startMovingIfPossible=function(){!e.hasBeenHit&&!e.isBeingEaten&&(e.isMoving=!0)},e.setTurnEaseCycles=function(T){y=T},e.getPixelsTravelledDownMountain=function(){return u},e.resetSpeed=function(){e.setSpeed(a)},e.cycle=function(){e.getSpeedX()<=0&&e.getSpeedY()<=0&&(e.isMoving=!1),e.isMoving&&(u+=e.speed),e.isJumping&&e.setMapPositionTarget(void 0,e.mapPosition[1]+e.getSpeed()),s.cycle(),e.checkHittableObjects()},e.draw=function(T){var V=function(){return e.isBeingEaten?o():e.isJumping?e.isPerformingTrick?ne():I():e.hasBeenHit?"hit":H()};return s.draw(T,V())},e.hits=function(T){return i.indexOf(T.id)!==-1||!T.occupiesZIndex(e.mapPosition[2])?!1:!!s.hits(T)},e.speedBoost=function(){var T=e.speed;p&&(p=!1,e.setSpeed(e.speed*l),setTimeout(function(){e.setSpeed(T),setTimeout(function(){p=!0},1e4)},2e3))},e.attemptTrick=function(){e.isJumping&&(e.isPerformingTrick=!0,v=setInterval(function(){F>=2?F=0:F+=1},300))},e.getStandardSpeed=function(){return a};function W(T,V,m){return m===0||m===1?V:(T<V&&(T+=e.getSpeed()*(m/y)),T>V&&(T-=e.getSpeed()*(m/y)),T)}return e.getSpeedX=function(){return H()==="esEast"||H()==="wsWest"?(P=.5,b=W(b,e.getSpeed()*P,P),b):H()==="sEast"||H()==="sWest"?(P=.33,b=W(b,e.getSpeed()*P,P),b):(b=W(b,0,P),b)},e.setSpeedY=function(T){S=T},e.getSpeedY=function(){var T;return e.isJumping?S:H()==="esEast"||H()==="wsWest"?(x=.6,S=W(S,e.getSpeed()*.6,.6),S):H()==="sEast"||H()==="sWest"?(x=.85,S=W(S,e.getSpeed()*.85,.85),S):H()==="east"||H()==="west"?(x=1,S=0,S):(S=W(S,e.getSpeed(),x),S)},e.hasHitObstacle=function(T){te(),navigator.vibrate&&navigator.vibrate(500),i.push(T.id),e.resetSpeed(),e.onHitObstacleCb(T),E&&clearTimeout(E),E=setTimeout(function(){X()},1500)},e.hasHitJump=function(){j(),E&&clearTimeout(E),E=setTimeout(function(){X()},1e3)},e.isEatenBy=function(T,V){e.hasHitObstacle(T),T.startEating(V),i.push(T.id),e.isMoving=!1,e.isBeingEaten=!0},e.reset=function(){i=[],u=0,e.isMoving=!0,e.isJumping=!1,e.hasBeenHit=!1,p=!0},e.setHitObstacleCb=function(T){e.onHitObstacleCb=T||function(){}},e}var Re=ct;function lt(f){var n=this;return n.lines=f.initialLines,n.top=f.position.top,n.right=f.position.right,n.bottom=f.position.bottom,n.left=f.position.left,n.width=f.width,n.height=f.height,n.setLines=function(e){n.lines=e},n.draw=function(e){e.font="11px monospace";var s=0;n.lines.forEach(function(d){var E=+e.font.slice(0,2),v=e.measureText(d).width,p=E*1.5,i,u;n.top?u=n.top+s:n.bottom&&(u=e.canvas.height-n.top-p+s),n.right?i=e.canvas.width-n.right-v:n.left&&(i=n.left),s+=p,e.fillText(d,i,u)})},n}var Ie=lt;var Je=ye(Ge(),1);function Et(f,n){var e=new ie,s=new ie,d=new ie,E=f.getContext("2d"),v=E.getCentreOfViewport(),p=0,i=!1,u=this,a=[],l=[],y=new Je.default;this.addStaticObject=function(P){e.push(P)},this.addStaticObjects=function(P){P.forEach(this.addStaticObject.bind(this))},this.addMovingObject=function(P,S){S&&e.onPush(function(x){x.data&&x.data.hitBehaviour[S]&&x.onHitting(P,x.data.hitBehaviour[S])},!0),s.push(P)},this.addUIElement=function(P){d.push(P)},this.beforeCycle=function(P){a.push(P)},this.afterCycle=function(P){l.push(P)},this.setMouseX=function(P){v=P},this.setMouseY=function(P){p=P},n.setMapPosition(0,0),n.setMapPositionTarget(0,-10),E.followSprite(n);var b=0;this.cycle=function(){a.forEach(function(S){S()});var P=E.canvasPositionToMapPosition([v,p]);n.isJumping||n.setMapPositionTarget(P[0],P[1]),b++,n.cycle(),s.forEach(function(S,x){S.cycle(E)}),e.cull(),e.forEach(function(S,x){S.cycle&&S.cycle()}),d.forEach(function(S,x){S.cycle&&S.cycle()}),l.forEach(function(S){S()})},u.draw=function(){f.width=f.width,n.draw(E),n.cycle(),s.forEach(function(P,S){P.draw(E)}),e.forEach(function(P,S){P.draw&&P.draw(E,"main")}),d.forEach(function(P,S){P.draw&&P.draw(E,"main")})},this.start=function(){y.start()},this.pause=function(){i=!0,y.stop()},this.isPaused=function(){return i},this.reset=function(){i=!1,e=new ie,s=new ie,v=E.getCentreOfViewport(),p=0,n.reset(),n.setMapPosition(0,0,0),this.start()}.bind(this),y.on("20",this.cycle),y.on("20",this.draw)}var Ke=Et;var Q={skier:{$imageFile:"sprite-characters.png",parts:{blank:[0,0,0,0],east:[0,0,24,34],esEast:[24,0,24,34],sEast:[49,0,17,34],south:[65,0,17,34],sWest:[49,37,17,34],wsWest:[24,37,24,34],west:[0,37,24,34],hit:[0,78,31,31],jumping:[84,0,32,34],somersault1:[116,0,32,34],somersault2:[148,0,32,34]},hitBoxes:{0:[7,20,27,34]},id:"player",hitBehaviour:{}},smallTree:{$imageFile:"skifree-objects.png",parts:{main:[0,28,30,34]},hitBoxes:{0:[0,18,30,34]},hitBehaviour:{}},tallTree:{$imageFile:"skifree-objects.png",parts:{main:[95,66,32,64]},zIndexesOccupied:[0,1],hitBoxes:{0:[0,54,32,64],1:[0,10,32,54]},hitBehaviour:{}},thickSnow:{$imageFile:"skifree-objects.png",parts:{main:[143,53,43,10]},hitBehaviour:{}},rock:{$imageFile:"skifree-objects.png",parts:{main:[30,52,23,11]},hitBehaviour:{}},monster:{$imageFile:"sprite-characters.png",parts:{sEast1:[64,112,26,43],sEast2:[90,112,32,43],sWest1:[64,158,26,43],sWest2:[90,158,32,43],eating1:[122,112,34,43],eating2:[156,112,31,43],eating3:[187,112,31,43],eating4:[219,112,25,43],eating5:[243,112,26,43]},hitBehaviour:{}},jump:{$imageFile:"skifree-objects.png",parts:{main:[109,55,32,8]},hitBehaviour:{}},signStart:{$imageFile:"skifree-objects.png",parts:{main:[260,103,42,27]},hitBehaviour:{}},snowboarder:{$imageFile:"sprite-characters.png",parts:{sEast:[73,229,20,29],sWest:[95,228,26,30]},hitBehaviour:{}},emptyChairLift:{$imageFile:"skifree-objects.png",parts:{main:[92,136,26,30]},zIndexesOccupied:[1]}};function yt(f){f.deleteOnNextCycle()}Q.monster.hitBehaviour.tree=yt;function $e(f,n){n.deleteOnNextCycle()}Q.smallTree.hitBehaviour.monster=$e;Q.tallTree.hitBehaviour.monster=$e;function ze(f,n){n.hasHitObstacle(f)}Q.smallTree.hitBehaviour.skier=ze;Q.tallTree.hitBehaviour.skier=ze;function wt(f,n){n.hasHitObstacle(f)}Q.rock.hitBehaviour.skier=wt;function _t(f,n){n.hasHitJump(f)}Q.jump.hitBehaviour.skier=_t;function Tt(f,n){n.hasHitObstacle(f)}Q.snowboarder.hitBehaviour.skier=Tt;var q=Q;var K=document.getElementById("skifree-canvas"),ee=K.getContext("2d"),Mt=["sprite-characters.png","skifree-objects.png"],Te="Use the mouse or WASD to control the player";Ce()&&(Te="Tap or drag on the piste to control the player");var Pt=18,ce=0,St=2e3,se=5,he=0,Ot=!1,le={smallTree:4,tallTree:2,jump:1,thickSnow:1,rock:1};localStorage.getItem("highScore")&&(he=localStorage.getItem("highScore"));function xt(f,n){var e=0,s={};function d(){e+=1,e===f.length&&n(s)}f.forEach(function(E){var v=new Image;v.onload=d,v.src=E,ee.storeLoadedImage(E,v)})}function Ct(f,n){n.isEatenBy(f,function(){se-=1,f.isFull=!0,f.isEating=!1,n.isBeingEaten=!1,f.setSpeed(n.getSpeed()),f.stopFollowing();var e=ee.getRandomMapPositionAboveViewport();f.setMapPositionTarget(e[0],e[1])})}function bt(f){var n,e,s,d;function E(){ce=0,se=5,he=localStorage.getItem("highScore"),d.reset(),d.addStaticObject(e)}function v(){d.isPaused()||(he=localStorage.setItem("highScore",ce),s.setLines(["Game over!","Hit space to restart"]),d.pause(),d.cycle())}function p(l,y){var b=Math.max(800-K.width,0);Math.floor(Math.random()*(1001+b))<=y&&l()}function i(){var l=new Ne(q.monster),y=ee.getRandomMapPositionAboveViewport();l.setMapPosition(y[0],y[1]),l.follow(n),l.setSpeed(n.getStandardSpeed()),l.onHitting(n,Ct),d.addMovingObject(l,"monster")}function u(){var l=new De(q.snowboarder),y=ee.getRandomMapPositionAboveViewport(),b=ee.getRandomMapPositionBelowViewport();l.setMapPosition(y[0],y[1]),l.setMapPositionTarget(b[0],b[1]),l.onHitting(n,q.snowboarder.hitBehaviour.skier),d.addMovingObject(l)}n=new Re(q.skier),n.setMapPosition(0,0),n.setMapPositionTarget(0,-10),Ot&&n.setHitObstacleCb(function(){se-=1}),d=new Ke(K,n),e=new Z(q.signStart),d.addStaticObject(e),e.setMapPosition(-50,0),ee.followSprite(n),s=new Ie({initialLines:["SkiFree.js",Te,"Travelled 0m","High Score: "+he,"Skiers left: "+se,"Created by Dan Hough (@basicallydan)"],position:{top:15,right:10}}),d.beforeCycle(function(){var l=[];n.isMoving&&(l=Z.createObjects([{sprite:q.smallTree,dropRate:le.smallTree},{sprite:q.tallTree,dropRate:le.tallTree},{sprite:q.jump,dropRate:le.jump},{sprite:q.thickSnow,dropRate:le.thickSnow},{sprite:q.rock,dropRate:le.rock}],{rateModifier:Math.max(800-K.width,0),position:function(){return ee.getRandomMapPositionBelowViewport()},player:n})),d.isPaused()||(d.addStaticObjects(l),p(u,.1),ce=parseFloat(n.getPixelsTravelledDownMountain()/Pt).toFixed(1),ce>St&&p(i,.001),s.setLines(["SkiFree.js",Te,"Travelled "+ce+"m","Skiers left: "+se,"High Score: "+he,"Created by Dan Hough (@basicallydan)","Current Speed: "+n.getSpeed()]))}),d.afterCycle(function(){se===0&&v()}),d.addUIElement(s),K.addEventListener("mousemove",function(l){d.setMouseX(l.pageX),d.setMouseY(l.pageY),n.resetDirection(),n.startMovingIfPossible()}),K.addEventListener("click",function(l){d.setMouseX(l.pageX),d.setMouseY(l.pageY),n.resetDirection(),n.startMovingIfPossible()}),K.focus(),J.default.bind("f",n.speedBoost),J.default.bind("t",n.attemptTrick),J.default.bind(["w","up"],function(){n.stop()}),J.default.bind(["a","left"],function(){n.direction===270?n.stepWest():n.turnWest()}),J.default.bind(["s","down"],function(){n.setDirection(180),n.startMovingIfPossible()}),J.default.bind(["d","right"],function(){n.direction===90?n.stepEast():n.turnEast()}),J.default.bind("m",i),J.default.bind("b",u),J.default.bind("space",E);var a=(0,Ze.default)(K).on("press",function(l){l.preventDefault(),d.setMouseX(l.gesture.center.x),d.setMouseY(l.gesture.center.y)}).on("tap",function(l){d.setMouseX(l.gesture.center.x),d.setMouseY(l.gesture.center.y)}).on("pan",function(l){d.setMouseX(l.gesture.center.x),d.setMouseY(l.gesture.center.y),n.resetDirection(),n.startMovingIfPossible()}).on("doubletap",function(l){n.speedBoost()});n.isMoving=!1,n.setDirection(270),d.start()}function Qe(){K.width=window.innerWidth,K.height=window.innerHeight}window.addEventListener("resize",Qe,!1);Qe();xt(Mt,bt);})();
/*! Bundled license information:

hammerjs/hammer.js:
  (*! Hammer.JS - v1.0.7dev - 2014-02-18
   * http://eightmedia.github.com/hammer.js
   *
   * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
   * Licensed under the MIT license *)
*/

(()=>{var et=Object.create;var Se=Object.defineProperty;var tt=Object.getOwnPropertyDescriptor;var nt=Object.getOwnPropertyNames;var it=Object.getPrototypeOf,rt=Object.prototype.hasOwnProperty;var ae=(f,i)=>()=>(i||f((i={exports:{}}).exports,i),i.exports);var st=(f,i,e,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let d of nt(i))!rt.call(f,d)&&d!==e&&Se(f,d,{get:()=>i[d],enumerable:!(s=tt(i,d))||s.enumerable});return f};var ye=(f,i,e)=>(e=f!=null?et(it(f)):{},st(i||!f||!f.__esModule?Se(e,"default",{value:f,enumerable:!0}):e,f));var Oe=ae((Dt,pe)=>{(function(f,i){"use strict";var e=function(p,n){return new e.Instance(p,n||{})};e.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},e.HAS_POINTEREVENTS=f.navigator.pointerEnabled||f.navigator.msPointerEnabled,e.HAS_TOUCHEVENTS="ontouchstart"in f,e.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,e.NO_MOUSEEVENTS=e.HAS_TOUCHEVENTS&&f.navigator.userAgent.match(e.MOBILE_REGEX),e.EVENT_TYPES={},e.DIRECTION_DOWN="down",e.DIRECTION_LEFT="left",e.DIRECTION_UP="up",e.DIRECTION_RIGHT="right",e.POINTER_MOUSE="mouse",e.POINTER_TOUCH="touch",e.POINTER_PEN="pen",e.UPDATE_VELOCITY_INTERVAL=20,e.EVENT_START="start",e.EVENT_MOVE="move",e.EVENT_END="end",e.DOCUMENT=f.document,e.plugins=e.plugins||{},e.gestures=e.gestures||{},e.READY=!1;function s(){e.READY||(e.event.determineEventTypes(),e.utils.each(e.gestures,function(p){e.detection.register(p)}),e.event.onTouch(e.DOCUMENT,e.EVENT_MOVE,e.detection.detect),e.event.onTouch(e.DOCUMENT,e.EVENT_END,e.detection.detect),e.READY=!0)}e.utils={extend:function(n,u,o){for(var l in u)n[l]!==i&&o||(n[l]=u[l]);return n},each:function(p,n,u){var o,l;if("forEach"in p)p.forEach(n,u);else if(p.length!==i){for(o=0,l=p.length;o<l;o++)if(n.call(u,p[o],o,p)===!1)return}else for(o in p)if(p.hasOwnProperty(o)&&n.call(u,p[o],o,p)===!1)return},hasParent:function(p,n){for(;p;){if(p==n)return!0;p=p.parentNode}return!1},getCenter:function(n){var u=[],o=[];return e.utils.each(n,function(l){u.push(typeof l.clientX<"u"?l.clientX:l.pageX),o.push(typeof l.clientY<"u"?l.clientY:l.pageY)}),{pageX:(Math.min.apply(Math,u)+Math.max.apply(Math,u))/2,pageY:(Math.min.apply(Math,o)+Math.max.apply(Math,o))/2}},getVelocity:function(n,u,o){return{x:Math.abs(u/n)||0,y:Math.abs(o/n)||0}},getAngle:function(n,u){var o=u.pageY-n.pageY,l=u.pageX-n.pageX;return Math.atan2(o,l)*180/Math.PI},getDirection:function(n,u){var o=Math.abs(n.pageX-u.pageX),l=Math.abs(n.pageY-u.pageY);return o>=l?n.pageX-u.pageX>0?e.DIRECTION_LEFT:e.DIRECTION_RIGHT:n.pageY-u.pageY>0?e.DIRECTION_UP:e.DIRECTION_DOWN},getDistance:function(n,u){var o=u.pageX-n.pageX,l=u.pageY-n.pageY;return Math.sqrt(o*o+l*l)},getScale:function(n,u){return n.length>=2&&u.length>=2?this.getDistance(u[0],u[1])/this.getDistance(n[0],n[1]):1},getRotation:function(n,u){return n.length>=2&&u.length>=2?this.getAngle(u[1],u[0])-this.getAngle(n[1],n[0]):0},isVertical:function(n){return n==e.DIRECTION_UP||n==e.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(n,u){!u||!n||!n.style||(e.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(o){e.utils.each(u,function(l,y){o&&(y=o+y.substring(0,1).toUpperCase()+y.substring(1)),y in n.style&&(n.style[y]=l)})}),u.userSelect=="none"&&(n.onselectstart=function(){return!1}),u.userDrag=="none"&&(n.ondragstart=function(){return!1}))},startDefaultBrowserBehavior:function(n,u){!u||!n||!n.style||(e.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(o){e.utils.each(u,function(l,y){o&&(y=o+y.substring(0,1).toUpperCase()+y.substring(1)),y in n.style&&(n.style[y]="")})}),u.userSelect=="none"&&(n.onselectstart=null),u.userDrag=="none"&&(n.ondragstart=null))}},e.Instance=function(p,n){var u=this;return s(),this.element=p,this.enabled=!0,this.options=e.utils.extend(e.utils.extend({},e.defaults),n||{}),this.options.stop_browser_behavior&&e.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),this._eventStartHandler=e.event.onTouch(p,e.EVENT_START,function(o){u.enabled&&e.detection.startDetect(u,o)}),this._eventHandler=[],this},e.Instance.prototype={on:function(n,u){var o=n.split(" ");return e.utils.each(o,function(l){this.element.addEventListener(l,u,!1),this._eventHandler.push({gesture:l,handler:u})},this),this},off:function(n,u){var o=n.split(" ");return e.utils.each(o,function(l){this.element.removeEventListener(l,u,!1);var y=-1;e.utils.each(this._eventHandler,function(N,P){y===-1&&N.gesture===l&&N.handler===u&&(y=P)},this),y>-1&&this._eventHandler.splice(y,1)},this),this},trigger:function(n,u){u||(u={});var o=e.DOCUMENT.createEvent("Event");o.initEvent(n,!0,!0),o.gesture=u;var l=this.element;return e.utils.hasParent(u.target,l)&&(l=u.target),l.dispatchEvent(o),this},enable:function(n){return this.enabled=n,this},dispose:function(){return this.options.stop_browser_behavior&&e.utils.startDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),e.utils.each(this._eventHandler,function(n){this.element.removeEventListener(n.gesture,n.handler,!1)},this),this._eventHandler.length=0,e.event.unbindDom(this.element,e.EVENT_TYPES[e.EVENT_START],this._eventStartHandler),this}};var d=null,E=!1,v=!1;e.event={bindDom:function(p,n,u){var o=n.split(" ");e.utils.each(o,function(l){p.addEventListener(l,u,!1)})},unbindDom:function(p,n,u){var o=n.split(" ");e.utils.each(o,function(l){p.removeEventListener(l,u,!1)})},onTouch:function(n,u,o){var l=this,y=function(P){var S=P.type.toLowerCase();if(!(S.match(/mouse/)&&v)){S.match(/touch/)||S.match(/pointerdown/)||S.match(/mouse/)&&P.which===1?E=!0:S.match(/mouse/)&&!P.which&&(E=!1),S.match(/touch|pointer/)&&(v=!0);var x=0;E&&(e.HAS_POINTEREVENTS&&u!=e.EVENT_END?x=e.PointerEvent.updatePointer(u,P):S.match(/touch/)?x=P.touches.length:v||(x=S.match(/up/)?0:1),x>0&&u==e.EVENT_END?u=e.EVENT_MOVE:x||(u=e.EVENT_END),(x||d===null)&&(d=P),o.call(e.detection,l.collectEventData(n,u,l.getTouchList(d,u),P)),e.HAS_POINTEREVENTS&&u==e.EVENT_END&&(x=e.PointerEvent.updatePointer(u,P))),x||(d=null,E=!1,v=!1,e.PointerEvent.reset())}};return this.bindDom(n,e.EVENT_TYPES[u],y),y},determineEventTypes:function(){var n;e.HAS_POINTEREVENTS?n=e.PointerEvent.getEvents():e.NO_MOUSEEVENTS?n=["touchstart","touchmove","touchend touchcancel"]:n=["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],e.EVENT_TYPES[e.EVENT_START]=n[0],e.EVENT_TYPES[e.EVENT_MOVE]=n[1],e.EVENT_TYPES[e.EVENT_END]=n[2]},getTouchList:function(n){return e.HAS_POINTEREVENTS?e.PointerEvent.getTouchList():n.touches?n.touches:(n.identifier=1,[n])},collectEventData:function(n,u,o,l){var y=e.POINTER_TOUCH;return(l.type.match(/mouse/)||e.PointerEvent.matchType(e.POINTER_MOUSE,l))&&(y=e.POINTER_MOUSE),{center:e.utils.getCenter(o),timeStamp:new Date().getTime(),target:l.target,touches:o,eventType:u,pointerType:y,srcEvent:l,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return e.detection.stopDetect()}}}},e.PointerEvent={pointers:{},getTouchList:function(){var p=this,n=[];return e.utils.each(p.pointers,function(u){n.push(u)}),n},updatePointer:function(p,n){return p==e.EVENT_END?delete this.pointers[n.pointerId]:(n.identifier=n.pointerId,this.pointers[n.pointerId]=n),Object.keys(this.pointers).length},matchType:function(p,n){if(!n.pointerType)return!1;var u=n.pointerType,o={};return o[e.POINTER_MOUSE]=u===n.MSPOINTER_TYPE_MOUSE||u===e.POINTER_MOUSE,o[e.POINTER_TOUCH]=u===n.MSPOINTER_TYPE_TOUCH||u===e.POINTER_TOUCH,o[e.POINTER_PEN]=u===n.MSPOINTER_TYPE_PEN||u===e.POINTER_PEN,o[p]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},e.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(n,u){this.current||(this.stopped=!1,this.current={inst:n,startEvent:e.utils.extend({},u),lastEvent:!1,lastVEvent:!1,velocity:!1,name:""},this.detect(u))},detect:function(n){if(!(!this.current||this.stopped)){n=this.extendEventData(n);var u=this.current.inst.options;return e.utils.each(this.gestures,function(o){if(!this.stopped&&u[o.name]!==!1&&o.handler.call(o,n,this.current.inst)===!1)return this.stopDetect(),!1},this),this.current&&(this.current.lastEvent=n),n.eventType==e.EVENT_END&&!n.touches.length-1&&this.stopDetect(),n}},stopDetect:function(){this.previous=e.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(n){var u=this.current.startEvent,o=this.current.lastVEvent;u&&(n.touches.length!=u.touches.length||n.touches===u.touches)&&(u.touches=[],e.utils.each(n.touches,function(F){u.touches.push(e.utils.extend({},F))}));var l=n.timeStamp-u.timeStamp,y=n.center.pageX-u.center.pageX,N=n.center.pageY-u.center.pageY,P,S,x=this.current.velocity;return o!==!1&&n.timeStamp-o.timeStamp>e.UPDATE_VELOCITY_INTERVAL?(x=e.utils.getVelocity(n.timeStamp-o.timeStamp,n.center.pageX-o.center.pageX,n.center.pageY-o.center.pageY),this.current.lastVEvent=n,x.x>0&&x.y>0&&(this.current.velocity=x)):this.current.velocity===!1&&(x=e.utils.getVelocity(l,y,N),this.current.velocity=x,this.current.lastVEvent=n),n.eventType==="end"?(P=this.current.lastEvent&&this.current.lastEvent.interimAngle,S=this.current.lastEvent&&this.current.lastEvent.interimDirection):(P=this.current.lastEvent&&e.utils.getAngle(this.current.lastEvent.center,n.center),S=this.current.lastEvent&&e.utils.getDirection(this.current.lastEvent.center,n.center)),e.utils.extend(n,{deltaTime:l,deltaX:y,deltaY:N,velocityX:x.x,velocityY:x.y,distance:e.utils.getDistance(u.center,n.center),angle:e.utils.getAngle(u.center,n.center),interimAngle:P,direction:e.utils.getDirection(u.center,n.center),interimDirection:S,scale:e.utils.getScale(u.touches,n.touches),rotation:e.utils.getRotation(u.touches,n.touches),startEvent:u}),n},register:function(n){var u=n.defaults||{};return u[n.name]===i&&(u[n.name]=!0),e.utils.extend(e.defaults,u,!0),n.index=n.index||1e3,this.gestures.push(n),this.gestures.sort(function(o,l){return o.index<l.index?-1:o.index>l.index?1:0}),this.gestures}},e.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(n,u){if(e.detection.current.name!=this.name&&this.triggered){u.trigger(this.name+"end",n),this.triggered=!1;return}if(!(u.options.drag_max_touches>0&&n.touches.length>u.options.drag_max_touches))switch(n.eventType){case e.EVENT_START:this.triggered=!1;break;case e.EVENT_MOVE:if(n.distance<u.options.drag_min_distance&&e.detection.current.name!=this.name)return;if(e.detection.current.name!=this.name&&(e.detection.current.name=this.name,u.options.correct_for_drag_min_distance&&n.distance>0)){var o=Math.abs(u.options.drag_min_distance/n.distance);e.detection.current.startEvent.center.pageX+=n.deltaX*o,e.detection.current.startEvent.center.pageY+=n.deltaY*o,n=e.detection.extendEventData(n)}(e.detection.current.lastEvent.drag_locked_to_axis||u.options.drag_lock_to_axis&&u.options.drag_lock_min_distance<=n.distance)&&(n.drag_locked_to_axis=!0);var l=e.detection.current.lastEvent.direction;n.drag_locked_to_axis&&l!==n.direction&&(e.utils.isVertical(l)?n.direction=n.deltaY<0?e.DIRECTION_UP:e.DIRECTION_DOWN:n.direction=n.deltaX<0?e.DIRECTION_LEFT:e.DIRECTION_RIGHT),this.triggered||(u.trigger(this.name+"start",n),this.triggered=!0),u.trigger(this.name,n),u.trigger(this.name+n.direction,n),(u.options.drag_block_vertical&&e.utils.isVertical(n.direction)||u.options.drag_block_horizontal&&!e.utils.isVertical(n.direction))&&n.preventDefault();break;case e.EVENT_END:this.triggered&&u.trigger(this.name+"end",n),this.triggered=!1;break}}},e.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(n,u){switch(n.eventType){case e.EVENT_START:clearTimeout(this.timer),e.detection.current.name=this.name,this.timer=setTimeout(function(){e.detection.current.name=="hold"&&u.trigger("hold",n)},u.options.hold_timeout);break;case e.EVENT_MOVE:n.distance>u.options.hold_threshold&&clearTimeout(this.timer);break;case e.EVENT_END:clearTimeout(this.timer);break}}},e.gestures.Release={name:"release",index:1/0,handler:function(n,u){n.eventType==e.EVENT_END&&u.trigger(this.name,n)}},e.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(n,u){if(n.eventType==e.EVENT_END){if(u.options.swipe_max_touches>0&&n.touches.length<u.options.swipe_min_touches&&n.touches.length>u.options.swipe_max_touches)return;(n.velocityX>u.options.swipe_velocity||n.velocityY>u.options.swipe_velocity)&&(u.trigger(this.name,n),u.trigger(this.name+n.direction,n))}}},e.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(n,u){if(n.eventType==e.EVENT_MOVE&&!e.detection.current.reachedTapMaxDistance)e.detection.current.reachedTapMaxDistance=n.distance>u.options.tap_max_distance;else if(n.eventType==e.EVENT_END&&n.srcEvent.type!="touchcancel"){var o=e.detection.previous,l=!1;if(e.detection.current.reachedTapMaxDistance||n.deltaTime>u.options.tap_max_touchtime)return;o&&o.name=="tap"&&n.timeStamp-o.lastEvent.timeStamp<u.options.doubletap_interval&&n.distance<u.options.doubletap_distance&&(u.trigger("doubletap",n),l=!0),(!l||u.options.tap_always)&&(e.detection.current.name="tap",u.trigger(e.detection.current.name,n))}}},e.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(n,u){if(u.options.prevent_mouseevents&&n.pointerType==e.POINTER_MOUSE){n.stopDetect();return}u.options.prevent_default&&n.preventDefault(),n.eventType==e.EVENT_START&&u.trigger(this.name,n)}},e.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(n,u){if(e.detection.current.name!=this.name&&this.triggered){u.trigger(this.name+"end",n),this.triggered=!1;return}if(!(n.touches.length<2))switch(u.options.transform_always_block&&n.preventDefault(),n.eventType){case e.EVENT_START:this.triggered=!1;break;case e.EVENT_MOVE:var o=Math.abs(1-n.scale),l=Math.abs(n.rotation);if(o<u.options.transform_min_scale&&l<u.options.transform_min_rotation)return;e.detection.current.name=this.name,this.triggered||(u.trigger(this.name+"start",n),this.triggered=!0),u.trigger(this.name,n),l>u.options.transform_min_rotation&&u.trigger("rotate",n),o>u.options.transform_min_scale&&(u.trigger("pinch",n),u.trigger("pinch"+(n.scale<1?"in":"out"),n));break;case e.EVENT_END:this.triggered&&u.trigger(this.name+"end",n),this.triggered=!1;break}}},typeof define=="function"&&define.amd?define(function(){return e}):typeof pe=="object"&&pe.exports?pe.exports=e:f.Hammer=e})(window)});var xe=ae((Rt,de)=>{(function(){for(var f={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},i={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},e={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},s={option:"alt",command:"meta",return:"enter",escape:"esc"},d,E={},v={},p={},n,u=!1,o=!1,l=1;l<20;++l)f[111+l]="f"+l;for(l=0;l<=9;++l)f[l+96]=l;function y(m,_,O){if(m.addEventListener){m.addEventListener(_,O,!1);return}m.attachEvent("on"+_,O)}function N(m){return m.type=="keypress"?String.fromCharCode(m.which):f[m.which]?f[m.which]:i[m.which]?i[m.which]:String.fromCharCode(m.which).toLowerCase()}function P(m,_){return m.sort().join(",")===_.sort().join(",")}function S(m){m=m||{};var _=!1,O;for(O in p){if(m[O]){_=!0;continue}p[O]=0}_||(o=!1)}function x(m,_,O,D,G){var Y,B,L=[],$=O.type;if(!E[m])return[];for($=="keyup"&&H(m)&&(_=[m]),Y=0;Y<E[m].length;++Y)B=E[m][Y],!(B.seq&&p[B.seq]!=B.level)&&$==B.action&&($=="keypress"&&!O.metaKey&&!O.ctrlKey||P(_,B.modifiers))&&(D&&B.combo==G&&E[m].splice(Y,1),L.push(B));return L}function F(m){var _=[];return m.shiftKey&&_.push("shift"),m.altKey&&_.push("alt"),m.ctrlKey&&_.push("ctrl"),m.metaKey&&_.push("meta"),_}function X(m,_){m(_)===!1&&(_.preventDefault&&_.preventDefault(),_.stopPropagation&&_.stopPropagation(),_.returnValue=!1,_.cancelBubble=!0)}function te(m,_){if(!V.stopCallback(_,_.target||_.srcElement)){var O=x(m,F(_),_),D,G={},Y=!1;for(D=0;D<O.length;++D){if(O[D].seq){Y=!0,G[O[D].seq]=1,X(O[D].callback,_);continue}!Y&&!o&&X(O[D].callback,_)}_.type==o&&!H(m)&&S(G)}}function j(m){m.which=typeof m.which=="number"?m.which:m.keyCode;var _=N(m);if(_){if(m.type=="keyup"&&u==_){u=!1;return}te(_,m)}}function H(m){return m=="shift"||m=="ctrl"||m=="alt"||m=="meta"}function k(){clearTimeout(n),n=setTimeout(S,1e3)}function a(){if(!d){d={};for(var m in f)m>95&&m<112||f.hasOwnProperty(m)&&(d[f[m]]=m)}return d}function I(m,_,O){return O||(O=a()[m]?"keydown":"keypress"),O=="keypress"&&_.length&&(O="keydown"),O}function ne(m,_,O,D){p[m]=0,D||(D=I(_[0],[]));var G=function(L){o=D,++p[m],k()},Y=function(L){X(O,L),D!=="keyup"&&(u=N(L)),setTimeout(S,10)},B;for(B=0;B<_.length;++B)W(_[B],B<_.length-1?G:Y,D,m,B)}function W(m,_,O,D,G){m=m.replace(/\s+/g," ");var Y=m.split(" "),B,L,$,z=[];if(Y.length>1){ne(m,Y,_,O);return}for($=m==="+"?["+"]:m.split("+"),B=0;B<$.length;++B)L=$[B],s[L]&&(L=s[L]),O&&O!="keypress"&&e[L]&&(L=e[L],z.push("shift")),H(L)&&z.push(L);O=I(L,z,O),E[L]||(E[L]=[]),x(L,z,{type:O},!D,m),E[L][D?"unshift":"push"]({callback:_,modifiers:z,action:O,seq:D,level:G,combo:m})}function T(m,_,O){for(var D=0;D<m.length;++D)W(m[D],_,O)}y(document,"keypress",j),y(document,"keydown",j),y(document,"keyup",j);var V={bind:function(m,_,O){return T(m instanceof Array?m:[m],_,O),v[m+":"+O]=_,this},unbind:function(m,_){return v[m+":"+_]&&(delete v[m+":"+_],this.bind(m,function(){},_)),this},trigger:function(m,_){return v[m+":"+_](),this},reset:function(){return E={},v={},this},stopCallback:function(m,_){return(" "+_.className+" ").indexOf(" mousetrap ")>-1?!1:_.tagName=="INPUT"||_.tagName=="SELECT"||_.tagName=="TEXTAREA"||_.contentEditable&&_.contentEditable=="true"}};window.Mousetrap=V,typeof define=="function"&&define.amd&&define("mousetrap",function(){return V}),typeof de=="object"&&de.exports&&(de.exports=V)})()});var Ue=ae((qt,_e)=>{"use strict";var re=typeof Reflect=="object"?Reflect:null,Be=re&&typeof re.apply=="function"?re.apply:function(i,e,s){return Function.prototype.apply.call(i,e,s)},ge;re&&typeof re.ownKeys=="function"?ge=re.ownKeys:Object.getOwnPropertySymbols?ge=function(i){return Object.getOwnPropertyNames(i).concat(Object.getOwnPropertySymbols(i))}:ge=function(i){return Object.getOwnPropertyNames(i)};function ht(f){console&&console.warn&&console.warn(f)}var ke=Number.isNaN||function(i){return i!==i};function R(){R.init.call(this)}_e.exports=R;_e.exports.once=vt;R.EventEmitter=R;R.prototype._events=void 0;R.prototype._eventsCount=0;R.prototype._maxListeners=void 0;var Le=10;function ve(f){if(typeof f!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof f)}Object.defineProperty(R,"defaultMaxListeners",{enumerable:!0,get:function(){return Le},set:function(f){if(typeof f!="number"||f<0||ke(f))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+f+".");Le=f}});R.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};R.prototype.setMaxListeners=function(i){if(typeof i!="number"||i<0||ke(i))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+i+".");return this._maxListeners=i,this};function Ae(f){return f._maxListeners===void 0?R.defaultMaxListeners:f._maxListeners}R.prototype.getMaxListeners=function(){return Ae(this)};R.prototype.emit=function(i){for(var e=[],s=1;s<arguments.length;s++)e.push(arguments[s]);var d=i==="error",E=this._events;if(E!==void 0)d=d&&E.error===void 0;else if(!d)return!1;if(d){var v;if(e.length>0&&(v=e[0]),v instanceof Error)throw v;var p=new Error("Unhandled error."+(v?" ("+v.message+")":""));throw p.context=v,p}var n=E[i];if(n===void 0)return!1;if(typeof n=="function")Be(n,this,e);else for(var u=n.length,o=Xe(n,u),s=0;s<u;++s)Be(o[s],this,e);return!0};function He(f,i,e,s){var d,E,v;if(ve(e),E=f._events,E===void 0?(E=f._events=Object.create(null),f._eventsCount=0):(E.newListener!==void 0&&(f.emit("newListener",i,e.listener?e.listener:e),E=f._events),v=E[i]),v===void 0)v=E[i]=e,++f._eventsCount;else if(typeof v=="function"?v=E[i]=s?[e,v]:[v,e]:s?v.unshift(e):v.push(e),d=Ae(f),d>0&&v.length>d&&!v.warned){v.warned=!0;var p=new Error("Possible EventEmitter memory leak detected. "+v.length+" "+String(i)+" listeners added. Use emitter.setMaxListeners() to increase limit");p.name="MaxListenersExceededWarning",p.emitter=f,p.type=i,p.count=v.length,ht(p)}return f}R.prototype.addListener=function(i,e){return He(this,i,e,!1)};R.prototype.on=R.prototype.addListener;R.prototype.prependListener=function(i,e){return He(this,i,e,!0)};function pt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ve(f,i,e){var s={fired:!1,wrapFn:void 0,target:f,type:i,listener:e},d=pt.bind(s);return d.listener=e,s.wrapFn=d,d}R.prototype.once=function(i,e){return ve(e),this.on(i,Ve(this,i,e)),this};R.prototype.prependOnceListener=function(i,e){return ve(e),this.prependListener(i,Ve(this,i,e)),this};R.prototype.removeListener=function(i,e){var s,d,E,v,p;if(ve(e),d=this._events,d===void 0)return this;if(s=d[i],s===void 0)return this;if(s===e||s.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete d[i],d.removeListener&&this.emit("removeListener",i,s.listener||e));else if(typeof s!="function"){for(E=-1,v=s.length-1;v>=0;v--)if(s[v]===e||s[v].listener===e){p=s[v].listener,E=v;break}if(E<0)return this;E===0?s.shift():dt(s,E),s.length===1&&(d[i]=s[0]),d.removeListener!==void 0&&this.emit("removeListener",i,p||e)}return this};R.prototype.off=R.prototype.removeListener;R.prototype.removeAllListeners=function(i){var e,s,d;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[i]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[i]),this;if(arguments.length===0){var E=Object.keys(s),v;for(d=0;d<E.length;++d)v=E[d],v!=="removeListener"&&this.removeAllListeners(v);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=s[i],typeof e=="function")this.removeListener(i,e);else if(e!==void 0)for(d=e.length-1;d>=0;d--)this.removeListener(i,e[d]);return this};function Ye(f,i,e){var s=f._events;if(s===void 0)return[];var d=s[i];return d===void 0?[]:typeof d=="function"?e?[d.listener||d]:[d]:e?gt(d):Xe(d,d.length)}R.prototype.listeners=function(i){return Ye(this,i,!0)};R.prototype.rawListeners=function(i){return Ye(this,i,!1)};R.listenerCount=function(f,i){return typeof f.listenerCount=="function"?f.listenerCount(i):Fe.call(f,i)};R.prototype.listenerCount=Fe;function Fe(f){var i=this._events;if(i!==void 0){var e=i[f];if(typeof e=="function")return 1;if(e!==void 0)return e.length}return 0}R.prototype.eventNames=function(){return this._eventsCount>0?ge(this._events):[]};function Xe(f,i){for(var e=new Array(i),s=0;s<i;++s)e[s]=f[s];return e}function dt(f,i){for(;i+1<f.length;i++)f[i]=f[i+1];f.pop()}function gt(f){for(var i=new Array(f.length),e=0;e<i.length;++e)i[e]=f[e].listener||f[e];return i}function vt(f,i){return new Promise(function(e,s){function d(v){f.removeListener(i,E),s(v)}function E(){typeof f.removeListener=="function"&&f.removeListener("error",d),e([].slice.call(arguments))}We(f,i,E,{once:!0}),i!=="error"&&mt(f,d,{once:!0})})}function mt(f,i,e){typeof f.on=="function"&&We(f,"error",i,e)}function We(f,i,e,s){if(typeof f.on=="function")s.once?f.once(i,e):f.on(i,e);else if(typeof f.addEventListener=="function")f.addEventListener(i,function d(E){s.once&&f.removeEventListener(i,d),e(E)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof f)}});var qe=ae((ue,me)=>{(function(){var f=this,i=f._,e={},s=Array.prototype,d=Object.prototype,E=Function.prototype,v=s.push,p=s.slice,n=s.concat,u=d.toString,o=d.hasOwnProperty,l=s.forEach,y=s.map,N=s.reduce,P=s.reduceRight,S=s.filter,x=s.every,F=s.some,X=s.indexOf,te=s.lastIndexOf,j=Array.isArray,H=Object.keys,k=E.bind,a=function(t){if(t instanceof a)return t;if(!(this instanceof a))return new a(t);this._wrapped=t};typeof ue<"u"?(typeof me<"u"&&me.exports&&(ue=me.exports=a),ue._=a):f._=a,a.VERSION="1.6.0";var I=a.each=a.forEach=function(t,r,c){if(t==null)return t;if(l&&t.forEach===l)t.forEach(r,c);else if(t.length===+t.length){for(var h=0,g=t.length;h<g;h++)if(r.call(c,t[h],h,t)===e)return}else for(var w=a.keys(t),h=0,g=w.length;h<g;h++)if(r.call(c,t[w[h]],w[h],t)===e)return;return t};a.map=a.collect=function(t,r,c){var h=[];return t==null?h:y&&t.map===y?t.map(r,c):(I(t,function(g,w,M){h.push(r.call(c,g,w,M))}),h)};var ne="Reduce of empty array with no initial value";a.reduce=a.foldl=a.inject=function(t,r,c,h){var g=arguments.length>2;if(t==null&&(t=[]),N&&t.reduce===N)return h&&(r=a.bind(r,h)),g?t.reduce(r,c):t.reduce(r);if(I(t,function(w,M,b){g?c=r.call(h,c,w,M,b):(c=w,g=!0)}),!g)throw new TypeError(ne);return c},a.reduceRight=a.foldr=function(t,r,c,h){var g=arguments.length>2;if(t==null&&(t=[]),P&&t.reduceRight===P)return h&&(r=a.bind(r,h)),g?t.reduceRight(r,c):t.reduceRight(r);var w=t.length;if(w!==+w){var M=a.keys(t);w=M.length}if(I(t,function(b,C,A){C=M?M[--w]:--w,g?c=r.call(h,c,t[C],C,A):(c=t[C],g=!0)}),!g)throw new TypeError(ne);return c},a.find=a.detect=function(t,r,c){var h;return W(t,function(g,w,M){if(r.call(c,g,w,M))return h=g,!0}),h},a.filter=a.select=function(t,r,c){var h=[];return t==null?h:S&&t.filter===S?t.filter(r,c):(I(t,function(g,w,M){r.call(c,g,w,M)&&h.push(g)}),h)},a.reject=function(t,r,c){return a.filter(t,function(h,g,w){return!r.call(c,h,g,w)},c)},a.every=a.all=function(t,r,c){r||(r=a.identity);var h=!0;return t==null?h:x&&t.every===x?t.every(r,c):(I(t,function(g,w,M){if(!(h=h&&r.call(c,g,w,M)))return e}),!!h)};var W=a.some=a.any=function(t,r,c){r||(r=a.identity);var h=!1;return t==null?h:F&&t.some===F?t.some(r,c):(I(t,function(g,w,M){if(h||(h=r.call(c,g,w,M)))return e}),!!h)};a.contains=a.include=function(t,r){return t==null?!1:X&&t.indexOf===X?t.indexOf(r)!=-1:W(t,function(c){return c===r})},a.invoke=function(t,r){var c=p.call(arguments,2),h=a.isFunction(r);return a.map(t,function(g){return(h?r:g[r]).apply(g,c)})},a.pluck=function(t,r){return a.map(t,a.property(r))},a.where=function(t,r){return a.filter(t,a.matches(r))},a.findWhere=function(t,r){return a.find(t,a.matches(r))},a.max=function(t,r,c){if(!r&&a.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var h=-1/0,g=-1/0;return I(t,function(w,M,b){var C=r?r.call(c,w,M,b):w;C>g&&(h=w,g=C)}),h},a.min=function(t,r,c){if(!r&&a.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var h=1/0,g=1/0;return I(t,function(w,M,b){var C=r?r.call(c,w,M,b):w;C<g&&(h=w,g=C)}),h},a.shuffle=function(t){var r,c=0,h=[];return I(t,function(g){r=a.random(c++),h[c-1]=h[r],h[r]=g}),h},a.sample=function(t,r,c){return r==null||c?(t.length!==+t.length&&(t=a.values(t)),t[a.random(t.length-1)]):a.shuffle(t).slice(0,Math.max(0,r))};var T=function(t){return t==null?a.identity:a.isFunction(t)?t:a.property(t)};a.sortBy=function(t,r,c){return r=T(r),a.pluck(a.map(t,function(h,g,w){return{value:h,index:g,criteria:r.call(c,h,g,w)}}).sort(function(h,g){var w=h.criteria,M=g.criteria;if(w!==M){if(w>M||w===void 0)return 1;if(w<M||M===void 0)return-1}return h.index-g.index}),"value")};var V=function(t){return function(r,c,h){var g={};return c=T(c),I(r,function(w,M){var b=c.call(h,w,M,r);t(g,b,w)}),g}};a.groupBy=V(function(t,r,c){a.has(t,r)?t[r].push(c):t[r]=[c]}),a.indexBy=V(function(t,r,c){t[r]=c}),a.countBy=V(function(t,r){a.has(t,r)?t[r]++:t[r]=1}),a.sortedIndex=function(t,r,c,h){c=T(c);for(var g=c.call(h,r),w=0,M=t.length;w<M;){var b=w+M>>>1;c.call(h,t[b])<g?w=b+1:M=b}return w},a.toArray=function(t){return t?a.isArray(t)?p.call(t):t.length===+t.length?a.map(t,a.identity):a.values(t):[]},a.size=function(t){return t==null?0:t.length===+t.length?t.length:a.keys(t).length},a.first=a.head=a.take=function(t,r,c){if(t!=null)return r==null||c?t[0]:r<0?[]:p.call(t,0,r)},a.initial=function(t,r,c){return p.call(t,0,t.length-(r==null||c?1:r))},a.last=function(t,r,c){if(t!=null)return r==null||c?t[t.length-1]:p.call(t,Math.max(t.length-r,0))},a.rest=a.tail=a.drop=function(t,r,c){return p.call(t,r==null||c?1:r)},a.compact=function(t){return a.filter(t,a.identity)};var m=function(t,r,c){return r&&a.every(t,a.isArray)?n.apply(c,t):(I(t,function(h){a.isArray(h)||a.isArguments(h)?r?v.apply(c,h):m(h,r,c):c.push(h)}),c)};a.flatten=function(t,r){return m(t,r,[])},a.without=function(t){return a.difference(t,p.call(arguments,1))},a.partition=function(t,r){var c=[],h=[];return I(t,function(g){(r(g)?c:h).push(g)}),[c,h]},a.uniq=a.unique=function(t,r,c,h){a.isFunction(r)&&(h=c,c=r,r=!1);var g=c?a.map(t,c,h):t,w=[],M=[];return I(g,function(b,C){(r?!C||M[M.length-1]!==b:!a.contains(M,b))&&(M.push(b),w.push(t[C]))}),w},a.union=function(){return a.uniq(a.flatten(arguments,!0))},a.intersection=function(t){var r=p.call(arguments,1);return a.filter(a.uniq(t),function(c){return a.every(r,function(h){return a.contains(h,c)})})},a.difference=function(t){var r=n.apply(s,p.call(arguments,1));return a.filter(t,function(c){return!a.contains(r,c)})},a.zip=function(){for(var t=a.max(a.pluck(arguments,"length").concat(0)),r=new Array(t),c=0;c<t;c++)r[c]=a.pluck(arguments,""+c);return r},a.object=function(t,r){if(t==null)return{};for(var c={},h=0,g=t.length;h<g;h++)r?c[t[h]]=r[h]:c[t[h][0]]=t[h][1];return c},a.indexOf=function(t,r,c){if(t==null)return-1;var h=0,g=t.length;if(c)if(typeof c=="number")h=c<0?Math.max(0,g+c):c;else return h=a.sortedIndex(t,r),t[h]===r?h:-1;if(X&&t.indexOf===X)return t.indexOf(r,c);for(;h<g;h++)if(t[h]===r)return h;return-1},a.lastIndexOf=function(t,r,c){if(t==null)return-1;var h=c!=null;if(te&&t.lastIndexOf===te)return h?t.lastIndexOf(r,c):t.lastIndexOf(r);for(var g=h?c:t.length;g--;)if(t[g]===r)return g;return-1},a.range=function(t,r,c){arguments.length<=1&&(r=t||0,t=0),c=arguments[2]||1;for(var h=Math.max(Math.ceil((r-t)/c),0),g=0,w=new Array(h);g<h;)w[g++]=t,t+=c;return w};var _=function(){};a.bind=function(t,r){var c,h;if(k&&t.bind===k)return k.apply(t,p.call(arguments,1));if(!a.isFunction(t))throw new TypeError;return c=p.call(arguments,2),h=function(){if(!(this instanceof h))return t.apply(r,c.concat(p.call(arguments)));_.prototype=t.prototype;var g=new _;_.prototype=null;var w=t.apply(g,c.concat(p.call(arguments)));return Object(w)===w?w:g}},a.partial=function(t){var r=p.call(arguments,1);return function(){for(var c=0,h=r.slice(),g=0,w=h.length;g<w;g++)h[g]===a&&(h[g]=arguments[c++]);for(;c<arguments.length;)h.push(arguments[c++]);return t.apply(this,h)}},a.bindAll=function(t){var r=p.call(arguments,1);if(r.length===0)throw new Error("bindAll must be passed function names");return I(r,function(c){t[c]=a.bind(t[c],t)}),t},a.memoize=function(t,r){var c={};return r||(r=a.identity),function(){var h=r.apply(this,arguments);return a.has(c,h)?c[h]:c[h]=t.apply(this,arguments)}},a.delay=function(t,r){var c=p.call(arguments,2);return setTimeout(function(){return t.apply(null,c)},r)},a.defer=function(t){return a.delay.apply(a,[t,1].concat(p.call(arguments,1)))},a.throttle=function(t,r,c){var h,g,w,M=null,b=0;c||(c={});var C=function(){b=c.leading===!1?0:a.now(),M=null,w=t.apply(h,g),h=g=null};return function(){var A=a.now();!b&&c.leading===!1&&(b=A);var U=r-(A-b);return h=this,g=arguments,U<=0?(clearTimeout(M),M=null,b=A,w=t.apply(h,g),h=g=null):!M&&c.trailing!==!1&&(M=setTimeout(C,U)),w}},a.debounce=function(t,r,c){var h,g,w,M,b,C=function(){var A=a.now()-M;A<r?h=setTimeout(C,r-A):(h=null,c||(b=t.apply(w,g),w=g=null))};return function(){w=this,g=arguments,M=a.now();var A=c&&!h;return h||(h=setTimeout(C,r)),A&&(b=t.apply(w,g),w=g=null),b}},a.once=function(t){var r=!1,c;return function(){return r||(r=!0,c=t.apply(this,arguments),t=null),c}},a.wrap=function(t,r){return a.partial(r,t)},a.compose=function(){var t=arguments;return function(){for(var r=arguments,c=t.length-1;c>=0;c--)r=[t[c].apply(this,r)];return r[0]}},a.after=function(t,r){return function(){if(--t<1)return r.apply(this,arguments)}},a.keys=function(t){if(!a.isObject(t))return[];if(H)return H(t);var r=[];for(var c in t)a.has(t,c)&&r.push(c);return r},a.values=function(t){for(var r=a.keys(t),c=r.length,h=new Array(c),g=0;g<c;g++)h[g]=t[r[g]];return h},a.pairs=function(t){for(var r=a.keys(t),c=r.length,h=new Array(c),g=0;g<c;g++)h[g]=[r[g],t[r[g]]];return h},a.invert=function(t){for(var r={},c=a.keys(t),h=0,g=c.length;h<g;h++)r[t[c[h]]]=c[h];return r},a.functions=a.methods=function(t){var r=[];for(var c in t)a.isFunction(t[c])&&r.push(c);return r.sort()},a.extend=function(t){return I(p.call(arguments,1),function(r){if(r)for(var c in r)t[c]=r[c]}),t},a.pick=function(t){var r={},c=n.apply(s,p.call(arguments,1));return I(c,function(h){h in t&&(r[h]=t[h])}),r},a.omit=function(t){var r={},c=n.apply(s,p.call(arguments,1));for(var h in t)a.contains(c,h)||(r[h]=t[h]);return r},a.defaults=function(t){return I(p.call(arguments,1),function(r){if(r)for(var c in r)t[c]===void 0&&(t[c]=r[c])}),t},a.clone=function(t){return a.isObject(t)?a.isArray(t)?t.slice():a.extend({},t):t},a.tap=function(t,r){return r(t),t};var O=function(t,r,c,h){if(t===r)return t!==0||1/t==1/r;if(t==null||r==null)return t===r;t instanceof a&&(t=t._wrapped),r instanceof a&&(r=r._wrapped);var g=u.call(t);if(g!=u.call(r))return!1;switch(g){case"[object String]":return t==String(r);case"[object Number]":return t!=+t?r!=+r:t==0?1/t==1/r:t==+r;case"[object Date]":case"[object Boolean]":return+t==+r;case"[object RegExp]":return t.source==r.source&&t.global==r.global&&t.multiline==r.multiline&&t.ignoreCase==r.ignoreCase}if(typeof t!="object"||typeof r!="object")return!1;for(var w=c.length;w--;)if(c[w]==t)return h[w]==r;var M=t.constructor,b=r.constructor;if(M!==b&&!(a.isFunction(M)&&M instanceof M&&a.isFunction(b)&&b instanceof b)&&"constructor"in t&&"constructor"in r)return!1;c.push(t),h.push(r);var C=0,A=!0;if(g=="[object Array]"){if(C=t.length,A=C==r.length,A)for(;C--&&(A=O(t[C],r[C],c,h)););}else{for(var U in t)if(a.has(t,U)&&(C++,!(A=a.has(r,U)&&O(t[U],r[U],c,h))))break;if(A){for(U in r)if(a.has(r,U)&&!C--)break;A=!C}}return c.pop(),h.pop(),A};a.isEqual=function(t,r){return O(t,r,[],[])},a.isEmpty=function(t){if(t==null)return!0;if(a.isArray(t)||a.isString(t))return t.length===0;for(var r in t)if(a.has(t,r))return!1;return!0},a.isElement=function(t){return!!(t&&t.nodeType===1)},a.isArray=j||function(t){return u.call(t)=="[object Array]"},a.isObject=function(t){return t===Object(t)},I(["Arguments","Function","String","Number","Date","RegExp"],function(t){a["is"+t]=function(r){return u.call(r)=="[object "+t+"]"}}),a.isArguments(arguments)||(a.isArguments=function(t){return!!(t&&a.has(t,"callee"))}),typeof/./!="function"&&(a.isFunction=function(t){return typeof t=="function"}),a.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},a.isNaN=function(t){return a.isNumber(t)&&t!=+t},a.isBoolean=function(t){return t===!0||t===!1||u.call(t)=="[object Boolean]"},a.isNull=function(t){return t===null},a.isUndefined=function(t){return t===void 0},a.has=function(t,r){return o.call(t,r)},a.noConflict=function(){return f._=i,this},a.identity=function(t){return t},a.constant=function(t){return function(){return t}},a.property=function(t){return function(r){return r[t]}},a.matches=function(t){return function(r){if(r===t)return!0;for(var c in t)if(t[c]!==r[c])return!1;return!0}},a.times=function(t,r,c){for(var h=Array(Math.max(0,t)),g=0;g<t;g++)h[g]=r.call(c,g);return h},a.random=function(t,r){return r==null&&(r=t,t=0),t+Math.floor(Math.random()*(r-t+1))},a.now=Date.now||function(){return new Date().getTime()};var D={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};D.unescape=a.invert(D.escape);var G={escape:new RegExp("["+a.keys(D.escape).join("")+"]","g"),unescape:new RegExp("("+a.keys(D.unescape).join("|")+")","g")};a.each(["escape","unescape"],function(t){a[t]=function(r){return r==null?"":(""+r).replace(G[t],function(c){return D[t][c]})}}),a.result=function(t,r){if(t!=null){var c=t[r];return a.isFunction(c)?c.call(t):c}},a.mixin=function(t){I(a.functions(t),function(r){var c=a[r]=t[r];a.prototype[r]=function(){var h=[this._wrapped];return v.apply(h,arguments),z.call(this,c.apply(a,h))}})};var Y=0;a.uniqueId=function(t){var r=++Y+"";return t?t+r:r},a.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var B=/(.)^/,L={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},$=/\\|'|\r|\n|\t|\u2028|\u2029/g;a.template=function(t,r,c){var h;c=a.defaults({},c,a.templateSettings);var g=new RegExp([(c.escape||B).source,(c.interpolate||B).source,(c.evaluate||B).source].join("|")+"|$","g"),w=0,M="__p+='";t.replace(g,function(C,A,U,Me,Pe){return M+=t.slice(w,Pe).replace($,function(je){return"\\"+L[je]}),A&&(M+=`'+
((__t=(`+A+`))==null?'':_.escape(__t))+
'`),U&&(M+=`'+
((__t=(`+U+`))==null?'':__t)+
'`),Me&&(M+=`';
`+Me+`
__p+='`),w=Pe+C.length,C}),M+=`';
`,c.variable||(M=`with(obj||{}){
`+M+`}
`),M=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+M+`return __p;
`;try{h=new Function(c.variable||"obj","_",M)}catch(C){throw C.source=M,C}if(r)return h(r,a);var b=function(C){return h.call(this,C,a)};return b.source="function("+(c.variable||"obj")+`){
`+M+"}",b},a.chain=function(t){return a(t).chain()};var z=function(t){return this._chain?a(t).chain():t};a.mixin(a),I(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var r=s[t];a.prototype[t]=function(){var c=this._wrapped;return r.apply(c,arguments),(t=="shift"||t=="splice")&&c.length===0&&delete c[0],z.call(this,c)}}),I(["concat","join","slice"],function(t){var r=s[t];a.prototype[t]=function(){return z.call(this,r.apply(this._wrapped,arguments))}}),a.extend(a.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),typeof define=="function"&&define.amd&&define("underscore",[],function(){return a})}).call(ue)});var Ge=ae((fe,Ee)=>{(function(){var s=this,f=Ue().EventEmitter,i=qe(),e=/([0-9\.]+)(ms|s|m|h)?/,s=globalThis||window;typeof Function.prototype.inherits>"u"&&(Function.prototype.inherits=function(p){this.prototype=Object.create(p.prototype)}),typeof Array.prototype.removeOne>"u"&&(Array.prototype.removeOne=function(){for(var p,n=arguments,u=n.length,o;u&&this.length;)for(p=n[--u];(o=this.indexOf(p))!==-1;)return this.splice(o,1)});function d(p){for(var n=1,u=i.min(p);n!==0;)n=i.reduce(p,function(o,l){return o+l%u},0),n!==0&&(u-=10);return u}function E(p){var n=e.exec(p);if(!n)throw new Error("I don't understand that particular interval");var u=+n[1],o=n[2]||"ms";if(o==="s")u=u*1e3;else if(o==="m")u=u*1e3*60;else if(o==="h")u=u*1e3*60*60;else if(o&&o!=="ms")throw new Error("You can only specify intervals of ms, s, m, or h");if(u<10||u%10!==0)throw new Error("You can only specify 10s of milliseconds, trust me on this one");return{amount:u,type:o}}function v(){this.intervalId=void 0,this.intervalLength=void 0,this.intervalsToEmit={},this.currentTick=1,this.maxTicks=0,this.listeningForFocus=!1;var p=function(){var n=d(i.keys(this.intervalsToEmit)),u=!1;return this.intervalLength?n!==this.intervalLength&&(this.intervalLength=n,u=!0):this.intervalLength=n,this.maxTicks=i.max(i.map(i.keys(this.intervalsToEmit),function(o){return+o}))/this.intervalLength,u}.bind(this);this.on("newListener",function(n){if(!(n==="removeListener"||n==="newListener")){var u=E(n),o=u.amount;this.intervalsToEmit[+o]=i.union(this.intervalsToEmit[+o]||[],[n]),p()&&this.isStarted()&&this.stop().start()}}),this.on("removeListener",function(n){if(!(f.listenerCount(this,n)>0)){var u=E(n),o=u.amount,l=this.intervalsToEmit[+o].removeOne(n);this.intervalsToEmit[+o].length===0&&delete this.intervalsToEmit[+o],console.log("Determining interval length after removal of",l),p(),p()&&this.isStarted()&&this.stop().start()}})}v.inherits(f),v.prototype.tick=function(){var p=this.currentTick*this.intervalLength;return i.each(this.intervalsToEmit,function(n,u){p%u===0&&i.each(n,function(o){this.emit(o,o,u)}.bind(this))}.bind(this)),this.currentTick+=1,this.currentTick>this.maxTicks&&(this.currentTick=1),this},v.prototype.start=function(){if(!this.intervalLength)throw new Error("You haven't specified any interval callbacks. Use EventedLoop.on('500ms', function () { ... }) to do so, and then you can start");return this.intervalId?console.log("No need to start the loop again, it's already started."):(this.intervalId=setInterval(this.tick.bind(this),this.intervalLength),s&&!this.listeningForFocus&&s.addEventListener&&(s.addEventListener("focus",function(){this.start()}.bind(this)),s.addEventListener("blur",function(){this.stop()}.bind(this)),this.listeningForFocus=!0),this)},v.prototype.stop=function(){return clearInterval(this.intervalId),this.intervalId=void 0,this},v.prototype.isStarted=function(){return!!this.intervalId},v.prototype.every=v.prototype.on,typeof fe<"u"&&(typeof Ee<"u"&&Ee.exports&&(fe=Ee.exports=v),fe.EventedLoop=v),typeof window<"u"&&(window.EventedLoop=v)}).call(fe)});CanvasRenderingContext2D.prototype.storeLoadedImage=function(f,i){this.images||(this.images={}),this.images[f]=i};CanvasRenderingContext2D.prototype.getLoadedImage=function(f){if(this.images[f])return this.images[f]};CanvasRenderingContext2D.prototype.followSprite=function(f){this.centralSprite=f};CanvasRenderingContext2D.prototype.getCentralPosition=function(){return{map:this.centralSprite.mapPosition,canvas:[Math.round(this.canvas.width*.5),Math.round(this.canvas.height*.5),0]}};CanvasRenderingContext2D.prototype.mapPositionToCanvasPosition=function(f){var i=this.getCentralPosition(),e=i.map,s=i.canvas,d=e[0]-f[0],E=e[1]-f[1];return[s[0]-d,s[1]-E]};CanvasRenderingContext2D.prototype.canvasPositionToMapPosition=function(f){var i=this.getCentralPosition(),e=i.map,s=i.canvas,d=s[0]-f[0],E=s[1]-f[1];return[e[0]-d,e[1]-E]};CanvasRenderingContext2D.prototype.getCentreOfViewport=function(){return Math.floor(this.canvas.width/2)};CanvasRenderingContext2D.prototype.getMiddleOfViewport=function(){return Math.floor(this.canvas.height/2)};CanvasRenderingContext2D.prototype.getBelowViewport=function(){return Math.floor(this.canvas.height)};CanvasRenderingContext2D.prototype.getMapBelowViewport=function(){var f=this.getBelowViewport();return this.canvasPositionToMapPosition([0,f])[1]};CanvasRenderingContext2D.prototype.getRandomlyInTheCentreOfCanvas=function(f){var i=0,e=this.canvas.width;return f&&(i-=f,e+=f),Math.floor(Math.random()*(e-i+1))+i};CanvasRenderingContext2D.prototype.getRandomlyInTheCentreOfMap=function(f){var i=this.getRandomlyInTheCentreOfCanvas(f);return this.canvasPositionToMapPosition([i,0])[0]};CanvasRenderingContext2D.prototype.getRandomMapPositionBelowViewport=function(){var f=this.getRandomlyInTheCentreOfCanvas(),i=this.getBelowViewport();return this.canvasPositionToMapPosition([f,i])};CanvasRenderingContext2D.prototype.getRandomMapPositionAboveViewport=function(){var f=this.getRandomlyInTheCentreOfCanvas(),i=this.getAboveViewport();return this.canvasPositionToMapPosition([f,i])};CanvasRenderingContext2D.prototype.getTopOfViewport=function(){return this.canvasPositionToMapPosition([0,0])[1]};CanvasRenderingContext2D.prototype.getAboveViewport=function(){return 0-Math.floor(this.canvas.height/4)};Function.prototype.method=function(f,i){return Object.defineProperty(this.prototype,f,{value:i,enumerable:!1,writable:!0,configurable:!0}),this};Object.method("superior",function(f){var i=this,e=i[f];return function(){return e.apply(i,arguments)}});var Ze=ye(Oe(),1),J=ye(xe(),1);function at(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}var Ce=at;function oe(){return this.pushHandlers=[],this}oe.prototype=Object.create(Array.prototype);oe.prototype.onPush=function(f,i){this.pushHandlers.push(f),i&&this.forEach(f)};oe.prototype.push=function(f){Array.prototype.push.call(this,f),this.pushHandlers.forEach(function(i){i(f)})};oe.prototype.cull=function(){this.forEach(function(f,i){if(f.deleted)return delete this[i]})};var ie=oe;function ot(){var f=function(){return Math.floor(Math.random()*65536).toString(16)};return f()+f()+"-"+f()+"-"+f()+"-"+f()+"-"+f()+f()+f()}var Ne=ot;function we(f){var i={},e=[0],s=this,d;s.direction=void 0,s.mapPosition=[0,0,0],s.id=Ne(),s.canvasX=0,s.canvasY=0,s.canvasZ=0,s.height=0,s.speed=0,s.data=f||{parts:{}},s.movingToward=[0,0],s.metresDownTheMountain=0,s.movingWithConviction=!1,s.deleted=!1,s.data.parts||(s.data.parts={}),s.maxHeight=(function(){var o=Object.values(s.data.parts).map(function(l){return l[3]});return o.length?Math.max.apply(null,o):void 0})(),s.isMoving=!0,f&&f.id&&(s.id=f.id),f&&f.zIndexesOccupied&&(e=f.zIndexesOccupied);function E(o){s.canvasX+=parseFloat(o)}function v(o){s.canvasY+=parseFloat(o)}function p(o){if(s.data.hitBoxes&&f.hitBoxes[o])return f.hitBoxes[o]}function n(o){return o=Math.round(o*2)/2,o}function u(){if(s.isMoving){var o=s.mapPosition[0],l=s.mapPosition[1];if(typeof s.direction<"u"){var y=s.direction-90;y<0&&(y=360+y),o+=n(s.speed*Math.cos(y*(Math.PI/180))),l+=n(s.speed*Math.sin(y*(Math.PI/180)))}else typeof s.movingToward[0]<"u"&&(o>s.movingToward[0]?o-=Math.min(s.getSpeedX(),Math.abs(o-s.movingToward[0])):o<s.movingToward[0]&&(o+=Math.min(s.getSpeedX(),Math.abs(o-s.movingToward[0])))),typeof s.movingToward[1]<"u"&&(l>s.movingToward[1]?l-=Math.min(s.getSpeedY(),Math.abs(l-s.movingToward[1])):l<s.movingToward[1]&&(l+=Math.min(s.getSpeedY(),Math.abs(l-s.movingToward[1]))));s.setMapPosition(o,l)}}return this.draw=function(o,l){var y=s.data.parts[l];s.height=y[3],s.width=y[2];var N=o.mapPositionToCanvasPosition(s.mapPosition);s.setCanvasPosition(N[0],N[1]),o.drawImage(o.getLoadedImage(s.data.$imageFile),y[0],y[1],y[2],y[3],s.canvasX,s.canvasY,y[2],y[3])},this.setMapPosition=function(o,l,y){typeof o>"u"&&(o=s.mapPosition[0]),typeof l>"u"&&(l=s.mapPosition[1]),typeof y>"u"?y=s.mapPosition[2]:s.zIndexesOccupied=[y],s.mapPosition=[o,l,y]},this.setCanvasPosition=function(o,l){o&&(typeof o=="string"&&(o[0]==="+"||o[0]==="-")?E(o):s.canvasX=o),l&&(typeof l=="string"&&(l[0]==="+"||l[0]==="-")?v(l):s.canvasY=l)},this.getCanvasPositionX=function(){return s.canvasX},this.getCanvasPositionY=function(){return s.canvasY},this.getLeftHitBoxEdge=function(o){o=o||0;var l=this.getCanvasPositionX();return p(o)&&(l+=p(o)[0]),l},this.getTopHitBoxEdge=function(o){o=o||0;var l=this.getCanvasPositionY();return p(o)&&(l+=p(o)[1]),l},this.getRightHitBoxEdge=function(o){return o=o||0,p(o)?s.canvasX+p(o)[2]:s.canvasX+s.width},this.getBottomHitBoxEdge=function(o){return o=o||0,p(o)?s.canvasY+p(o)[3]:s.canvasY+s.height},this.getPositionInFrontOf=function(){return[s.canvasX,s.canvasY+s.height]},this.setSpeed=function(o){s.speed=o,s.speedX=o,s.speedY=o},this.incrementSpeedBy=function(o){s.speed+=o},s.getSpeed=function(){return s.speed},s.getSpeedX=function(){return s.speed},s.getSpeedY=function(){return s.speed},this.setHeight=function(o){s.height=o},this.setWidth=function(o){s.width=o},this.getMaxHeight=function(){return s.maxHeight},s.getMovingTowardOpposite=function(){if(!s.isMoving)return[0,0];var o=s.movingToward[0]-s.mapPosition[0],l=s.movingToward[1]-s.mapPosition[1],y=Math.abs(o)>75?0-o:0,N=-l;return[y,N]},this.checkHittableObjects=function(){Object.keys(i).forEach(function(o){var l=i[o];l.object.deleted?delete i[o]:l.object.hits(s)&&l.callbacks.forEach(function(y){y(s,l.object)})})},this.cycle=function(){s.checkHittableObjects(),d&&s.setMapPositionTarget(d.mapPosition[0],d.mapPosition[1],!0),u()},this.setMapPositionTarget=function(o,l,y){y&&(s.movingWithConviction=!1),s.movingWithConviction||(typeof o>"u"&&(o=s.movingToward[0]),typeof l>"u"&&(l=s.movingToward[1]),s.movingToward=[o,l],s.movingWithConviction=!1)},this.setDirection=function(o){o>=360&&(o=360-o),s.direction=o,s.movingToward=void 0},this.resetDirection=function(){s.direction=void 0},this.setMapPositionTargetWithConviction=function(o,l){s.setMapPositionTarget(o,l),s.movingWithConviction=!0},this.follow=function(o){d=o},this.stopFollowing=function(){d=!1},this.onHitting=function(o,l){if(i[o.id])return i[o.id].callbacks.push(l);i[o.id]={object:o,callbacks:[l]}},this.deleteOnNextCycle=function(){s.deleted=!0},this.occupiesZIndex=function(o){return e.indexOf(o)>=0},this.hits=function(o){var l=!1,y=!1;return o.getTopHitBoxEdge(s.mapPosition[2])<=s.getBottomHitBoxEdge(s.mapPosition[2])&&o.getBottomHitBoxEdge(s.mapPosition[2])>=s.getBottomHitBoxEdge(s.mapPosition[2])&&(l=!0),o.getTopHitBoxEdge(s.mapPosition[2])<=s.getTopHitBoxEdge(s.mapPosition[2])&&o.getBottomHitBoxEdge(s.mapPosition[2])>=s.getTopHitBoxEdge(s.mapPosition[2])&&(l=!0),o.getLeftHitBoxEdge(s.mapPosition[2])<=s.getRightHitBoxEdge(s.mapPosition[2])&&o.getRightHitBoxEdge(s.mapPosition[2])>=s.getRightHitBoxEdge(s.mapPosition[2])&&(y=!0),o.getLeftHitBoxEdge(s.mapPosition[2])<=s.getLeftHitBoxEdge(s.mapPosition[2])&&o.getRightHitBoxEdge(s.mapPosition[2])>=s.getLeftHitBoxEdge(s.mapPosition[2])&&(y=!0),l&&y},this.isAboveOnCanvas=function(o){return s.canvasY+s.height<o},this.isBelowOnCanvas=function(o){return s.canvasY>o},s}we.createObjects=function(i,e){Array.isArray(i)||(i=[i]),e=Object.assign({rateModifier:0,dropRate:1,position:[0,0]},e);function s(E){var v=e.position;if(Math.floor(Math.random()*(101+e.rateModifier))<=E.dropRate){var p=new we(E.sprite);return p.setSpeed(0),typeof v=="function"&&(v=v()),p.setMapPosition(v[0],v[1]),E.sprite.hitBehaviour&&E.sprite.hitBehaviour.skier&&e.player&&p.onHitting(e.player,E.sprite.hitBehaviour.skier),p}}var d=i.map(s).filter(function(E){return E!==void 0});return d};var Z=we;function ut(f){var i=new Z(f),e=i.superior("draw"),s=1,d=0,E=6;i.isEating=!1,i.isFull=!1,i.setSpeed(E),i.draw=function(p){var n=function(){var u=i.movingToward[0]-i.canvasX;if(i.isEating)return"eating"+d;if(s+.1>2?s=.1:s+=.1,u>=0)return"sEast"+Math.ceil(s);if(u<0)return"sWest"+Math.ceil(s)};return e(p,n())};function v(p){d+=1,i.isEating=!0,i.isMoving=!1,d<6?setTimeout(function(){v(p)},300):(d=0,i.isEating=!1,i.isMoving=!0,p())}return i.startEating=v,i}var be=ut;function ft(f){var i=new Z(f),e={draw:i.superior("draw"),cycle:i.superior("cycle")},s={sEast:function(v){return v>0},sWest:function(v){return v<=0}},d=3;i.setSpeed(d);function E(){var v=i.movingToward[0]-i.mapPosition[0],p=i.movingToward[1]-i.mapPosition[1];return s.sEast(v)?"sEast":"sWest"}return i.cycle=function(v){Math.floor(Math.random()*11)===1&&(i.setMapPositionTarget(v.getRandomlyInTheCentreOfMap()),i.setSpeed(d+Math.floor(Math.random()*3)-1)),i.setMapPositionTarget(void 0,v.getMapBelowViewport()+600),e.cycle()},i.draw=function(v){var p=function(){return E()};return e.draw(v,p())},i}var De=ft;typeof navigator<"u"?navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate:globalThis.navigator={vibrate:!1};function ct(f){var i={west:270,wsWest:240,sWest:195,south:180,sEast:165,esEast:120,east:90},e=new Z(f),s={draw:e.superior("draw"),cycle:e.superior("cycle"),getSpeedX:e.superior("getSpeedX"),getSpeedY:e.superior("getSpeedY"),hits:e.superior("hits")},d={esEast:function(T){return T>300},sEast:function(T){return T>75},wsWest:function(T){return T<-300},sWest:function(T){return T<-75}},E,v,p=!0,n=[],u=0,o=5,l=2,y=70,N=0,P=0,S=0,x=1,F=0;e.isMoving=!0,e.hasBeenHit=!1,e.isJumping=!1,e.isPerformingTrick=!1,e.onHitObstacleCb=function(){},e.setSpeed(o),e.reset=function(){n=[],u=0,e.isMoving=!0,e.hasBeenHit=!1,p=!0,X()};function X(){e.setSpeed(o),e.isMoving=!0,e.hasBeenHit=!1,e.isJumping=!1,e.isPerformingTrick=!1,v&&clearInterval(v),e.setMapPosition(void 0,void 0,0)}function te(){e.isMoving=!1,e.hasBeenHit=!0,e.isJumping=!1,e.isPerformingTrick=!1,v&&clearInterval(v),e.setMapPosition(void 0,void 0,0)}function j(){var T=e.getSpeed();e.setSpeed(T+2),e.setSpeedY(T+2),e.isMoving=!0,e.hasBeenHit=!1,e.isJumping=!0,e.setMapPosition(void 0,void 0,1)}function H(){if(e.direction)return e.direction<=90?"east":e.direction>90&&e.direction<150?"esEast":e.direction>=150&&e.direction<180?"sEast":e.direction===180?"south":e.direction>180&&e.direction<=210?"sWest":e.direction>210&&e.direction<270?"wsWest":e.direction>=270?"west":"south";var T=e.movingToward[0]-e.mapPosition[0],V=e.movingToward[1]-e.mapPosition[1];return V<=0?T>0?"east":"west":d.esEast(T)?"esEast":d.sEast(T)?"sEast":d.wsWest(T)?"wsWest":d.sWest(T)?"sWest":"south"}function k(T){i[T]&&e.setDirection(i[T]),T==="west"||T==="east"?e.isMoving=!1:e.isMoving=!0}function a(){return"blank"}function I(){return"jumping"}function ne(){return console.log("Trick step is",F),F===0?"jumping":F===1?"somersault1":"somersault2"}e.stop=function(){e.direction>180?k("west"):k("east")},e.turnEast=function(){if(!e.hasBeenHit){var T=H();switch(T){case"west":k("wsWest");break;case"wsWest":k("sWest");break;case"sWest":k("south");break;case"south":k("sEast");break;case"sEast":k("esEast");break;case"esEast":k("east");break;default:k("south");break}}},e.turnWest=function(){if(!e.hasBeenHit){var T=H();switch(T){case"east":k("esEast");break;case"esEast":k("sEast");break;case"sEast":k("south");break;case"south":k("sWest");break;case"sWest":k("wsWest");break;case"wsWest":k("west");break;default:k("south");break}}},e.stepWest=function(){e.hasBeenHit||(e.mapPosition[0]-=e.speed*2)},e.stepEast=function(){e.hasBeenHit||(e.mapPosition[0]+=e.speed*2)},e.setMapPositionTarget=function(T,V){e.hasBeenHit||(Math.abs(e.mapPosition[0]-T)<=75&&(T=e.mapPosition[0]),e.movingToward=[T,V])},e.startMovingIfPossible=function(){!e.hasBeenHit&&!e.isBeingEaten&&(e.isMoving=!0)},e.setTurnEaseCycles=function(T){y=T},e.getPixelsTravelledDownMountain=function(){return u},e.resetSpeed=function(){e.setSpeed(o)},e.cycle=function(){e.getSpeedX()<=0&&e.getSpeedY()<=0&&(e.isMoving=!1),e.isMoving&&(u+=e.speed),e.isJumping&&e.setMapPositionTarget(void 0,e.mapPosition[1]+e.getSpeed()),s.cycle(),e.checkHittableObjects()},e.draw=function(T){var V=function(){return e.isBeingEaten?a():e.isJumping?e.isPerformingTrick?ne():I():e.hasBeenHit?"hit":H()};return s.draw(T,V())},e.hits=function(T){return n.indexOf(T.id)!==-1||!T.occupiesZIndex(e.mapPosition[2])?!1:!!s.hits(T)},e.speedBoost=function(){var T=e.speed;p&&(p=!1,e.setSpeed(e.speed*l),setTimeout(function(){e.setSpeed(T),setTimeout(function(){p=!0},1e4)},2e3))},e.attemptTrick=function(){e.isJumping&&(e.isPerformingTrick=!0,v=setInterval(function(){F>=2?F=0:F+=1},300))},e.getStandardSpeed=function(){return o};function W(T,V,m){return m===0||m===1?V:(T<V&&(T+=e.getSpeed()*(m/y)),T>V&&(T-=e.getSpeed()*(m/y)),T)}return e.getSpeedX=function(){return H()==="esEast"||H()==="wsWest"?(P=.5,N=W(N,e.getSpeed()*P,P),N):H()==="sEast"||H()==="sWest"?(P=.33,N=W(N,e.getSpeed()*P,P),N):(N=W(N,0,P),N)},e.setSpeedY=function(T){S=T},e.getSpeedY=function(){var T;return e.isJumping?S:H()==="esEast"||H()==="wsWest"?(x=.6,S=W(S,e.getSpeed()*.6,.6),S):H()==="sEast"||H()==="sWest"?(x=.85,S=W(S,e.getSpeed()*.85,.85),S):H()==="east"||H()==="west"?(x=1,S=0,S):(S=W(S,e.getSpeed(),x),S)},e.hasHitObstacle=function(T){te(),navigator.vibrate&&navigator.vibrate(500),n.push(T.id),e.resetSpeed(),e.onHitObstacleCb(T),E&&clearTimeout(E),E=setTimeout(function(){X()},1500)},e.hasHitJump=function(){j(),E&&clearTimeout(E),E=setTimeout(function(){X()},1e3)},e.isEatenBy=function(T,V){e.hasHitObstacle(T),T.startEating(V),n.push(T.id),e.isMoving=!1,e.isBeingEaten=!0},e.reset=function(){n=[],u=0,e.isMoving=!0,e.isJumping=!1,e.hasBeenHit=!1,p=!0},e.setHitObstacleCb=function(T){e.onHitObstacleCb=T||function(){}},e}var Re=ct;function lt(f){var i=this;return i.lines=f.initialLines,i.top=f.position.top,i.right=f.position.right,i.bottom=f.position.bottom,i.left=f.position.left,i.width=f.width,i.height=f.height,i.setLines=function(e){i.lines=e},i.draw=function(e){e.font="11px monospace";var s=0;i.lines.forEach(function(d){var E=+e.font.slice(0,2),v=e.measureText(d).width,p=E*1.5,n,u;i.top?u=i.top+s:i.bottom&&(u=e.canvas.height-i.top-p+s),i.right?n=e.canvas.width-i.right-v:i.left&&(n=i.left),s+=p,e.fillText(d,n,u)})},i}var Ie=lt;var Je=ye(Ge(),1);function Et(f,i){var e=new ie,s=new ie,d=new ie,E=f.getContext("2d"),v=E.getCentreOfViewport(),p=0,n=!1,u=this,o=[],l=[],y=new Je.default;this.addStaticObject=function(P){e.push(P)},this.addStaticObjects=function(P){P.forEach(this.addStaticObject.bind(this))},this.addMovingObject=function(P,S){S&&e.onPush(function(x){x.data&&x.data.hitBehaviour[S]&&x.onHitting(P,x.data.hitBehaviour[S])},!0),s.push(P)},this.addUIElement=function(P){d.push(P)},this.beforeCycle=function(P){o.push(P)},this.afterCycle=function(P){l.push(P)},this.setMouseX=function(P){v=P},this.setMouseY=function(P){p=P},i.setMapPosition(0,0),i.setMapPositionTarget(0,-10),E.followSprite(i);var N=0;this.cycle=function(){o.forEach(function(S){S()});var P=E.canvasPositionToMapPosition([v,p]);i.isJumping||i.setMapPositionTarget(P[0],P[1]),N++,i.cycle(),s.forEach(function(S,x){S.cycle(E)}),e.cull(),e.forEach(function(S,x){S.cycle&&S.cycle()}),d.forEach(function(S,x){S.cycle&&S.cycle()}),l.forEach(function(S){S()})},u.draw=function(){f.width=f.width,i.draw(E),i.cycle(),s.forEach(function(P,S){P.draw(E)}),e.forEach(function(P,S){P.draw&&P.draw(E,"main")}),d.forEach(function(P,S){P.draw&&P.draw(E,"main")})},this.start=function(){y.start()},this.pause=function(){n=!0,y.stop()},this.isPaused=function(){return n},this.reset=function(){n=!1,e=new ie,s=new ie,v=E.getCentreOfViewport(),p=0,i.reset(),i.setMapPosition(0,0,0),this.start()}.bind(this),y.on("20",this.cycle),y.on("20",this.draw)}var Ke=Et;var Q={skier:{$imageFile:"sprite-characters.png",parts:{blank:[0,0,0,0],east:[0,0,24,34],esEast:[24,0,24,34],sEast:[49,0,17,34],south:[65,0,17,34],sWest:[49,37,17,34],wsWest:[24,37,24,34],west:[0,37,24,34],hit:[0,78,31,31],jumping:[84,0,32,34],somersault1:[116,0,32,34],somersault2:[148,0,32,34]},hitBoxes:{0:[7,20,27,34]},id:"player",hitBehaviour:{}},smallTree:{$imageFile:"skifree-objects.png",parts:{main:[0,28,30,34]},hitBoxes:{0:[0,18,30,34]},hitBehaviour:{}},tallTree:{$imageFile:"skifree-objects.png",parts:{main:[95,66,32,64]},zIndexesOccupied:[0,1],hitBoxes:{0:[0,54,32,64],1:[0,10,32,54]},hitBehaviour:{}},thickSnow:{$imageFile:"skifree-objects.png",parts:{main:[143,53,43,10]},hitBehaviour:{}},rock:{$imageFile:"skifree-objects.png",parts:{main:[30,52,23,11]},hitBehaviour:{}},monster:{$imageFile:"sprite-characters.png",parts:{sEast1:[64,112,26,43],sEast2:[90,112,32,43],sWest1:[64,158,26,43],sWest2:[90,158,32,43],eating1:[122,112,34,43],eating2:[156,112,31,43],eating3:[187,112,31,43],eating4:[219,112,25,43],eating5:[243,112,26,43]},hitBehaviour:{}},jump:{$imageFile:"skifree-objects.png",parts:{main:[109,55,32,8]},hitBehaviour:{}},signStart:{$imageFile:"skifree-objects.png",parts:{main:[260,103,42,27]},hitBehaviour:{}},snowboarder:{$imageFile:"sprite-characters.png",parts:{sEast:[73,229,20,29],sWest:[95,228,26,30]},hitBehaviour:{}},emptyChairLift:{$imageFile:"skifree-objects.png",parts:{main:[92,136,26,30]},zIndexesOccupied:[1]}};function yt(f){f.deleteOnNextCycle()}Q.monster.hitBehaviour.tree=yt;function $e(f,i){i.deleteOnNextCycle()}Q.smallTree.hitBehaviour.monster=$e;Q.tallTree.hitBehaviour.monster=$e;function ze(f,i){i.hasHitObstacle(f)}Q.smallTree.hitBehaviour.skier=ze;Q.tallTree.hitBehaviour.skier=ze;function wt(f,i){i.hasHitObstacle(f)}Q.rock.hitBehaviour.skier=wt;function _t(f,i){i.hasHitJump(f)}Q.jump.hitBehaviour.skier=_t;function Tt(f,i){i.hasHitObstacle(f)}Q.snowboarder.hitBehaviour.skier=Tt;var q=Q;var K=document.getElementById("skifree-canvas"),ee=K.getContext("2d"),Mt=["sprite-characters.png","skifree-objects.png"],Te="Use the mouse or WASD to control the player";Ce()&&(Te="Tap or drag on the piste to control the player");var Pt=18,ce=0,St=2e3,se=5,he=0,Ot=!1,le={smallTree:4,tallTree:2,jump:1,thickSnow:1,rock:1};localStorage.getItem("highScore")&&(he=localStorage.getItem("highScore"));function xt(f,i){var e=0,s={};function d(){e+=1,e===f.length&&i(s)}f.forEach(function(E){var v=new Image;v.onload=d,v.src=E,ee.storeLoadedImage(E,v)})}function Ct(f,i){i.isEatenBy(f,function(){se-=1,f.isFull=!0,f.isEating=!1,i.isBeingEaten=!1,f.setSpeed(i.getSpeed()),f.stopFollowing();var e=ee.getRandomMapPositionAboveViewport();f.setMapPositionTarget(e[0],e[1])})}function Nt(f){var i,e,s,d;function E(){ce=0,se=5,he=localStorage.getItem("highScore"),d.reset(),d.addStaticObject(e)}function v(){d.isPaused()||(he=localStorage.setItem("highScore",ce),s.setLines(["Game over!","Hit space to restart"]),d.pause(),d.cycle())}function p(l,y){var N=Math.max(800-K.width,0);Math.floor(Math.random()*(1001+N))<=y&&l()}function n(){var l=new be(q.monster),y=ee.getRandomMapPositionAboveViewport();l.setMapPosition(y[0],y[1]),l.follow(i),l.setSpeed(i.getStandardSpeed()),l.onHitting(i,Ct),d.addMovingObject(l,"monster")}function u(){var l=new De(q.snowboarder),y=ee.getRandomMapPositionAboveViewport(),N=ee.getRandomMapPositionBelowViewport();l.setMapPosition(y[0],y[1]),l.setMapPositionTarget(N[0],N[1]),l.onHitting(i,q.snowboarder.hitBehaviour.skier),d.addMovingObject(l)}i=new Re(q.skier),i.setMapPosition(0,0),i.setMapPositionTarget(0,-10),Ot&&i.setHitObstacleCb(function(){se-=1}),d=new Ke(K,i),e=new Z(q.signStart),d.addStaticObject(e),e.setMapPosition(-50,0),ee.followSprite(i),s=new Ie({initialLines:["SkiFree.js",Te,"Travelled 0m","High Score: "+he,"Skiers left: "+se,"Created by Dan Hough (@basicallydan)"],position:{top:15,right:10}}),d.beforeCycle(function(){var l=[];i.isMoving&&(l=Z.createObjects([{sprite:q.smallTree,dropRate:le.smallTree},{sprite:q.tallTree,dropRate:le.tallTree},{sprite:q.jump,dropRate:le.jump},{sprite:q.thickSnow,dropRate:le.thickSnow},{sprite:q.rock,dropRate:le.rock}],{rateModifier:Math.max(800-K.width,0),position:function(){return ee.getRandomMapPositionBelowViewport()},player:i})),d.isPaused()||(d.addStaticObjects(l),p(u,.1),ce=parseFloat(i.getPixelsTravelledDownMountain()/Pt).toFixed(1),ce>St&&p(n,.001),s.setLines(["SkiFree.js",Te,"Travelled "+ce+"m","Skiers left: "+se,"High Score: "+he,"Created by Dan Hough (@basicallydan)","Current Speed: "+i.getSpeed()]))}),d.afterCycle(function(){se===0&&v()}),d.addUIElement(s),K.addEventListener("mousemove",function(l){d.setMouseX(l.pageX),d.setMouseY(l.pageY),i.resetDirection(),i.startMovingIfPossible()}),K.addEventListener("click",function(l){d.setMouseX(l.pageX),d.setMouseY(l.pageY),i.resetDirection(),i.startMovingIfPossible()}),K.focus(),J.default.bind("f",i.speedBoost),J.default.bind("t",i.attemptTrick),J.default.bind(["w","up"],function(){i.stop()}),J.default.bind(["a","left"],function(){i.direction===270?i.stepWest():i.turnWest()}),J.default.bind(["s","down"],function(){i.setDirection(180),i.startMovingIfPossible()}),J.default.bind(["d","right"],function(){i.direction===90?i.stepEast():i.turnEast()}),J.default.bind("m",n),J.default.bind("b",u),J.default.bind("space",E);var o=(0,Ze.default)(K).on("press",function(l){l.preventDefault(),d.setMouseX(l.gesture.center.x),d.setMouseY(l.gesture.center.y)}).on("tap",function(l){d.setMouseX(l.gesture.center.x),d.setMouseY(l.gesture.center.y)}).on("pan",function(l){d.setMouseX(l.gesture.center.x),d.setMouseY(l.gesture.center.y),i.resetDirection(),i.startMovingIfPossible()}).on("doubletap",function(l){i.speedBoost()});i.isMoving=!1,i.setDirection(270),d.start()}function Qe(){K.width=window.innerWidth,K.height=window.innerHeight}window.addEventListener("resize",Qe,!1);Qe();xt(Mt,Nt);})();
/*! Bundled license information:

hammerjs/hammer.js:
  (*! Hammer.JS - v1.0.7dev - 2014-02-18
   * http://eightmedia.github.com/hammer.js
   *
   * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
   * Licensed under the MIT license *)
*/

(()=>{var Pt=Object.create;var tt=Object.defineProperty;var Ot=Object.getOwnPropertyDescriptor;var Nt=Object.getOwnPropertyNames;var Rt=Object.getPrototypeOf,yt=Object.prototype.hasOwnProperty;var et=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports);var It=(n,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let l of Nt(t))!yt.call(n,l)&&l!==e&&tt(n,l,{get:()=>t[l],enumerable:!(r=Ot(t,l))||r.enumerable});return n};var it=(n,t,e)=>(e=n!=null?Pt(Rt(n)):{},It(t||!n||!n.__esModule?tt(e,"default",{value:n,enumerable:!0}):e,n));var st=et((re,V)=>{(function(n,t){"use strict";var e=function(h,i){return new e.Instance(h,i||{})};e.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},e.HAS_POINTEREVENTS=n.navigator.pointerEnabled||n.navigator.msPointerEnabled,e.HAS_TOUCHEVENTS="ontouchstart"in n,e.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,e.NO_MOUSEEVENTS=e.HAS_TOUCHEVENTS&&n.navigator.userAgent.match(e.MOBILE_REGEX),e.EVENT_TYPES={},e.DIRECTION_DOWN="down",e.DIRECTION_LEFT="left",e.DIRECTION_UP="up",e.DIRECTION_RIGHT="right",e.POINTER_MOUSE="mouse",e.POINTER_TOUCH="touch",e.POINTER_PEN="pen",e.UPDATE_VELOCITY_INTERVAL=20,e.EVENT_START="start",e.EVENT_MOVE="move",e.EVENT_END="end",e.DOCUMENT=n.document,e.plugins=e.plugins||{},e.gestures=e.gestures||{},e.READY=!1;function r(){e.READY||(e.event.determineEventTypes(),e.utils.each(e.gestures,function(h){e.detection.register(h)}),e.event.onTouch(e.DOCUMENT,e.EVENT_MOVE,e.detection.detect),e.event.onTouch(e.DOCUMENT,e.EVENT_END,e.detection.detect),e.READY=!0)}e.utils={extend:function(i,s,a){for(var c in s)i[c]!==t&&a||(i[c]=s[c]);return i},each:function(h,i,s){var a,c;if("forEach"in h)h.forEach(i,s);else if(h.length!==t){for(a=0,c=h.length;a<c;a++)if(i.call(s,h[a],a,h)===!1)return}else for(a in h)if(h.hasOwnProperty(a)&&i.call(s,h[a],a,h)===!1)return},hasParent:function(h,i){for(;h;){if(h==i)return!0;h=h.parentNode}return!1},getCenter:function(i){var s=[],a=[];return e.utils.each(i,function(c){s.push(typeof c.clientX<"u"?c.clientX:c.pageX),a.push(typeof c.clientY<"u"?c.clientY:c.pageY)}),{pageX:(Math.min.apply(Math,s)+Math.max.apply(Math,s))/2,pageY:(Math.min.apply(Math,a)+Math.max.apply(Math,a))/2}},getVelocity:function(i,s,a){return{x:Math.abs(s/i)||0,y:Math.abs(a/i)||0}},getAngle:function(i,s){var a=s.pageY-i.pageY,c=s.pageX-i.pageX;return Math.atan2(a,c)*180/Math.PI},getDirection:function(i,s){var a=Math.abs(i.pageX-s.pageX),c=Math.abs(i.pageY-s.pageY);return a>=c?i.pageX-s.pageX>0?e.DIRECTION_LEFT:e.DIRECTION_RIGHT:i.pageY-s.pageY>0?e.DIRECTION_UP:e.DIRECTION_DOWN},getDistance:function(i,s){var a=s.pageX-i.pageX,c=s.pageY-i.pageY;return Math.sqrt(a*a+c*c)},getScale:function(i,s){return i.length>=2&&s.length>=2?this.getDistance(s[0],s[1])/this.getDistance(i[0],i[1]):1},getRotation:function(i,s){return i.length>=2&&s.length>=2?this.getAngle(s[1],s[0])-this.getAngle(i[1],i[0]):0},isVertical:function(i){return i==e.DIRECTION_UP||i==e.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(i,s){!s||!i||!i.style||(e.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(a){e.utils.each(s,function(c,p){a&&(p=a+p.substring(0,1).toUpperCase()+p.substring(1)),p in i.style&&(i.style[p]=c)})}),s.userSelect=="none"&&(i.onselectstart=function(){return!1}),s.userDrag=="none"&&(i.ondragstart=function(){return!1}))},startDefaultBrowserBehavior:function(i,s){!s||!i||!i.style||(e.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(a){e.utils.each(s,function(c,p){a&&(p=a+p.substring(0,1).toUpperCase()+p.substring(1)),p in i.style&&(i.style[p]="")})}),s.userSelect=="none"&&(i.onselectstart=null),s.userDrag=="none"&&(i.ondragstart=null))}},e.Instance=function(h,i){var s=this;return r(),this.element=h,this.enabled=!0,this.options=e.utils.extend(e.utils.extend({},e.defaults),i||{}),this.options.stop_browser_behavior&&e.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),this._eventStartHandler=e.event.onTouch(h,e.EVENT_START,function(a){s.enabled&&e.detection.startDetect(s,a)}),this._eventHandler=[],this},e.Instance.prototype={on:function(i,s){var a=i.split(" ");return e.utils.each(a,function(c){this.element.addEventListener(c,s,!1),this._eventHandler.push({gesture:c,handler:s})},this),this},off:function(i,s){var a=i.split(" ");return e.utils.each(a,function(c){this.element.removeEventListener(c,s,!1);var p=-1;e.utils.each(this._eventHandler,function(O,v){p===-1&&O.gesture===c&&O.handler===s&&(p=v)},this),p>-1&&this._eventHandler.splice(p,1)},this),this},trigger:function(i,s){s||(s={});var a=e.DOCUMENT.createEvent("Event");a.initEvent(i,!0,!0),a.gesture=s;var c=this.element;return e.utils.hasParent(s.target,c)&&(c=s.target),c.dispatchEvent(a),this},enable:function(i){return this.enabled=i,this},dispose:function(){return this.options.stop_browser_behavior&&e.utils.startDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),e.utils.each(this._eventHandler,function(i){this.element.removeEventListener(i.gesture,i.handler,!1)},this),this._eventHandler.length=0,e.event.unbindDom(this.element,e.EVENT_TYPES[e.EVENT_START],this._eventStartHandler),this}};var l=null,f=!1,g=!1;e.event={bindDom:function(h,i,s){var a=i.split(" ");e.utils.each(a,function(c){h.addEventListener(c,s,!1)})},unbindDom:function(h,i,s){var a=i.split(" ");e.utils.each(a,function(c){h.removeEventListener(c,s,!1)})},onTouch:function(i,s,a){var c=this,p=function(v){var S=v.type.toLowerCase();if(!(S.match(/mouse/)&&g)){S.match(/touch/)||S.match(/pointerdown/)||S.match(/mouse/)&&v.which===1?f=!0:S.match(/mouse/)&&!v.which&&(f=!1),S.match(/touch|pointer/)&&(g=!0);var E=0;f&&(e.HAS_POINTEREVENTS&&s!=e.EVENT_END?E=e.PointerEvent.updatePointer(s,v):S.match(/touch/)?E=v.touches.length:g||(E=S.match(/up/)?0:1),E>0&&s==e.EVENT_END?s=e.EVENT_MOVE:E||(s=e.EVENT_END),(E||l===null)&&(l=v),a.call(e.detection,c.collectEventData(i,s,c.getTouchList(l,s),v)),e.HAS_POINTEREVENTS&&s==e.EVENT_END&&(E=e.PointerEvent.updatePointer(s,v))),E||(l=null,f=!1,g=!1,e.PointerEvent.reset())}};return this.bindDom(i,e.EVENT_TYPES[s],p),p},determineEventTypes:function(){var i;e.HAS_POINTEREVENTS?i=e.PointerEvent.getEvents():e.NO_MOUSEEVENTS?i=["touchstart","touchmove","touchend touchcancel"]:i=["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],e.EVENT_TYPES[e.EVENT_START]=i[0],e.EVENT_TYPES[e.EVENT_MOVE]=i[1],e.EVENT_TYPES[e.EVENT_END]=i[2]},getTouchList:function(i){return e.HAS_POINTEREVENTS?e.PointerEvent.getTouchList():i.touches?i.touches:(i.identifier=1,[i])},collectEventData:function(i,s,a,c){var p=e.POINTER_TOUCH;return(c.type.match(/mouse/)||e.PointerEvent.matchType(e.POINTER_MOUSE,c))&&(p=e.POINTER_MOUSE),{center:e.utils.getCenter(a),timeStamp:new Date().getTime(),target:c.target,touches:a,eventType:s,pointerType:p,srcEvent:c,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return e.detection.stopDetect()}}}},e.PointerEvent={pointers:{},getTouchList:function(){var h=this,i=[];return e.utils.each(h.pointers,function(s){i.push(s)}),i},updatePointer:function(h,i){return h==e.EVENT_END?delete this.pointers[i.pointerId]:(i.identifier=i.pointerId,this.pointers[i.pointerId]=i),Object.keys(this.pointers).length},matchType:function(h,i){if(!i.pointerType)return!1;var s=i.pointerType,a={};return a[e.POINTER_MOUSE]=s===i.MSPOINTER_TYPE_MOUSE||s===e.POINTER_MOUSE,a[e.POINTER_TOUCH]=s===i.MSPOINTER_TYPE_TOUCH||s===e.POINTER_TOUCH,a[e.POINTER_PEN]=s===i.MSPOINTER_TYPE_PEN||s===e.POINTER_PEN,a[h]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},e.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(i,s){this.current||(this.stopped=!1,this.current={inst:i,startEvent:e.utils.extend({},s),lastEvent:!1,lastVEvent:!1,velocity:!1,name:""},this.detect(s))},detect:function(i){if(!(!this.current||this.stopped)){i=this.extendEventData(i);var s=this.current.inst.options;return e.utils.each(this.gestures,function(a){if(!this.stopped&&s[a.name]!==!1&&a.handler.call(a,i,this.current.inst)===!1)return this.stopDetect(),!1},this),this.current&&(this.current.lastEvent=i),i.eventType==e.EVENT_END&&!i.touches.length-1&&this.stopDetect(),i}},stopDetect:function(){this.previous=e.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(i){var s=this.current.startEvent,a=this.current.lastVEvent;s&&(i.touches.length!=s.touches.length||i.touches===s.touches)&&(s.touches=[],e.utils.each(i.touches,function(Y){s.touches.push(e.utils.extend({},Y))}));var c=i.timeStamp-s.timeStamp,p=i.center.pageX-s.center.pageX,O=i.center.pageY-s.center.pageY,v,S,E=this.current.velocity;return a!==!1&&i.timeStamp-a.timeStamp>e.UPDATE_VELOCITY_INTERVAL?(E=e.utils.getVelocity(i.timeStamp-a.timeStamp,i.center.pageX-a.center.pageX,i.center.pageY-a.center.pageY),this.current.lastVEvent=i,E.x>0&&E.y>0&&(this.current.velocity=E)):this.current.velocity===!1&&(E=e.utils.getVelocity(c,p,O),this.current.velocity=E,this.current.lastVEvent=i),i.eventType==="end"?(v=this.current.lastEvent&&this.current.lastEvent.interimAngle,S=this.current.lastEvent&&this.current.lastEvent.interimDirection):(v=this.current.lastEvent&&e.utils.getAngle(this.current.lastEvent.center,i.center),S=this.current.lastEvent&&e.utils.getDirection(this.current.lastEvent.center,i.center)),e.utils.extend(i,{deltaTime:c,deltaX:p,deltaY:O,velocityX:E.x,velocityY:E.y,distance:e.utils.getDistance(s.center,i.center),angle:e.utils.getAngle(s.center,i.center),interimAngle:v,direction:e.utils.getDirection(s.center,i.center),interimDirection:S,scale:e.utils.getScale(s.touches,i.touches),rotation:e.utils.getRotation(s.touches,i.touches),startEvent:s}),i},register:function(i){var s=i.defaults||{};return s[i.name]===t&&(s[i.name]=!0),e.utils.extend(e.defaults,s,!0),i.index=i.index||1e3,this.gestures.push(i),this.gestures.sort(function(a,c){return a.index<c.index?-1:a.index>c.index?1:0}),this.gestures}},e.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(i,s){if(e.detection.current.name!=this.name&&this.triggered){s.trigger(this.name+"end",i),this.triggered=!1;return}if(!(s.options.drag_max_touches>0&&i.touches.length>s.options.drag_max_touches))switch(i.eventType){case e.EVENT_START:this.triggered=!1;break;case e.EVENT_MOVE:if(i.distance<s.options.drag_min_distance&&e.detection.current.name!=this.name)return;if(e.detection.current.name!=this.name&&(e.detection.current.name=this.name,s.options.correct_for_drag_min_distance&&i.distance>0)){var a=Math.abs(s.options.drag_min_distance/i.distance);e.detection.current.startEvent.center.pageX+=i.deltaX*a,e.detection.current.startEvent.center.pageY+=i.deltaY*a,i=e.detection.extendEventData(i)}(e.detection.current.lastEvent.drag_locked_to_axis||s.options.drag_lock_to_axis&&s.options.drag_lock_min_distance<=i.distance)&&(i.drag_locked_to_axis=!0);var c=e.detection.current.lastEvent.direction;i.drag_locked_to_axis&&c!==i.direction&&(e.utils.isVertical(c)?i.direction=i.deltaY<0?e.DIRECTION_UP:e.DIRECTION_DOWN:i.direction=i.deltaX<0?e.DIRECTION_LEFT:e.DIRECTION_RIGHT),this.triggered||(s.trigger(this.name+"start",i),this.triggered=!0),s.trigger(this.name,i),s.trigger(this.name+i.direction,i),(s.options.drag_block_vertical&&e.utils.isVertical(i.direction)||s.options.drag_block_horizontal&&!e.utils.isVertical(i.direction))&&i.preventDefault();break;case e.EVENT_END:this.triggered&&s.trigger(this.name+"end",i),this.triggered=!1;break}}},e.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(i,s){switch(i.eventType){case e.EVENT_START:clearTimeout(this.timer),e.detection.current.name=this.name,this.timer=setTimeout(function(){e.detection.current.name=="hold"&&s.trigger("hold",i)},s.options.hold_timeout);break;case e.EVENT_MOVE:i.distance>s.options.hold_threshold&&clearTimeout(this.timer);break;case e.EVENT_END:clearTimeout(this.timer);break}}},e.gestures.Release={name:"release",index:1/0,handler:function(i,s){i.eventType==e.EVENT_END&&s.trigger(this.name,i)}},e.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(i,s){if(i.eventType==e.EVENT_END){if(s.options.swipe_max_touches>0&&i.touches.length<s.options.swipe_min_touches&&i.touches.length>s.options.swipe_max_touches)return;(i.velocityX>s.options.swipe_velocity||i.velocityY>s.options.swipe_velocity)&&(s.trigger(this.name,i),s.trigger(this.name+i.direction,i))}}},e.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(i,s){if(i.eventType==e.EVENT_MOVE&&!e.detection.current.reachedTapMaxDistance)e.detection.current.reachedTapMaxDistance=i.distance>s.options.tap_max_distance;else if(i.eventType==e.EVENT_END&&i.srcEvent.type!="touchcancel"){var a=e.detection.previous,c=!1;if(e.detection.current.reachedTapMaxDistance||i.deltaTime>s.options.tap_max_touchtime)return;a&&a.name=="tap"&&i.timeStamp-a.lastEvent.timeStamp<s.options.doubletap_interval&&i.distance<s.options.doubletap_distance&&(s.trigger("doubletap",i),c=!0),(!c||s.options.tap_always)&&(e.detection.current.name="tap",s.trigger(e.detection.current.name,i))}}},e.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(i,s){if(s.options.prevent_mouseevents&&i.pointerType==e.POINTER_MOUSE){i.stopDetect();return}s.options.prevent_default&&i.preventDefault(),i.eventType==e.EVENT_START&&s.trigger(this.name,i)}},e.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(i,s){if(e.detection.current.name!=this.name&&this.triggered){s.trigger(this.name+"end",i),this.triggered=!1;return}if(!(i.touches.length<2))switch(s.options.transform_always_block&&i.preventDefault(),i.eventType){case e.EVENT_START:this.triggered=!1;break;case e.EVENT_MOVE:var a=Math.abs(1-i.scale),c=Math.abs(i.rotation);if(a<s.options.transform_min_scale&&c<s.options.transform_min_rotation)return;e.detection.current.name=this.name,this.triggered||(s.trigger(this.name+"start",i),this.triggered=!0),s.trigger(this.name,i),c>s.options.transform_min_rotation&&s.trigger("rotate",i),a>s.options.transform_min_scale&&(s.trigger("pinch",i),s.trigger("pinch"+(i.scale<1?"in":"out"),i));break;case e.EVENT_END:this.triggered&&s.trigger(this.name+"end",i),this.triggered=!1;break}}},typeof define=="function"&&define.amd?define(function(){return e}):typeof V=="object"&&V.exports?V.exports=e:n.Hammer=e})(window)});var rt=et((ne,A)=>{(function(){for(var n={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},t={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},e={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},r={option:"alt",command:"meta",return:"enter",escape:"esc"},l,f={},g={},h={},i,s=!1,a=!1,c=1;c<20;++c)n[111+c]="f"+c;for(c=0;c<=9;++c)n[c+96]=c;function p(o,u,d){if(o.addEventListener){o.addEventListener(u,d,!1);return}o.attachEvent("on"+u,d)}function O(o){return o.type=="keypress"?String.fromCharCode(o.which):n[o.which]?n[o.which]:t[o.which]?t[o.which]:String.fromCharCode(o.which).toLowerCase()}function v(o,u){return o.sort().join(",")===u.sort().join(",")}function S(o){o=o||{};var u=!1,d;for(d in h){if(o[d]){u=!0;continue}h[d]=0}u||(a=!1)}function E(o,u,d,_,I){var b,T,m=[],x=d.type;if(!f[o])return[];for(x=="keyup"&&W(o)&&(u=[o]),b=0;b<f[o].length;++b)T=f[o][b],!(T.seq&&h[T.seq]!=T.level)&&x==T.action&&(x=="keypress"&&!d.metaKey&&!d.ctrlKey||v(u,T.modifiers))&&(_&&T.combo==I&&f[o].splice(b,1),m.push(T));return m}function Y(o){var u=[];return o.shiftKey&&u.push("shift"),o.altKey&&u.push("alt"),o.ctrlKey&&u.push("ctrl"),o.metaKey&&u.push("meta"),u}function X(o,u){o(u)===!1&&(u.preventDefault&&u.preventDefault(),u.stopPropagation&&u.stopPropagation(),u.returnValue=!1,u.cancelBubble=!0)}function St(o,u){if(!k.stopCallback(u,u.target||u.srcElement)){var d=E(o,Y(u),u),_,I={},b=!1;for(_=0;_<d.length;++_){if(d[_].seq){b=!0,I[d[_].seq]=1,X(d[_].callback,u);continue}!b&&!a&&X(d[_].callback,u)}u.type==a&&!W(o)&&S(I)}}function L(o){o.which=typeof o.which=="number"?o.which:o.keyCode;var u=O(o);if(u){if(o.type=="keyup"&&s==u){s=!1;return}St(u,o)}}function W(o){return o=="shift"||o=="ctrl"||o=="alt"||o=="meta"}function Mt(){clearTimeout(i),i=setTimeout(S,1e3)}function bt(){if(!l){l={};for(var o in n)o>95&&o<112||n.hasOwnProperty(o)&&(l[n[o]]=o)}return l}function Z(o,u,d){return d||(d=bt()[o]?"keydown":"keypress"),d=="keypress"&&u.length&&(d="keydown"),d}function wt(o,u,d,_){h[o]=0,_||(_=Z(u[0],[]));var I=function(m){a=_,++h[o],Mt()},b=function(m){X(d,m),_!=="keyup"&&(s=O(m)),setTimeout(S,10)},T;for(T=0;T<u.length;++T)Q(u[T],T<u.length-1?I:b,_,o,T)}function Q(o,u,d,_,I){o=o.replace(/\s+/g," ");var b=o.split(" "),T,m,x,H=[];if(b.length>1){wt(o,b,u,d);return}for(x=o==="+"?["+"]:o.split("+"),T=0;T<x.length;++T)m=x[T],r[m]&&(m=r[m]),d&&d!="keypress"&&e[m]&&(m=e[m],H.push("shift")),W(m)&&H.push(m);d=Z(m,H,d),f[m]||(f[m]=[]),E(m,H,{type:d},!_,o),f[m][_?"unshift":"push"]({callback:u,modifiers:H,action:d,seq:_,level:I,combo:o})}function Dt(o,u,d){for(var _=0;_<o.length;++_)Q(o[_],u,d)}p(document,"keypress",L),p(document,"keydown",L),p(document,"keyup",L);var k={bind:function(o,u,d){return Dt(o instanceof Array?o:[o],u,d),g[o+":"+d]=u,this},unbind:function(o,u){return g[o+":"+u]&&(delete g[o+":"+u],this.bind(o,function(){},u)),this},trigger:function(o,u){return g[o+":"+u](),this},reset:function(){return f={},g={},this},stopCallback:function(o,u){return(" "+u.className+" ").indexOf(" mousetrap ")>-1?!1:u.tagName=="INPUT"||u.tagName=="SELECT"||u.tagName=="TEXTAREA"||u.contentEditable&&u.contentEditable=="true"}};window.Mousetrap=k,typeof define=="function"&&define.amd&&define("mousetrap",function(){return k}),typeof A=="object"&&A.exports&&(A.exports=k)})()});var Tt=it(st(),1),P=it(rt(),1);function xt(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}var nt=xt;var U=class n{constructor(t){this._ctx=t,this._images={},this._centralSprite=null}logicalWidth(){let t=this._ctx.canvas.style.width;return t?parseFloat(t):this._ctx.canvas.width}logicalHeight(){let t=this._ctx.canvas.style.height;return t?parseFloat(t):this._ctx.canvas.height}storeLoadedImage(t,e){this._images[t]=e}getLoadedImage(t){return this._images[t]}followSprite(t){this._centralSprite=t}getCentralPosition(){return{map:this._centralSprite.mapPosition,canvas:[Math.round(this.logicalWidth()*.5),Math.round(this.logicalHeight()*.5),0]}}mapPositionToCanvasPosition(t){var e=this.getCentralPosition(),r=e.map[0]-t[0],l=e.map[1]-t[1];return[e.canvas[0]-r,e.canvas[1]-l]}canvasPositionToMapPosition(t){var e=this.getCentralPosition(),r=e.canvas[0]-t[0],l=e.canvas[1]-t[1];return[e.map[0]-r,e.map[1]-l]}getCentreOfViewport(){return Math.floor(this.logicalWidth()/2)}getMiddleOfViewport(){return Math.floor(this.logicalHeight()/2)}getBelowViewport(){return Math.floor(this.logicalHeight())}getMapBelowViewport(){var t=this.getBelowViewport();return this.canvasPositionToMapPosition([0,t])[1]}getAboveViewport(){return 0-Math.floor(this.logicalHeight()/4)}getTopOfViewport(){return this.canvasPositionToMapPosition([0,0])[1]}getRandomlyInTheCentreOfCanvas(t){var e=0,r=this.logicalWidth();return t&&(e-=t,r+=t),Math.floor(Math.random()*(r-e+1))+e}getRandomlyInTheCentreOfMap(t){var e=this.getRandomlyInTheCentreOfCanvas(t);return this.canvasPositionToMapPosition([e,0])[0]}getRandomMapPositionBelowViewport(){var t=this.getRandomlyInTheCentreOfCanvas(),e=this.getBelowViewport();return this.canvasPositionToMapPosition([t,e])}getRandomMapPositionAboveViewport(){var t=this.getRandomlyInTheCentreOfCanvas(),e=this.getAboveViewport();return this.canvasPositionToMapPosition([t,e])}static create(t){let e=new n(t);return new Proxy(e,{get(r,l){if(l in r){let g=r[l];return typeof g=="function"?g.bind(r):g}let f=t[l];return typeof f=="function"?f.bind(t):f},set(r,l,f){return l in r?r[l]=f:t[l]=f,!0}})}},at=U;function Bt(){var n=function(){return Math.floor(Math.random()*65536).toString(16)};return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()}var ot=Bt;var F=class n{constructor(t){this._hittableObjects={},this._zIndexesOccupied=[0],this._trackedSpriteToMoveToward=void 0,this.direction=void 0,this.mapPosition=[0,0,0],this.id=ot(),this.canvasX=0,this.canvasY=0,this.canvasZ=0,this.height=0,this.speed=0,this.data=t||{parts:{}},this.movingToward=[0,0],this.metresDownTheMountain=0,this.movingWithConviction=!1,this.deleted=!1,this.data.parts||(this.data.parts={});let e=Object.values(this.data.parts).map(r=>r[3]);this.maxHeight=e.length?Math.max(...e):void 0,this.isMoving=!0,t&&t.id&&(this.id=t.id),t&&t.zIndexesOccupied&&(this._zIndexesOccupied=t.zIndexesOccupied)}_incrementX(t){this.canvasX+=parseFloat(t)}_incrementY(t){this.canvasY+=parseFloat(t)}_getHitBox(t){if(this.data.hitBoxes&&this.data.hitBoxes[t])return this.data.hitBoxes[t]}_roundHalf(t){return Math.round(t*2)/2}_move(t=1){if(this.isMoving){var e=this.mapPosition[0],r=this.mapPosition[1];if(typeof this.direction<"u"){var l=this.direction-90;l<0&&(l=360+l),e+=this._roundHalf(this.speed*t*Math.cos(l*(Math.PI/180))),r+=this._roundHalf(this.speed*t*Math.sin(l*(Math.PI/180)))}else typeof this.movingToward[0]<"u"&&(e>this.movingToward[0]?e-=Math.min(this.getSpeedX()*t,Math.abs(e-this.movingToward[0])):e<this.movingToward[0]&&(e+=Math.min(this.getSpeedX()*t,Math.abs(e-this.movingToward[0])))),typeof this.movingToward[1]<"u"&&(r>this.movingToward[1]?r-=Math.min(this.getSpeedY()*t,Math.abs(r-this.movingToward[1])):r<this.movingToward[1]&&(r+=Math.min(this.getSpeedY()*t,Math.abs(r-this.movingToward[1]))));this.setMapPosition(e,r)}}draw(t,e){var r=this.data.parts[e];this.height=r[3],this.width=r[2];var l=t.mapPositionToCanvasPosition(this.mapPosition);this.setCanvasPosition(l[0],l[1]),t.drawImage(t.getLoadedImage(this.data.$imageFile),r[0],r[1],r[2],r[3],this.canvasX,this.canvasY,r[2],r[3])}setMapPosition(t,e,r){typeof t>"u"&&(t=this.mapPosition[0]),typeof e>"u"&&(e=this.mapPosition[1]),typeof r>"u"?r=this.mapPosition[2]:this._zIndexesOccupied=[r],this.mapPosition=[t,e,r]}setCanvasPosition(t,e){t&&(typeof t=="string"&&(t[0]==="+"||t[0]==="-")?this._incrementX(t):this.canvasX=t),e&&(typeof e=="string"&&(e[0]==="+"||e[0]==="-")?this._incrementY(e):this.canvasY=e)}getCanvasPositionX(){return this.canvasX}getCanvasPositionY(){return this.canvasY}getLeftHitBoxEdge(t){t=t||0;var e=this.getCanvasPositionX();return this._getHitBox(t)&&(e+=this._getHitBox(t)[0]),e}getTopHitBoxEdge(t){t=t||0;var e=this.getCanvasPositionY();return this._getHitBox(t)&&(e+=this._getHitBox(t)[1]),e}getRightHitBoxEdge(t){return t=t||0,this._getHitBox(t)?this.canvasX+this._getHitBox(t)[2]:this.canvasX+this.width}getBottomHitBoxEdge(t){return t=t||0,this._getHitBox(t)?this.canvasY+this._getHitBox(t)[3]:this.canvasY+this.height}getPositionInFrontOf(){return[this.canvasX,this.canvasY+this.height]}setSpeed(t){this.speed=t,this.speedX=t,this.speedY=t}incrementSpeedBy(t){this.speed+=t}getSpeed(){return this.speed}getSpeedX(){return this.speed}getSpeedY(){return this.speed}setHeight(t){this.height=t}setWidth(t){this.width=t}getMaxHeight(){return this.maxHeight}checkHittableObjects(){Object.keys(this._hittableObjects).forEach(t=>{var e=this._hittableObjects[t];e.object.deleted?delete this._hittableObjects[t]:e.object.hits(this)&&e.callbacks.forEach(r=>r(this,e.object))})}cycle(t=1){this.checkHittableObjects(),this._trackedSpriteToMoveToward&&this.setMapPositionTarget(this._trackedSpriteToMoveToward.mapPosition[0],this._trackedSpriteToMoveToward.mapPosition[1],!0),this._move(t)}setMapPositionTarget(t,e,r){r&&(this.movingWithConviction=!1),this.movingWithConviction||(typeof t>"u"&&(t=this.movingToward[0]),typeof e>"u"&&(e=this.movingToward[1]),this.movingToward=[t,e],this.movingWithConviction=!1)}setDirection(t){t>=360&&(t=360-t),this.direction=t,this.movingToward=void 0}resetDirection(){this.direction=void 0}setMapPositionTargetWithConviction(t,e){this.setMapPositionTarget(t,e),this.movingWithConviction=!0}follow(t){this._trackedSpriteToMoveToward=t}stopFollowing(){this._trackedSpriteToMoveToward=!1}onHitting(t,e){if(this._hittableObjects[t.id])return this._hittableObjects[t.id].callbacks.push(e);this._hittableObjects[t.id]={object:t,callbacks:[e]}}deleteOnNextCycle(){this.deleted=!0}occupiesZIndex(t){return this._zIndexesOccupied.indexOf(t)>=0}hits(t){var e=!1,r=!1,l=this.mapPosition[2];return t.getTopHitBoxEdge(l)<=this.getBottomHitBoxEdge(l)&&t.getBottomHitBoxEdge(l)>=this.getBottomHitBoxEdge(l)&&(e=!0),t.getTopHitBoxEdge(l)<=this.getTopHitBoxEdge(l)&&t.getBottomHitBoxEdge(l)>=this.getTopHitBoxEdge(l)&&(e=!0),t.getLeftHitBoxEdge(l)<=this.getRightHitBoxEdge(l)&&t.getRightHitBoxEdge(l)>=this.getRightHitBoxEdge(l)&&(r=!0),t.getLeftHitBoxEdge(l)<=this.getLeftHitBoxEdge(l)&&t.getRightHitBoxEdge(l)>=this.getLeftHitBoxEdge(l)&&(r=!0),e&&r}isAboveOnCanvas(t){return this.canvasY+this.height<t}isBelowOnCanvas(t){return this.canvasY>t}static createObjects(t,e){Array.isArray(t)||(t=[t]),e=Object.assign({rateModifier:0,dropRate:1,position:[0,0]},e);function r(l){var f=e.position;if(Math.floor(Math.random()*(101+e.rateModifier))<=l.dropRate){var g=new n(l.sprite);return g.setSpeed(0),typeof f=="function"&&(f=f()),g.setMapPosition(f[0],f[1]),l.sprite.hitBehaviour&&l.sprite.hitBehaviour.skier&&e.player&&g.onHitting(e.player,l.sprite.hitBehaviour.skier),g}}return t.map(r).filter(l=>l!==void 0)}},N=F;var j=class extends N{constructor(t){super(t),this._spriteVersion=1,this._eatingStage=0,this.isEating=!1,this.isFull=!1,this.setSpeed(6)}draw(t){let e=()=>{var r=this.movingToward[0]-this.canvasX;return this.isEating?"eating"+this._eatingStage:(this._spriteVersion+.1>2?this._spriteVersion=.1:this._spriteVersion+=.1,r>=0?"sEast"+Math.ceil(this._spriteVersion):"sWest"+Math.ceil(this._spriteVersion))};return super.draw(t,e())}startEating(t){this._eatingStage+=1,this.isEating=!0,this.isMoving=!1,this._eatingStage<6?setTimeout(()=>this.startEating(t),300):(this._eatingStage=0,this.isEating=!1,this.isMoving=!0,t())}},ht=j;var K=class extends N{constructor(t){super(t),this._standardSpeed=3,this._camera=null,this.setSpeed(this._standardSpeed)}_getDirection(){var t=this.movingToward[0]-this.mapPosition[0];return t>0?"sEast":"sWest"}cycle(t=1){Math.floor(Math.random()*11)===1&&(this.setMapPositionTarget(this._camera.getRandomlyInTheCentreOfMap()),this.setSpeed(this._standardSpeed+Math.floor(Math.random()*3)-1)),this.setMapPositionTarget(void 0,this._camera.getMapBelowViewport()+600),super.cycle(t)}draw(t){return super.draw(t,this._getDirection())}},ct=K;typeof navigator<"u"?navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate:globalThis.navigator={vibrate:!1};var dt={west:270,wsWest:240,sWest:195,south:180,sEast:165,esEast:120,east:90},J=class extends N{constructor(t){super(t),this._cancelableStateTimeout=null,this._cancelableStateInterval=null,this._canSpeedBoost=!0,this._obstaclesHit=[],this._pixelsTravelled=0,this._standardSpeed=5,this._turnEaseCycles=70,this._speedX=0,this._speedXFactor=0,this._speedY=0,this._speedYFactor=1,this._trickStep=0,this.isMoving=!0,this.hasBeenHit=!1,this.isJumping=!1,this.isPerformingTrick=!1,this.onHitObstacleCb=function(){},this.setSpeed(this._standardSpeed)}_setNormal(){this.setSpeed(this._standardSpeed),this.isMoving=!0,this.hasBeenHit=!1,this.isJumping=!1,this.isPerformingTrick=!1,this._cancelableStateInterval&&clearInterval(this._cancelableStateInterval),this.setMapPosition(void 0,void 0,0)}_setCrashed(){this.isMoving=!1,this.hasBeenHit=!0,this.isJumping=!1,this.isPerformingTrick=!1,this._cancelableStateInterval&&clearInterval(this._cancelableStateInterval),this.setMapPosition(void 0,void 0,0)}_setJumping(){var t=this.getSpeed();this.setSpeed(t+2),this.setSpeedY(t+2),this.isMoving=!0,this.hasBeenHit=!1,this.isJumping=!0,this.setMapPosition(void 0,void 0,1)}_getDiscreteDirection(){if(this.direction)return this.direction<=90?"east":this.direction>90&&this.direction<150?"esEast":this.direction>=150&&this.direction<180?"sEast":this.direction===180?"south":this.direction>180&&this.direction<=210?"sWest":this.direction>210&&this.direction<270?"wsWest":this.direction>=270?"west":"south";var t=this.movingToward[0]-this.mapPosition[0],e=this.movingToward[1]-this.mapPosition[1];return e<=0?t>0?"east":"west":t>300?"esEast":t>75?"sEast":t<-300?"wsWest":t<-75?"sWest":"south"}_setDiscreteDirection(t){dt[t]&&this.setDirection(dt[t]),this.isMoving=t!=="west"&&t!=="east"}_getBeingEatenSprite(){return"blank"}_getJumpingSprite(){return"jumping"}_getTrickSprite(){return this._trickStep===0?"jumping":this._trickStep===1?"somersault1":"somersault2"}_easeSpeedToTargetUsingFactor(t,e,r){return r===0||r===1?e:(t<e&&(t+=this.getSpeed()*(r/this._turnEaseCycles)),t>e&&(t-=this.getSpeed()*(r/this._turnEaseCycles)),t)}stop(){this.isJumping||(this.direction>180?this._setDiscreteDirection("west"):this._setDiscreteDirection("east"))}turnEast(){if(!this.hasBeenHit)switch(this._getDiscreteDirection()){case"west":this._setDiscreteDirection("wsWest");break;case"wsWest":this._setDiscreteDirection("sWest");break;case"sWest":this._setDiscreteDirection("south");break;case"south":this._setDiscreteDirection("sEast");break;case"sEast":this._setDiscreteDirection("esEast");break;case"esEast":this._setDiscreteDirection("east");break;default:this._setDiscreteDirection("south");break}}turnWest(){if(!this.hasBeenHit)switch(this._getDiscreteDirection()){case"east":this._setDiscreteDirection("esEast");break;case"esEast":this._setDiscreteDirection("sEast");break;case"sEast":this._setDiscreteDirection("south");break;case"south":this._setDiscreteDirection("sWest");break;case"sWest":this._setDiscreteDirection("wsWest");break;case"wsWest":this._setDiscreteDirection("west");break;default:this._setDiscreteDirection("south");break}}stepWest(){this.hasBeenHit||(this.mapPosition[0]-=this.speed*2)}stepEast(){this.hasBeenHit||(this.mapPosition[0]+=this.speed*2)}setMapPositionTarget(t,e){this.hasBeenHit||(Math.abs(this.mapPosition[0]-t)<=75&&(t=this.mapPosition[0]),this.movingToward=[t,e])}startMovingIfPossible(){!this.hasBeenHit&&!this.isBeingEaten&&(this.isMoving=!0)}setTurnEaseCycles(t){this._turnEaseCycles=t}getPixelsTravelledDownMountain(){return this._pixelsTravelled}getStandardSpeed(){return this._standardSpeed}resetSpeed(){this.setSpeed(this._standardSpeed)}setSpeedY(t){this._speedY=t}getSpeedX(){var t=this._getDiscreteDirection();return t==="esEast"||t==="wsWest"?(this._speedXFactor=.5,this._speedX=this._easeSpeedToTargetUsingFactor(this._speedX,this.getSpeed()*.5,.5),this._speedX):t==="sEast"||t==="sWest"?(this._speedXFactor=.33,this._speedX=this._easeSpeedToTargetUsingFactor(this._speedX,this.getSpeed()*.33,.33),this._speedX):(this._speedX=this._easeSpeedToTargetUsingFactor(this._speedX,0,this._speedXFactor),this._speedX)}getSpeedY(){var t=this._getDiscreteDirection();return this.isJumping?this._speedY:t==="esEast"||t==="wsWest"?(this._speedYFactor=.6,this._speedY=this._easeSpeedToTargetUsingFactor(this._speedY,this.getSpeed()*.6,.6),this._speedY):t==="sEast"||t==="sWest"?(this._speedYFactor=.85,this._speedY=this._easeSpeedToTargetUsingFactor(this._speedY,this.getSpeed()*.85,.85),this._speedY):t==="east"||t==="west"?(this._speedYFactor=1,this._speedY=0,this._speedY):(this._speedY=this._easeSpeedToTargetUsingFactor(this._speedY,this.getSpeed(),this._speedYFactor),this._speedY)}cycle(t=1){this.getSpeedX()<=0&&this.getSpeedY()<=0&&(this.isMoving=!1),this.isMoving&&(this._pixelsTravelled+=this.speed*t),this.isJumping&&this.setMapPositionTarget(void 0,this.mapPosition[1]+this.getSpeed()*t),super.cycle(t),this.checkHittableObjects()}draw(t){let e=()=>this.isBeingEaten?this._getBeingEatenSprite():this.isJumping?this.isPerformingTrick?this._getTrickSprite():this._getJumpingSprite():this.hasBeenHit?"hit":this._getDiscreteDirection();return super.draw(t,e())}hits(t){return this._obstaclesHit.indexOf(t.id)!==-1||!t.occupiesZIndex(this.mapPosition[2])?!1:super.hits(t)}speedBoost(){var t=this.speed;this._canSpeedBoost&&(this._canSpeedBoost=!1,this.setSpeed(this.speed*2),setTimeout(()=>{this.setSpeed(t),setTimeout(()=>{this._canSpeedBoost=!0},1e4)},2e3))}attemptTrick(){this.isJumping&&(this.isPerformingTrick=!0,this._cancelableStateInterval=setInterval(()=>{this._trickStep=this._trickStep>=2?0:this._trickStep+1},300))}hasHitObstacle(t){this._setCrashed(),navigator.vibrate&&navigator.vibrate(500),this._obstaclesHit.push(t.id),this.resetSpeed(),this.onHitObstacleCb(t),this._cancelableStateTimeout&&clearTimeout(this._cancelableStateTimeout),this._cancelableStateTimeout=setTimeout(()=>this._setNormal(),1500)}hasHitJump(){this.isMoving&&(this._setJumping(),this._cancelableStateTimeout&&clearTimeout(this._cancelableStateTimeout),this._cancelableStateTimeout=setTimeout(()=>this._setNormal(),1e3))}isEatenBy(t,e){this.hasHitObstacle(t),t.startEating(e),this._obstaclesHit.push(t.id),this.isMoving=!1,this.isBeingEaten=!0}reset(){this._obstaclesHit=[],this._pixelsTravelled=0,this.isMoving=!0,this.isJumping=!1,this.hasBeenHit=!1,this._canSpeedBoost=!0}setHitObstacleCb(t){this.onHitObstacleCb=t||function(){}}},ft=J;var $=class{constructor(t){this.lines=t.initialLines,this.top=t.position.top,this.right=t.position.right,this.bottom=t.position.bottom,this.left=t.position.left,this.width=t.width,this.height=t.height}setLines(t){this.lines=t}draw(t){t.font="11px monospace";var e=0;this.lines.forEach(r=>{var l=+t.font.slice(0,2),f=t.measureText(r).width,g=l*1.5,h,i;this.top?i=this.top+e:this.bottom&&(i=t.logicalHeight()-this.bottom-g+e),this.right?h=t.logicalWidth()-this.right-f:this.left&&(h=this.left),e+=g,t.fillText(r,h,i)})}},pt=$;var q=class extends Array{constructor(){super(),this.pushHandlers=[]}onPush(t,e){this.pushHandlers.push(t),e&&this.forEach(t)}push(t){super.push(t),this.pushHandlers.forEach(e=>e(t))}cull(){this.forEach((t,e)=>{t&&t.deleted&&delete this[e]})}},B=q;var Kt=20,z=class{constructor(t,e){this._camera=t,this._player=e,this._staticObjects=new B,this._movingObjects=new B,this._uiElements=new B,this._mouseX=t.getCentreOfViewport(),this._mouseY=0,this._paused=!1,this._beforeCycleCallbacks=[],this._afterCycleCallbacks=[],this._rafId=null,this._lastTimestamp=null,e.setMapPosition(0,0),e.setMapPositionTarget(0,-10),t.followSprite(e)}addStaticObject(t){this._staticObjects.push(t)}addStaticObjects(t){t.forEach(this.addStaticObject.bind(this))}addMovingObject(t,e){t._camera=this._camera,e&&this._staticObjects.onPush(r=>{r.data&&r.data.hitBehaviour[e]&&r.onHitting(t,r.data.hitBehaviour[e])},!0),this._movingObjects.push(t)}addUIElement(t){this._uiElements.push(t)}beforeCycle(t){this._beforeCycleCallbacks.push(t)}afterCycle(t){this._afterCycleCallbacks.push(t)}setMouseX(t){this._mouseX=t}setMouseY(t){this._mouseY=t}_tick(t){this._lastTimestamp===null&&(this._lastTimestamp=t);let r=Math.min(t-this._lastTimestamp,100)/Kt;this._lastTimestamp=t,this.cycle(r),this.draw(),this._rafId=requestAnimationFrame(l=>this._tick(l))}start(){this._rafId||(this._lastTimestamp=null,this._rafId=requestAnimationFrame(t=>this._tick(t)))}pause(){this._paused=!0,this._rafId&&(cancelAnimationFrame(this._rafId),this._rafId=null)}isPaused(){return this._paused}reset(){this._paused=!1,this._staticObjects=new B,this._movingObjects=new B,this._mouseX=this._camera.getCentreOfViewport(),this._mouseY=0,this._player.reset(),this._player.setMapPosition(0,0,0),this._lastTimestamp=null,this.start()}cycle(t=1){this._beforeCycleCallbacks.forEach(r=>r());var e=this._camera.canvasPositionToMapPosition([this._mouseX,this._mouseY]);this._player.isJumping||this._player.setMapPositionTarget(e[0],e[1]),this._player.cycle(t),this._movingObjects.forEach(r=>r.cycle(t)),this._staticObjects.cull(),this._staticObjects.forEach(r=>{r.cycle&&r.cycle(t)}),this._uiElements.forEach(r=>{r.cycle&&r.cycle(t)}),this._afterCycleCallbacks.forEach(r=>r())}draw(){this._camera.clearRect(0,0,this._camera.logicalWidth(),this._camera.logicalHeight()),this._player.draw(this._camera),this._movingObjects.forEach(t=>t.draw(this._camera)),this._staticObjects.forEach(t=>{t.draw&&t.draw(this._camera,"main")}),this._uiElements.forEach(t=>{t.draw&&t.draw(this._camera,"main")})}},gt=z;var R={skier:{$imageFile:"sprite-characters.png",parts:{blank:[0,0,0,0],east:[0,0,24,34],esEast:[24,0,24,34],sEast:[49,0,17,34],south:[65,0,17,34],sWest:[49,37,17,34],wsWest:[24,37,24,34],west:[0,37,24,34],hit:[0,78,31,31],jumping:[84,0,32,34],somersault1:[116,0,32,34],somersault2:[148,0,32,34]},hitBoxes:{0:[7,20,27,34]},id:"player",hitBehaviour:{}},smallTree:{$imageFile:"skifree-objects.png",parts:{main:[0,28,30,34]},hitBoxes:{0:[0,18,30,34]},hitBehaviour:{}},tallTree:{$imageFile:"skifree-objects.png",parts:{main:[95,66,32,64]},zIndexesOccupied:[0,1],hitBoxes:{0:[0,54,32,64],1:[0,10,32,54]},hitBehaviour:{}},thickSnow:{$imageFile:"skifree-objects.png",parts:{main:[143,53,43,10]},hitBehaviour:{}},rock:{$imageFile:"skifree-objects.png",parts:{main:[30,52,23,11]},hitBehaviour:{}},monster:{$imageFile:"sprite-characters.png",parts:{sEast1:[64,112,26,43],sEast2:[90,112,32,43],sWest1:[64,158,26,43],sWest2:[90,158,32,43],eating1:[122,112,34,43],eating2:[156,112,31,43],eating3:[187,112,31,43],eating4:[219,112,25,43],eating5:[243,112,26,43]},hitBehaviour:{}},jump:{$imageFile:"skifree-objects.png",parts:{main:[109,55,32,8]},hitBehaviour:{}},signStart:{$imageFile:"skifree-objects.png",parts:{main:[260,103,42,27]},hitBehaviour:{}},snowboarder:{$imageFile:"sprite-characters.png",parts:{sEast:[73,229,20,29],sWest:[95,228,26,30]},hitBehaviour:{}},emptyChairLift:{$imageFile:"skifree-objects.png",parts:{main:[92,136,26,30]},zIndexesOccupied:[1]}};function Gt(n){n.deleteOnNextCycle()}R.monster.hitBehaviour.tree=Gt;function _t(n,t){t.deleteOnNextCycle()}R.smallTree.hitBehaviour.monster=_t;R.tallTree.hitBehaviour.monster=_t;function mt(n,t){t.hasHitObstacle(n)}R.smallTree.hitBehaviour.skier=mt;R.tallTree.hitBehaviour.skier=mt;function Jt(n,t){t.hasHitObstacle(n)}R.rock.hitBehaviour.skier=Jt;function $t(n,t){t.hasHitJump(n)}R.jump.hitBehaviour.skier=$t;function qt(n,t){t.hasHitObstacle(n)}R.snowboarder.hitBehaviour.skier=qt;var w=R;var y=document.getElementById("skifree-canvas"),D=at.create(y.getContext("2d")),Qt=["sprite-characters.png","skifree-objects.png"],Et=nt()?"Tap or drag on the piste to control the player":"Use the mouse or WASD to control the player",C={smallTree:4,tallTree:2,jump:1,thickSnow:1,rock:1},M={livesLeft:5,highScore:Number(localStorage.getItem("highScore"))||0,distanceTravelled:0};function te(n,t){let e=0;n.forEach(r=>{let l=new Image;l.onload=()=>{e+=1,e===n.length&&t()},l.src=r,D.storeLoadedImage(r,l)})}function ee(n,t){t.isEatenBy(n,()=>{M.livesLeft-=1,n.isFull=!0,n.isEating=!1,t.isBeingEaten=!1,n.setSpeed(t.getSpeed()),n.stopFollowing();let e=D.getRandomMapPositionAboveViewport();n.setMapPositionTarget(e[0],e[1])})}function ie(){let n,t,e,r;function l(){M.distanceTravelled=0,M.livesLeft=5,M.highScore=Number(localStorage.getItem("highScore"))||0,r.reset(),r.addStaticObject(t)}function f(){r.isPaused()||(localStorage.setItem("highScore",M.distanceTravelled),M.highScore=M.distanceTravelled,e.setLines(["Game over!","Hit space to restart"]),r.pause(),r.cycle(),r.draw())}function g(s,a){let c=Math.max(800-D.logicalWidth(),0);Math.floor(Math.random()*(1001+c))<=a&&s()}function h(){let s=new ht(w.monster),a=D.getRandomMapPositionAboveViewport();s.setMapPosition(a[0],a[1]),s.follow(n),s.setSpeed(n.getStandardSpeed()),s.onHitting(n,ee),r.addMovingObject(s,"monster")}function i(){let s=new ct(w.snowboarder),a=D.getRandomMapPositionAboveViewport(),c=D.getRandomMapPositionBelowViewport();s.setMapPosition(a[0],a[1]),s.setMapPositionTarget(c[0],c[1]),s.onHitting(n,w.snowboarder.hitBehaviour.skier),r.addMovingObject(s)}n=new ft(w.skier),n.setMapPosition(0,0),n.setMapPositionTarget(0,-10),r=new gt(D,n),t=new N(w.signStart),r.addStaticObject(t),t.setMapPosition(-50,0),e=new pt({initialLines:["SkiFree.js",Et,"Travelled 0m",`High Score: ${M.highScore}`,`Skiers left: ${M.livesLeft}`,"Created by Dan Hough (@basicallydan)"],position:{top:15,right:10}}),r.beforeCycle(()=>{let s=[];n.isMoving&&(s=N.createObjects([{sprite:w.smallTree,dropRate:C.smallTree},{sprite:w.tallTree,dropRate:C.tallTree},{sprite:w.jump,dropRate:C.jump},{sprite:w.thickSnow,dropRate:C.thickSnow},{sprite:w.rock,dropRate:C.rock}],{rateModifier:Math.max(800-D.logicalWidth(),0),position:()=>D.getRandomMapPositionBelowViewport(),player:n})),r.isPaused()||(r.addStaticObjects(s),g(i,.1),M.distanceTravelled=parseFloat(n.getPixelsTravelledDownMountain()/18).toFixed(1),M.distanceTravelled>2e3&&g(h,.001),e.setLines(["SkiFree.js",Et,`Travelled ${M.distanceTravelled}m`,`Skiers left: ${M.livesLeft}`,`High Score: ${M.highScore}`,"Created by Dan Hough (@basicallydan)",`Current Speed: ${n.getSpeed()}`]))}),r.afterCycle(()=>{M.livesLeft===0&&f()}),r.addUIElement(e),y.addEventListener("mousemove",s=>{r.setMouseX(s.pageX),r.setMouseY(s.pageY),n.resetDirection(),n.startMovingIfPossible()}),y.addEventListener("click",s=>{r.setMouseX(s.pageX),r.setMouseY(s.pageY),n.resetDirection(),n.startMovingIfPossible()}),y.focus(),P.default.bind("f",n.speedBoost.bind(n)),P.default.bind("t",n.attemptTrick.bind(n)),P.default.bind(["w","up"],()=>n.stop()),P.default.bind(["a","left"],()=>{n.direction===270?n.stepWest():n.turnWest()}),P.default.bind(["s","down"],()=>{n.setDirection(180),n.startMovingIfPossible()}),P.default.bind(["d","right"],()=>{n.direction===90?n.stepEast():n.turnEast()}),P.default.bind("m",h),P.default.bind("b",i),P.default.bind("space",l),(0,Tt.default)(y).on("press",s=>{s.preventDefault(),r.setMouseX(s.gesture.center.x),r.setMouseY(s.gesture.center.y)}).on("tap",s=>{r.setMouseX(s.gesture.center.x),r.setMouseY(s.gesture.center.y)}).on("pan",s=>{r.setMouseX(s.gesture.center.x),r.setMouseY(s.gesture.center.y),n.resetDirection(),n.startMovingIfPossible()}).on("doubletap",()=>n.speedBoost()),n.isMoving=!1,n.setDirection(270),r.start()}function vt(){let n=window.devicePixelRatio||1;y.style.width=`${window.innerWidth}px`,y.style.height=`${window.innerHeight}px`,y.width=Math.round(window.innerWidth*n),y.height=Math.round(window.innerHeight*n),D.scale(n,n),D.imageSmoothingEnabled=!1}window.addEventListener("resize",vt,!1);vt();te(Qt,ie);})();
/*! Bundled license information:

hammerjs/hammer.js:
  (*! Hammer.JS - v1.0.7dev - 2014-02-18
   * http://eightmedia.github.com/hammer.js
   *
   * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
   * Licensed under the MIT license *)
*/

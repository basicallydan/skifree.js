(()=>{var tt=Object.create;var Oe=Object.defineProperty;var nt=Object.getOwnPropertyDescriptor;var it=Object.getOwnPropertyNames;var rt=Object.getPrototypeOf,st=Object.prototype.hasOwnProperty;var ae=(c,i)=>()=>(i||c((i={exports:{}}).exports,i),i.exports);var ot=(c,i,e,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let d of it(i))!st.call(c,d)&&d!==e&&Oe(c,d,{get:()=>i[d],enumerable:!(s=nt(i,d))||s.enumerable});return c};var we=(c,i,e)=>(e=c!=null?tt(rt(c)):{},ot(i||!c||!c.__esModule?Oe(e,"default",{value:c,enumerable:!0}):e,c));var xe=ae((Rt,de)=>{(function(c,i){"use strict";var e=function(p,n){return new e.Instance(p,n||{})};e.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},e.HAS_POINTEREVENTS=c.navigator.pointerEnabled||c.navigator.msPointerEnabled,e.HAS_TOUCHEVENTS="ontouchstart"in c,e.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,e.NO_MOUSEEVENTS=e.HAS_TOUCHEVENTS&&c.navigator.userAgent.match(e.MOBILE_REGEX),e.EVENT_TYPES={},e.DIRECTION_DOWN="down",e.DIRECTION_LEFT="left",e.DIRECTION_UP="up",e.DIRECTION_RIGHT="right",e.POINTER_MOUSE="mouse",e.POINTER_TOUCH="touch",e.POINTER_PEN="pen",e.UPDATE_VELOCITY_INTERVAL=20,e.EVENT_START="start",e.EVENT_MOVE="move",e.EVENT_END="end",e.DOCUMENT=c.document,e.plugins=e.plugins||{},e.gestures=e.gestures||{},e.READY=!1;function s(){e.READY||(e.event.determineEventTypes(),e.utils.each(e.gestures,function(p){e.detection.register(p)}),e.event.onTouch(e.DOCUMENT,e.EVENT_MOVE,e.detection.detect),e.event.onTouch(e.DOCUMENT,e.EVENT_END,e.detection.detect),e.READY=!0)}e.utils={extend:function(n,u,a){for(var l in u)n[l]!==i&&a||(n[l]=u[l]);return n},each:function(p,n,u){var a,l;if("forEach"in p)p.forEach(n,u);else if(p.length!==i){for(a=0,l=p.length;a<l;a++)if(n.call(u,p[a],a,p)===!1)return}else for(a in p)if(p.hasOwnProperty(a)&&n.call(u,p[a],a,p)===!1)return},hasParent:function(p,n){for(;p;){if(p==n)return!0;p=p.parentNode}return!1},getCenter:function(n){var u=[],a=[];return e.utils.each(n,function(l){u.push(typeof l.clientX<"u"?l.clientX:l.pageX),a.push(typeof l.clientY<"u"?l.clientY:l.pageY)}),{pageX:(Math.min.apply(Math,u)+Math.max.apply(Math,u))/2,pageY:(Math.min.apply(Math,a)+Math.max.apply(Math,a))/2}},getVelocity:function(n,u,a){return{x:Math.abs(u/n)||0,y:Math.abs(a/n)||0}},getAngle:function(n,u){var a=u.pageY-n.pageY,l=u.pageX-n.pageX;return Math.atan2(a,l)*180/Math.PI},getDirection:function(n,u){var a=Math.abs(n.pageX-u.pageX),l=Math.abs(n.pageY-u.pageY);return a>=l?n.pageX-u.pageX>0?e.DIRECTION_LEFT:e.DIRECTION_RIGHT:n.pageY-u.pageY>0?e.DIRECTION_UP:e.DIRECTION_DOWN},getDistance:function(n,u){var a=u.pageX-n.pageX,l=u.pageY-n.pageY;return Math.sqrt(a*a+l*l)},getScale:function(n,u){return n.length>=2&&u.length>=2?this.getDistance(u[0],u[1])/this.getDistance(n[0],n[1]):1},getRotation:function(n,u){return n.length>=2&&u.length>=2?this.getAngle(u[1],u[0])-this.getAngle(n[1],n[0]):0},isVertical:function(n){return n==e.DIRECTION_UP||n==e.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(n,u){!u||!n||!n.style||(e.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(a){e.utils.each(u,function(l,y){a&&(y=a+y.substring(0,1).toUpperCase()+y.substring(1)),y in n.style&&(n.style[y]=l)})}),u.userSelect=="none"&&(n.onselectstart=function(){return!1}),u.userDrag=="none"&&(n.ondragstart=function(){return!1}))},startDefaultBrowserBehavior:function(n,u){!u||!n||!n.style||(e.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(a){e.utils.each(u,function(l,y){a&&(y=a+y.substring(0,1).toUpperCase()+y.substring(1)),y in n.style&&(n.style[y]="")})}),u.userSelect=="none"&&(n.onselectstart=null),u.userDrag=="none"&&(n.ondragstart=null))}},e.Instance=function(p,n){var u=this;return s(),this.element=p,this.enabled=!0,this.options=e.utils.extend(e.utils.extend({},e.defaults),n||{}),this.options.stop_browser_behavior&&e.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),this._eventStartHandler=e.event.onTouch(p,e.EVENT_START,function(a){u.enabled&&e.detection.startDetect(u,a)}),this._eventHandler=[],this},e.Instance.prototype={on:function(n,u){var a=n.split(" ");return e.utils.each(a,function(l){this.element.addEventListener(l,u,!1),this._eventHandler.push({gesture:l,handler:u})},this),this},off:function(n,u){var a=n.split(" ");return e.utils.each(a,function(l){this.element.removeEventListener(l,u,!1);var y=-1;e.utils.each(this._eventHandler,function(b,P){y===-1&&b.gesture===l&&b.handler===u&&(y=P)},this),y>-1&&this._eventHandler.splice(y,1)},this),this},trigger:function(n,u){u||(u={});var a=e.DOCUMENT.createEvent("Event");a.initEvent(n,!0,!0),a.gesture=u;var l=this.element;return e.utils.hasParent(u.target,l)&&(l=u.target),l.dispatchEvent(a),this},enable:function(n){return this.enabled=n,this},dispose:function(){return this.options.stop_browser_behavior&&e.utils.startDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),e.utils.each(this._eventHandler,function(n){this.element.removeEventListener(n.gesture,n.handler,!1)},this),this._eventHandler.length=0,e.event.unbindDom(this.element,e.EVENT_TYPES[e.EVENT_START],this._eventStartHandler),this}};var d=null,E=!1,v=!1;e.event={bindDom:function(p,n,u){var a=n.split(" ");e.utils.each(a,function(l){p.addEventListener(l,u,!1)})},unbindDom:function(p,n,u){var a=n.split(" ");e.utils.each(a,function(l){p.removeEventListener(l,u,!1)})},onTouch:function(n,u,a){var l=this,y=function(P){var S=P.type.toLowerCase();if(!(S.match(/mouse/)&&v)){S.match(/touch/)||S.match(/pointerdown/)||S.match(/mouse/)&&P.which===1?E=!0:S.match(/mouse/)&&!P.which&&(E=!1),S.match(/touch|pointer/)&&(v=!0);var x=0;E&&(e.HAS_POINTEREVENTS&&u!=e.EVENT_END?x=e.PointerEvent.updatePointer(u,P):S.match(/touch/)?x=P.touches.length:v||(x=S.match(/up/)?0:1),x>0&&u==e.EVENT_END?u=e.EVENT_MOVE:x||(u=e.EVENT_END),(x||d===null)&&(d=P),a.call(e.detection,l.collectEventData(n,u,l.getTouchList(d,u),P)),e.HAS_POINTEREVENTS&&u==e.EVENT_END&&(x=e.PointerEvent.updatePointer(u,P))),x||(d=null,E=!1,v=!1,e.PointerEvent.reset())}};return this.bindDom(n,e.EVENT_TYPES[u],y),y},determineEventTypes:function(){var n;e.HAS_POINTEREVENTS?n=e.PointerEvent.getEvents():e.NO_MOUSEEVENTS?n=["touchstart","touchmove","touchend touchcancel"]:n=["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],e.EVENT_TYPES[e.EVENT_START]=n[0],e.EVENT_TYPES[e.EVENT_MOVE]=n[1],e.EVENT_TYPES[e.EVENT_END]=n[2]},getTouchList:function(n){return e.HAS_POINTEREVENTS?e.PointerEvent.getTouchList():n.touches?n.touches:(n.identifier=1,[n])},collectEventData:function(n,u,a,l){var y=e.POINTER_TOUCH;return(l.type.match(/mouse/)||e.PointerEvent.matchType(e.POINTER_MOUSE,l))&&(y=e.POINTER_MOUSE),{center:e.utils.getCenter(a),timeStamp:new Date().getTime(),target:l.target,touches:a,eventType:u,pointerType:y,srcEvent:l,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return e.detection.stopDetect()}}}},e.PointerEvent={pointers:{},getTouchList:function(){var p=this,n=[];return e.utils.each(p.pointers,function(u){n.push(u)}),n},updatePointer:function(p,n){return p==e.EVENT_END?delete this.pointers[n.pointerId]:(n.identifier=n.pointerId,this.pointers[n.pointerId]=n),Object.keys(this.pointers).length},matchType:function(p,n){if(!n.pointerType)return!1;var u=n.pointerType,a={};return a[e.POINTER_MOUSE]=u===n.MSPOINTER_TYPE_MOUSE||u===e.POINTER_MOUSE,a[e.POINTER_TOUCH]=u===n.MSPOINTER_TYPE_TOUCH||u===e.POINTER_TOUCH,a[e.POINTER_PEN]=u===n.MSPOINTER_TYPE_PEN||u===e.POINTER_PEN,a[p]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},e.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(n,u){this.current||(this.stopped=!1,this.current={inst:n,startEvent:e.utils.extend({},u),lastEvent:!1,lastVEvent:!1,velocity:!1,name:""},this.detect(u))},detect:function(n){if(!(!this.current||this.stopped)){n=this.extendEventData(n);var u=this.current.inst.options;return e.utils.each(this.gestures,function(a){if(!this.stopped&&u[a.name]!==!1&&a.handler.call(a,n,this.current.inst)===!1)return this.stopDetect(),!1},this),this.current&&(this.current.lastEvent=n),n.eventType==e.EVENT_END&&!n.touches.length-1&&this.stopDetect(),n}},stopDetect:function(){this.previous=e.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(n){var u=this.current.startEvent,a=this.current.lastVEvent;u&&(n.touches.length!=u.touches.length||n.touches===u.touches)&&(u.touches=[],e.utils.each(n.touches,function(F){u.touches.push(e.utils.extend({},F))}));var l=n.timeStamp-u.timeStamp,y=n.center.pageX-u.center.pageX,b=n.center.pageY-u.center.pageY,P,S,x=this.current.velocity;return a!==!1&&n.timeStamp-a.timeStamp>e.UPDATE_VELOCITY_INTERVAL?(x=e.utils.getVelocity(n.timeStamp-a.timeStamp,n.center.pageX-a.center.pageX,n.center.pageY-a.center.pageY),this.current.lastVEvent=n,x.x>0&&x.y>0&&(this.current.velocity=x)):this.current.velocity===!1&&(x=e.utils.getVelocity(l,y,b),this.current.velocity=x,this.current.lastVEvent=n),n.eventType==="end"?(P=this.current.lastEvent&&this.current.lastEvent.interimAngle,S=this.current.lastEvent&&this.current.lastEvent.interimDirection):(P=this.current.lastEvent&&e.utils.getAngle(this.current.lastEvent.center,n.center),S=this.current.lastEvent&&e.utils.getDirection(this.current.lastEvent.center,n.center)),e.utils.extend(n,{deltaTime:l,deltaX:y,deltaY:b,velocityX:x.x,velocityY:x.y,distance:e.utils.getDistance(u.center,n.center),angle:e.utils.getAngle(u.center,n.center),interimAngle:P,direction:e.utils.getDirection(u.center,n.center),interimDirection:S,scale:e.utils.getScale(u.touches,n.touches),rotation:e.utils.getRotation(u.touches,n.touches),startEvent:u}),n},register:function(n){var u=n.defaults||{};return u[n.name]===i&&(u[n.name]=!0),e.utils.extend(e.defaults,u,!0),n.index=n.index||1e3,this.gestures.push(n),this.gestures.sort(function(a,l){return a.index<l.index?-1:a.index>l.index?1:0}),this.gestures}},e.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(n,u){if(e.detection.current.name!=this.name&&this.triggered){u.trigger(this.name+"end",n),this.triggered=!1;return}if(!(u.options.drag_max_touches>0&&n.touches.length>u.options.drag_max_touches))switch(n.eventType){case e.EVENT_START:this.triggered=!1;break;case e.EVENT_MOVE:if(n.distance<u.options.drag_min_distance&&e.detection.current.name!=this.name)return;if(e.detection.current.name!=this.name&&(e.detection.current.name=this.name,u.options.correct_for_drag_min_distance&&n.distance>0)){var a=Math.abs(u.options.drag_min_distance/n.distance);e.detection.current.startEvent.center.pageX+=n.deltaX*a,e.detection.current.startEvent.center.pageY+=n.deltaY*a,n=e.detection.extendEventData(n)}(e.detection.current.lastEvent.drag_locked_to_axis||u.options.drag_lock_to_axis&&u.options.drag_lock_min_distance<=n.distance)&&(n.drag_locked_to_axis=!0);var l=e.detection.current.lastEvent.direction;n.drag_locked_to_axis&&l!==n.direction&&(e.utils.isVertical(l)?n.direction=n.deltaY<0?e.DIRECTION_UP:e.DIRECTION_DOWN:n.direction=n.deltaX<0?e.DIRECTION_LEFT:e.DIRECTION_RIGHT),this.triggered||(u.trigger(this.name+"start",n),this.triggered=!0),u.trigger(this.name,n),u.trigger(this.name+n.direction,n),(u.options.drag_block_vertical&&e.utils.isVertical(n.direction)||u.options.drag_block_horizontal&&!e.utils.isVertical(n.direction))&&n.preventDefault();break;case e.EVENT_END:this.triggered&&u.trigger(this.name+"end",n),this.triggered=!1;break}}},e.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(n,u){switch(n.eventType){case e.EVENT_START:clearTimeout(this.timer),e.detection.current.name=this.name,this.timer=setTimeout(function(){e.detection.current.name=="hold"&&u.trigger("hold",n)},u.options.hold_timeout);break;case e.EVENT_MOVE:n.distance>u.options.hold_threshold&&clearTimeout(this.timer);break;case e.EVENT_END:clearTimeout(this.timer);break}}},e.gestures.Release={name:"release",index:1/0,handler:function(n,u){n.eventType==e.EVENT_END&&u.trigger(this.name,n)}},e.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(n,u){if(n.eventType==e.EVENT_END){if(u.options.swipe_max_touches>0&&n.touches.length<u.options.swipe_min_touches&&n.touches.length>u.options.swipe_max_touches)return;(n.velocityX>u.options.swipe_velocity||n.velocityY>u.options.swipe_velocity)&&(u.trigger(this.name,n),u.trigger(this.name+n.direction,n))}}},e.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(n,u){if(n.eventType==e.EVENT_MOVE&&!e.detection.current.reachedTapMaxDistance)e.detection.current.reachedTapMaxDistance=n.distance>u.options.tap_max_distance;else if(n.eventType==e.EVENT_END&&n.srcEvent.type!="touchcancel"){var a=e.detection.previous,l=!1;if(e.detection.current.reachedTapMaxDistance||n.deltaTime>u.options.tap_max_touchtime)return;a&&a.name=="tap"&&n.timeStamp-a.lastEvent.timeStamp<u.options.doubletap_interval&&n.distance<u.options.doubletap_distance&&(u.trigger("doubletap",n),l=!0),(!l||u.options.tap_always)&&(e.detection.current.name="tap",u.trigger(e.detection.current.name,n))}}},e.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(n,u){if(u.options.prevent_mouseevents&&n.pointerType==e.POINTER_MOUSE){n.stopDetect();return}u.options.prevent_default&&n.preventDefault(),n.eventType==e.EVENT_START&&u.trigger(this.name,n)}},e.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(n,u){if(e.detection.current.name!=this.name&&this.triggered){u.trigger(this.name+"end",n),this.triggered=!1;return}if(!(n.touches.length<2))switch(u.options.transform_always_block&&n.preventDefault(),n.eventType){case e.EVENT_START:this.triggered=!1;break;case e.EVENT_MOVE:var a=Math.abs(1-n.scale),l=Math.abs(n.rotation);if(a<u.options.transform_min_scale&&l<u.options.transform_min_rotation)return;e.detection.current.name=this.name,this.triggered||(u.trigger(this.name+"start",n),this.triggered=!0),u.trigger(this.name,n),l>u.options.transform_min_rotation&&u.trigger("rotate",n),a>u.options.transform_min_scale&&(u.trigger("pinch",n),u.trigger("pinch"+(n.scale<1?"in":"out"),n));break;case e.EVENT_END:this.triggered&&u.trigger(this.name+"end",n),this.triggered=!1;break}}},typeof define=="function"&&define.amd?define(function(){return e}):typeof de=="object"&&de.exports?de.exports=e:c.Hammer=e})(window)});var Ce=ae((It,ge)=>{(function(){for(var c={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},i={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},e={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},s={option:"alt",command:"meta",return:"enter",escape:"esc"},d,E={},v={},p={},n,u=!1,a=!1,l=1;l<20;++l)c[111+l]="f"+l;for(l=0;l<=9;++l)c[l+96]=l;function y(m,_,O){if(m.addEventListener){m.addEventListener(_,O,!1);return}m.attachEvent("on"+_,O)}function b(m){return m.type=="keypress"?String.fromCharCode(m.which):c[m.which]?c[m.which]:i[m.which]?i[m.which]:String.fromCharCode(m.which).toLowerCase()}function P(m,_){return m.sort().join(",")===_.sort().join(",")}function S(m){m=m||{};var _=!1,O;for(O in p){if(m[O]){_=!0;continue}p[O]=0}_||(a=!1)}function x(m,_,O,D,G){var Y,k,L=[],K=O.type;if(!E[m])return[];for(K=="keyup"&&H(m)&&(_=[m]),Y=0;Y<E[m].length;++Y)k=E[m][Y],!(k.seq&&p[k.seq]!=k.level)&&K==k.action&&(K=="keypress"&&!O.metaKey&&!O.ctrlKey||P(_,k.modifiers))&&(D&&k.combo==G&&E[m].splice(Y,1),L.push(k));return L}function F(m){var _=[];return m.shiftKey&&_.push("shift"),m.altKey&&_.push("alt"),m.ctrlKey&&_.push("ctrl"),m.metaKey&&_.push("meta"),_}function X(m,_){m(_)===!1&&(_.preventDefault&&_.preventDefault(),_.stopPropagation&&_.stopPropagation(),_.returnValue=!1,_.cancelBubble=!0)}function ne(m,_){if(!V.stopCallback(_,_.target||_.srcElement)){var O=x(m,F(_),_),D,G={},Y=!1;for(D=0;D<O.length;++D){if(O[D].seq){Y=!0,G[O[D].seq]=1,X(O[D].callback,_);continue}!Y&&!a&&X(O[D].callback,_)}_.type==a&&!H(m)&&S(G)}}function ee(m){m.which=typeof m.which=="number"?m.which:m.keyCode;var _=b(m);if(_){if(m.type=="keyup"&&u==_){u=!1;return}ne(_,m)}}function H(m){return m=="shift"||m=="ctrl"||m=="alt"||m=="meta"}function B(){clearTimeout(n),n=setTimeout(S,1e3)}function o(){if(!d){d={};for(var m in c)m>95&&m<112||c.hasOwnProperty(m)&&(d[c[m]]=m)}return d}function I(m,_,O){return O||(O=o()[m]?"keydown":"keypress"),O=="keypress"&&_.length&&(O="keydown"),O}function ie(m,_,O,D){p[m]=0,D||(D=I(_[0],[]));var G=function(L){a=D,++p[m],B()},Y=function(L){X(O,L),D!=="keyup"&&(u=b(L)),setTimeout(S,10)},k;for(k=0;k<_.length;++k)W(_[k],k<_.length-1?G:Y,D,m,k)}function W(m,_,O,D,G){m=m.replace(/\s+/g," ");var Y=m.split(" "),k,L,K,z=[];if(Y.length>1){ie(m,Y,_,O);return}for(K=m==="+"?["+"]:m.split("+"),k=0;k<K.length;++k)L=K[k],s[L]&&(L=s[L]),O&&O!="keypress"&&e[L]&&(L=e[L],z.push("shift")),H(L)&&z.push(L);O=I(L,z,O),E[L]||(E[L]=[]),x(L,z,{type:O},!D,m),E[L][D?"unshift":"push"]({callback:_,modifiers:z,action:O,seq:D,level:G,combo:m})}function T(m,_,O){for(var D=0;D<m.length;++D)W(m[D],_,O)}y(document,"keypress",ee),y(document,"keydown",ee),y(document,"keyup",ee);var V={bind:function(m,_,O){return T(m instanceof Array?m:[m],_,O),v[m+":"+O]=_,this},unbind:function(m,_){return v[m+":"+_]&&(delete v[m+":"+_],this.bind(m,function(){},_)),this},trigger:function(m,_){return v[m+":"+_](),this},reset:function(){return E={},v={},this},stopCallback:function(m,_){return(" "+_.className+" ").indexOf(" mousetrap ")>-1?!1:_.tagName=="INPUT"||_.tagName=="SELECT"||_.tagName=="TEXTAREA"||_.contentEditable&&_.contentEditable=="true"}};window.Mousetrap=V,typeof define=="function"&&define.amd&&define("mousetrap",function(){return V}),typeof ge=="object"&&ge.exports&&(ge.exports=V)})()});var qe=ae((Gt,Te)=>{"use strict";var se=typeof Reflect=="object"?Reflect:null,Le=se&&typeof se.apply=="function"?se.apply:function(i,e,s){return Function.prototype.apply.call(i,e,s)},ve;se&&typeof se.ownKeys=="function"?ve=se.ownKeys:Object.getOwnPropertySymbols?ve=function(i){return Object.getOwnPropertyNames(i).concat(Object.getOwnPropertySymbols(i))}:ve=function(i){return Object.getOwnPropertyNames(i)};function pt(c){console&&console.warn&&console.warn(c)}var Ae=Number.isNaN||function(i){return i!==i};function R(){R.init.call(this)}Te.exports=R;Te.exports.once=mt;R.EventEmitter=R;R.prototype._events=void 0;R.prototype._eventsCount=0;R.prototype._maxListeners=void 0;var Be=10;function me(c){if(typeof c!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof c)}Object.defineProperty(R,"defaultMaxListeners",{enumerable:!0,get:function(){return Be},set:function(c){if(typeof c!="number"||c<0||Ae(c))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+c+".");Be=c}});R.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};R.prototype.setMaxListeners=function(i){if(typeof i!="number"||i<0||Ae(i))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+i+".");return this._maxListeners=i,this};function He(c){return c._maxListeners===void 0?R.defaultMaxListeners:c._maxListeners}R.prototype.getMaxListeners=function(){return He(this)};R.prototype.emit=function(i){for(var e=[],s=1;s<arguments.length;s++)e.push(arguments[s]);var d=i==="error",E=this._events;if(E!==void 0)d=d&&E.error===void 0;else if(!d)return!1;if(d){var v;if(e.length>0&&(v=e[0]),v instanceof Error)throw v;var p=new Error("Unhandled error."+(v?" ("+v.message+")":""));throw p.context=v,p}var n=E[i];if(n===void 0)return!1;if(typeof n=="function")Le(n,this,e);else for(var u=n.length,a=We(n,u),s=0;s<u;++s)Le(a[s],this,e);return!0};function Ve(c,i,e,s){var d,E,v;if(me(e),E=c._events,E===void 0?(E=c._events=Object.create(null),c._eventsCount=0):(E.newListener!==void 0&&(c.emit("newListener",i,e.listener?e.listener:e),E=c._events),v=E[i]),v===void 0)v=E[i]=e,++c._eventsCount;else if(typeof v=="function"?v=E[i]=s?[e,v]:[v,e]:s?v.unshift(e):v.push(e),d=He(c),d>0&&v.length>d&&!v.warned){v.warned=!0;var p=new Error("Possible EventEmitter memory leak detected. "+v.length+" "+String(i)+" listeners added. Use emitter.setMaxListeners() to increase limit");p.name="MaxListenersExceededWarning",p.emitter=c,p.type=i,p.count=v.length,pt(p)}return c}R.prototype.addListener=function(i,e){return Ve(this,i,e,!1)};R.prototype.on=R.prototype.addListener;R.prototype.prependListener=function(i,e){return Ve(this,i,e,!0)};function dt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ye(c,i,e){var s={fired:!1,wrapFn:void 0,target:c,type:i,listener:e},d=dt.bind(s);return d.listener=e,s.wrapFn=d,d}R.prototype.once=function(i,e){return me(e),this.on(i,Ye(this,i,e)),this};R.prototype.prependOnceListener=function(i,e){return me(e),this.prependListener(i,Ye(this,i,e)),this};R.prototype.removeListener=function(i,e){var s,d,E,v,p;if(me(e),d=this._events,d===void 0)return this;if(s=d[i],s===void 0)return this;if(s===e||s.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete d[i],d.removeListener&&this.emit("removeListener",i,s.listener||e));else if(typeof s!="function"){for(E=-1,v=s.length-1;v>=0;v--)if(s[v]===e||s[v].listener===e){p=s[v].listener,E=v;break}if(E<0)return this;E===0?s.shift():gt(s,E),s.length===1&&(d[i]=s[0]),d.removeListener!==void 0&&this.emit("removeListener",i,p||e)}return this};R.prototype.off=R.prototype.removeListener;R.prototype.removeAllListeners=function(i){var e,s,d;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[i]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[i]),this;if(arguments.length===0){var E=Object.keys(s),v;for(d=0;d<E.length;++d)v=E[d],v!=="removeListener"&&this.removeAllListeners(v);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=s[i],typeof e=="function")this.removeListener(i,e);else if(e!==void 0)for(d=e.length-1;d>=0;d--)this.removeListener(i,e[d]);return this};function Fe(c,i,e){var s=c._events;if(s===void 0)return[];var d=s[i];return d===void 0?[]:typeof d=="function"?e?[d.listener||d]:[d]:e?vt(d):We(d,d.length)}R.prototype.listeners=function(i){return Fe(this,i,!0)};R.prototype.rawListeners=function(i){return Fe(this,i,!1)};R.listenerCount=function(c,i){return typeof c.listenerCount=="function"?c.listenerCount(i):Xe.call(c,i)};R.prototype.listenerCount=Xe;function Xe(c){var i=this._events;if(i!==void 0){var e=i[c];if(typeof e=="function")return 1;if(e!==void 0)return e.length}return 0}R.prototype.eventNames=function(){return this._eventsCount>0?ve(this._events):[]};function We(c,i){for(var e=new Array(i),s=0;s<i;++s)e[s]=c[s];return e}function gt(c,i){for(;i+1<c.length;i++)c[i]=c[i+1];c.pop()}function vt(c){for(var i=new Array(c.length),e=0;e<i.length;++e)i[e]=c[e].listener||c[e];return i}function mt(c,i){return new Promise(function(e,s){function d(v){c.removeListener(i,E),s(v)}function E(){typeof c.removeListener=="function"&&c.removeListener("error",d),e([].slice.call(arguments))}Ue(c,i,E,{once:!0}),i!=="error"&&Et(c,d,{once:!0})})}function Et(c,i,e){typeof c.on=="function"&&Ue(c,"error",i,e)}function Ue(c,i,e,s){if(typeof c.on=="function")s.once?c.once(i,e):c.on(i,e);else if(typeof c.addEventListener=="function")c.addEventListener(i,function d(E){s.once&&c.removeEventListener(i,d),e(E)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof c)}});var Ge=ae((ce,Ee)=>{(function(){var c=this,i=c._,e={},s=Array.prototype,d=Object.prototype,E=Function.prototype,v=s.push,p=s.slice,n=s.concat,u=d.toString,a=d.hasOwnProperty,l=s.forEach,y=s.map,b=s.reduce,P=s.reduceRight,S=s.filter,x=s.every,F=s.some,X=s.indexOf,ne=s.lastIndexOf,ee=Array.isArray,H=Object.keys,B=E.bind,o=function(t){if(t instanceof o)return t;if(!(this instanceof o))return new o(t);this._wrapped=t};typeof ce<"u"?(typeof Ee<"u"&&Ee.exports&&(ce=Ee.exports=o),ce._=o):c._=o,o.VERSION="1.6.0";var I=o.each=o.forEach=function(t,r,f){if(t==null)return t;if(l&&t.forEach===l)t.forEach(r,f);else if(t.length===+t.length){for(var h=0,g=t.length;h<g;h++)if(r.call(f,t[h],h,t)===e)return}else for(var w=o.keys(t),h=0,g=w.length;h<g;h++)if(r.call(f,t[w[h]],w[h],t)===e)return;return t};o.map=o.collect=function(t,r,f){var h=[];return t==null?h:y&&t.map===y?t.map(r,f):(I(t,function(g,w,M){h.push(r.call(f,g,w,M))}),h)};var ie="Reduce of empty array with no initial value";o.reduce=o.foldl=o.inject=function(t,r,f,h){var g=arguments.length>2;if(t==null&&(t=[]),b&&t.reduce===b)return h&&(r=o.bind(r,h)),g?t.reduce(r,f):t.reduce(r);if(I(t,function(w,M,N){g?f=r.call(h,f,w,M,N):(f=w,g=!0)}),!g)throw new TypeError(ie);return f},o.reduceRight=o.foldr=function(t,r,f,h){var g=arguments.length>2;if(t==null&&(t=[]),P&&t.reduceRight===P)return h&&(r=o.bind(r,h)),g?t.reduceRight(r,f):t.reduceRight(r);var w=t.length;if(w!==+w){var M=o.keys(t);w=M.length}if(I(t,function(N,C,A){C=M?M[--w]:--w,g?f=r.call(h,f,t[C],C,A):(f=t[C],g=!0)}),!g)throw new TypeError(ie);return f},o.find=o.detect=function(t,r,f){var h;return W(t,function(g,w,M){if(r.call(f,g,w,M))return h=g,!0}),h},o.filter=o.select=function(t,r,f){var h=[];return t==null?h:S&&t.filter===S?t.filter(r,f):(I(t,function(g,w,M){r.call(f,g,w,M)&&h.push(g)}),h)},o.reject=function(t,r,f){return o.filter(t,function(h,g,w){return!r.call(f,h,g,w)},f)},o.every=o.all=function(t,r,f){r||(r=o.identity);var h=!0;return t==null?h:x&&t.every===x?t.every(r,f):(I(t,function(g,w,M){if(!(h=h&&r.call(f,g,w,M)))return e}),!!h)};var W=o.some=o.any=function(t,r,f){r||(r=o.identity);var h=!1;return t==null?h:F&&t.some===F?t.some(r,f):(I(t,function(g,w,M){if(h||(h=r.call(f,g,w,M)))return e}),!!h)};o.contains=o.include=function(t,r){return t==null?!1:X&&t.indexOf===X?t.indexOf(r)!=-1:W(t,function(f){return f===r})},o.invoke=function(t,r){var f=p.call(arguments,2),h=o.isFunction(r);return o.map(t,function(g){return(h?r:g[r]).apply(g,f)})},o.pluck=function(t,r){return o.map(t,o.property(r))},o.where=function(t,r){return o.filter(t,o.matches(r))},o.findWhere=function(t,r){return o.find(t,o.matches(r))},o.max=function(t,r,f){if(!r&&o.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var h=-1/0,g=-1/0;return I(t,function(w,M,N){var C=r?r.call(f,w,M,N):w;C>g&&(h=w,g=C)}),h},o.min=function(t,r,f){if(!r&&o.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var h=1/0,g=1/0;return I(t,function(w,M,N){var C=r?r.call(f,w,M,N):w;C<g&&(h=w,g=C)}),h},o.shuffle=function(t){var r,f=0,h=[];return I(t,function(g){r=o.random(f++),h[f-1]=h[r],h[r]=g}),h},o.sample=function(t,r,f){return r==null||f?(t.length!==+t.length&&(t=o.values(t)),t[o.random(t.length-1)]):o.shuffle(t).slice(0,Math.max(0,r))};var T=function(t){return t==null?o.identity:o.isFunction(t)?t:o.property(t)};o.sortBy=function(t,r,f){return r=T(r),o.pluck(o.map(t,function(h,g,w){return{value:h,index:g,criteria:r.call(f,h,g,w)}}).sort(function(h,g){var w=h.criteria,M=g.criteria;if(w!==M){if(w>M||w===void 0)return 1;if(w<M||M===void 0)return-1}return h.index-g.index}),"value")};var V=function(t){return function(r,f,h){var g={};return f=T(f),I(r,function(w,M){var N=f.call(h,w,M,r);t(g,N,w)}),g}};o.groupBy=V(function(t,r,f){o.has(t,r)?t[r].push(f):t[r]=[f]}),o.indexBy=V(function(t,r,f){t[r]=f}),o.countBy=V(function(t,r){o.has(t,r)?t[r]++:t[r]=1}),o.sortedIndex=function(t,r,f,h){f=T(f);for(var g=f.call(h,r),w=0,M=t.length;w<M;){var N=w+M>>>1;f.call(h,t[N])<g?w=N+1:M=N}return w},o.toArray=function(t){return t?o.isArray(t)?p.call(t):t.length===+t.length?o.map(t,o.identity):o.values(t):[]},o.size=function(t){return t==null?0:t.length===+t.length?t.length:o.keys(t).length},o.first=o.head=o.take=function(t,r,f){if(t!=null)return r==null||f?t[0]:r<0?[]:p.call(t,0,r)},o.initial=function(t,r,f){return p.call(t,0,t.length-(r==null||f?1:r))},o.last=function(t,r,f){if(t!=null)return r==null||f?t[t.length-1]:p.call(t,Math.max(t.length-r,0))},o.rest=o.tail=o.drop=function(t,r,f){return p.call(t,r==null||f?1:r)},o.compact=function(t){return o.filter(t,o.identity)};var m=function(t,r,f){return r&&o.every(t,o.isArray)?n.apply(f,t):(I(t,function(h){o.isArray(h)||o.isArguments(h)?r?v.apply(f,h):m(h,r,f):f.push(h)}),f)};o.flatten=function(t,r){return m(t,r,[])},o.without=function(t){return o.difference(t,p.call(arguments,1))},o.partition=function(t,r){var f=[],h=[];return I(t,function(g){(r(g)?f:h).push(g)}),[f,h]},o.uniq=o.unique=function(t,r,f,h){o.isFunction(r)&&(h=f,f=r,r=!1);var g=f?o.map(t,f,h):t,w=[],M=[];return I(g,function(N,C){(r?!C||M[M.length-1]!==N:!o.contains(M,N))&&(M.push(N),w.push(t[C]))}),w},o.union=function(){return o.uniq(o.flatten(arguments,!0))},o.intersection=function(t){var r=p.call(arguments,1);return o.filter(o.uniq(t),function(f){return o.every(r,function(h){return o.contains(h,f)})})},o.difference=function(t){var r=n.apply(s,p.call(arguments,1));return o.filter(t,function(f){return!o.contains(r,f)})},o.zip=function(){for(var t=o.max(o.pluck(arguments,"length").concat(0)),r=new Array(t),f=0;f<t;f++)r[f]=o.pluck(arguments,""+f);return r},o.object=function(t,r){if(t==null)return{};for(var f={},h=0,g=t.length;h<g;h++)r?f[t[h]]=r[h]:f[t[h][0]]=t[h][1];return f},o.indexOf=function(t,r,f){if(t==null)return-1;var h=0,g=t.length;if(f)if(typeof f=="number")h=f<0?Math.max(0,g+f):f;else return h=o.sortedIndex(t,r),t[h]===r?h:-1;if(X&&t.indexOf===X)return t.indexOf(r,f);for(;h<g;h++)if(t[h]===r)return h;return-1},o.lastIndexOf=function(t,r,f){if(t==null)return-1;var h=f!=null;if(ne&&t.lastIndexOf===ne)return h?t.lastIndexOf(r,f):t.lastIndexOf(r);for(var g=h?f:t.length;g--;)if(t[g]===r)return g;return-1},o.range=function(t,r,f){arguments.length<=1&&(r=t||0,t=0),f=arguments[2]||1;for(var h=Math.max(Math.ceil((r-t)/f),0),g=0,w=new Array(h);g<h;)w[g++]=t,t+=f;return w};var _=function(){};o.bind=function(t,r){var f,h;if(B&&t.bind===B)return B.apply(t,p.call(arguments,1));if(!o.isFunction(t))throw new TypeError;return f=p.call(arguments,2),h=function(){if(!(this instanceof h))return t.apply(r,f.concat(p.call(arguments)));_.prototype=t.prototype;var g=new _;_.prototype=null;var w=t.apply(g,f.concat(p.call(arguments)));return Object(w)===w?w:g}},o.partial=function(t){var r=p.call(arguments,1);return function(){for(var f=0,h=r.slice(),g=0,w=h.length;g<w;g++)h[g]===o&&(h[g]=arguments[f++]);for(;f<arguments.length;)h.push(arguments[f++]);return t.apply(this,h)}},o.bindAll=function(t){var r=p.call(arguments,1);if(r.length===0)throw new Error("bindAll must be passed function names");return I(r,function(f){t[f]=o.bind(t[f],t)}),t},o.memoize=function(t,r){var f={};return r||(r=o.identity),function(){var h=r.apply(this,arguments);return o.has(f,h)?f[h]:f[h]=t.apply(this,arguments)}},o.delay=function(t,r){var f=p.call(arguments,2);return setTimeout(function(){return t.apply(null,f)},r)},o.defer=function(t){return o.delay.apply(o,[t,1].concat(p.call(arguments,1)))},o.throttle=function(t,r,f){var h,g,w,M=null,N=0;f||(f={});var C=function(){N=f.leading===!1?0:o.now(),M=null,w=t.apply(h,g),h=g=null};return function(){var A=o.now();!N&&f.leading===!1&&(N=A);var U=r-(A-N);return h=this,g=arguments,U<=0?(clearTimeout(M),M=null,N=A,w=t.apply(h,g),h=g=null):!M&&f.trailing!==!1&&(M=setTimeout(C,U)),w}},o.debounce=function(t,r,f){var h,g,w,M,N,C=function(){var A=o.now()-M;A<r?h=setTimeout(C,r-A):(h=null,f||(N=t.apply(w,g),w=g=null))};return function(){w=this,g=arguments,M=o.now();var A=f&&!h;return h||(h=setTimeout(C,r)),A&&(N=t.apply(w,g),w=g=null),N}},o.once=function(t){var r=!1,f;return function(){return r||(r=!0,f=t.apply(this,arguments),t=null),f}},o.wrap=function(t,r){return o.partial(r,t)},o.compose=function(){var t=arguments;return function(){for(var r=arguments,f=t.length-1;f>=0;f--)r=[t[f].apply(this,r)];return r[0]}},o.after=function(t,r){return function(){if(--t<1)return r.apply(this,arguments)}},o.keys=function(t){if(!o.isObject(t))return[];if(H)return H(t);var r=[];for(var f in t)o.has(t,f)&&r.push(f);return r},o.values=function(t){for(var r=o.keys(t),f=r.length,h=new Array(f),g=0;g<f;g++)h[g]=t[r[g]];return h},o.pairs=function(t){for(var r=o.keys(t),f=r.length,h=new Array(f),g=0;g<f;g++)h[g]=[r[g],t[r[g]]];return h},o.invert=function(t){for(var r={},f=o.keys(t),h=0,g=f.length;h<g;h++)r[t[f[h]]]=f[h];return r},o.functions=o.methods=function(t){var r=[];for(var f in t)o.isFunction(t[f])&&r.push(f);return r.sort()},o.extend=function(t){return I(p.call(arguments,1),function(r){if(r)for(var f in r)t[f]=r[f]}),t},o.pick=function(t){var r={},f=n.apply(s,p.call(arguments,1));return I(f,function(h){h in t&&(r[h]=t[h])}),r},o.omit=function(t){var r={},f=n.apply(s,p.call(arguments,1));for(var h in t)o.contains(f,h)||(r[h]=t[h]);return r},o.defaults=function(t){return I(p.call(arguments,1),function(r){if(r)for(var f in r)t[f]===void 0&&(t[f]=r[f])}),t},o.clone=function(t){return o.isObject(t)?o.isArray(t)?t.slice():o.extend({},t):t},o.tap=function(t,r){return r(t),t};var O=function(t,r,f,h){if(t===r)return t!==0||1/t==1/r;if(t==null||r==null)return t===r;t instanceof o&&(t=t._wrapped),r instanceof o&&(r=r._wrapped);var g=u.call(t);if(g!=u.call(r))return!1;switch(g){case"[object String]":return t==String(r);case"[object Number]":return t!=+t?r!=+r:t==0?1/t==1/r:t==+r;case"[object Date]":case"[object Boolean]":return+t==+r;case"[object RegExp]":return t.source==r.source&&t.global==r.global&&t.multiline==r.multiline&&t.ignoreCase==r.ignoreCase}if(typeof t!="object"||typeof r!="object")return!1;for(var w=f.length;w--;)if(f[w]==t)return h[w]==r;var M=t.constructor,N=r.constructor;if(M!==N&&!(o.isFunction(M)&&M instanceof M&&o.isFunction(N)&&N instanceof N)&&"constructor"in t&&"constructor"in r)return!1;f.push(t),h.push(r);var C=0,A=!0;if(g=="[object Array]"){if(C=t.length,A=C==r.length,A)for(;C--&&(A=O(t[C],r[C],f,h)););}else{for(var U in t)if(o.has(t,U)&&(C++,!(A=o.has(r,U)&&O(t[U],r[U],f,h))))break;if(A){for(U in r)if(o.has(r,U)&&!C--)break;A=!C}}return f.pop(),h.pop(),A};o.isEqual=function(t,r){return O(t,r,[],[])},o.isEmpty=function(t){if(t==null)return!0;if(o.isArray(t)||o.isString(t))return t.length===0;for(var r in t)if(o.has(t,r))return!1;return!0},o.isElement=function(t){return!!(t&&t.nodeType===1)},o.isArray=ee||function(t){return u.call(t)=="[object Array]"},o.isObject=function(t){return t===Object(t)},I(["Arguments","Function","String","Number","Date","RegExp"],function(t){o["is"+t]=function(r){return u.call(r)=="[object "+t+"]"}}),o.isArguments(arguments)||(o.isArguments=function(t){return!!(t&&o.has(t,"callee"))}),typeof/./!="function"&&(o.isFunction=function(t){return typeof t=="function"}),o.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},o.isNaN=function(t){return o.isNumber(t)&&t!=+t},o.isBoolean=function(t){return t===!0||t===!1||u.call(t)=="[object Boolean]"},o.isNull=function(t){return t===null},o.isUndefined=function(t){return t===void 0},o.has=function(t,r){return a.call(t,r)},o.noConflict=function(){return c._=i,this},o.identity=function(t){return t},o.constant=function(t){return function(){return t}},o.property=function(t){return function(r){return r[t]}},o.matches=function(t){return function(r){if(r===t)return!0;for(var f in t)if(t[f]!==r[f])return!1;return!0}},o.times=function(t,r,f){for(var h=Array(Math.max(0,t)),g=0;g<t;g++)h[g]=r.call(f,g);return h},o.random=function(t,r){return r==null&&(r=t,t=0),t+Math.floor(Math.random()*(r-t+1))},o.now=Date.now||function(){return new Date().getTime()};var D={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};D.unescape=o.invert(D.escape);var G={escape:new RegExp("["+o.keys(D.escape).join("")+"]","g"),unescape:new RegExp("("+o.keys(D.unescape).join("|")+")","g")};o.each(["escape","unescape"],function(t){o[t]=function(r){return r==null?"":(""+r).replace(G[t],function(f){return D[t][f]})}}),o.result=function(t,r){if(t!=null){var f=t[r];return o.isFunction(f)?f.call(t):f}},o.mixin=function(t){I(o.functions(t),function(r){var f=o[r]=t[r];o.prototype[r]=function(){var h=[this._wrapped];return v.apply(h,arguments),z.call(this,f.apply(o,h))}})};var Y=0;o.uniqueId=function(t){var r=++Y+"";return t?t+r:r},o.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var k=/(.)^/,L={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},K=/\\|'|\r|\n|\t|\u2028|\u2029/g;o.template=function(t,r,f){var h;f=o.defaults({},f,o.templateSettings);var g=new RegExp([(f.escape||k).source,(f.interpolate||k).source,(f.evaluate||k).source].join("|")+"|$","g"),w=0,M="__p+='";t.replace(g,function(C,A,U,Pe,Se){return M+=t.slice(w,Se).replace(K,function(et){return"\\"+L[et]}),A&&(M+=`'+
((__t=(`+A+`))==null?'':_.escape(__t))+
'`),U&&(M+=`'+
((__t=(`+U+`))==null?'':__t)+
'`),Pe&&(M+=`';
`+Pe+`
__p+='`),w=Se+C.length,C}),M+=`';
`,f.variable||(M=`with(obj||{}){
`+M+`}
`),M=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+M+`return __p;
`;try{h=new Function(f.variable||"obj","_",M)}catch(C){throw C.source=M,C}if(r)return h(r,o);var N=function(C){return h.call(this,C,o)};return N.source="function("+(f.variable||"obj")+`){
`+M+"}",N},o.chain=function(t){return o(t).chain()};var z=function(t){return this._chain?o(t).chain():t};o.mixin(o),I(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var r=s[t];o.prototype[t]=function(){var f=this._wrapped;return r.apply(f,arguments),(t=="shift"||t=="splice")&&f.length===0&&delete f[0],z.call(this,f)}}),I(["concat","join","slice"],function(t){var r=s[t];o.prototype[t]=function(){return z.call(this,r.apply(this._wrapped,arguments))}}),o.extend(o.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),typeof define=="function"&&define.amd&&define("underscore",[],function(){return o})}).call(ce)});var Je=ae((fe,ye)=>{(function(){var s=this,c=qe().EventEmitter,i=Ge(),e=/([0-9\.]+)(ms|s|m|h)?/,s=globalThis||window;typeof Function.prototype.inherits>"u"&&(Function.prototype.inherits=function(p){this.prototype=Object.create(p.prototype)}),typeof Array.prototype.removeOne>"u"&&(Array.prototype.removeOne=function(){for(var p,n=arguments,u=n.length,a;u&&this.length;)for(p=n[--u];(a=this.indexOf(p))!==-1;)return this.splice(a,1)});function d(p){for(var n=1,u=i.min(p);n!==0;)n=i.reduce(p,function(a,l){return a+l%u},0),n!==0&&(u-=10);return u}function E(p){var n=e.exec(p);if(!n)throw new Error("I don't understand that particular interval");var u=+n[1],a=n[2]||"ms";if(a==="s")u=u*1e3;else if(a==="m")u=u*1e3*60;else if(a==="h")u=u*1e3*60*60;else if(a&&a!=="ms")throw new Error("You can only specify intervals of ms, s, m, or h");if(u<10||u%10!==0)throw new Error("You can only specify 10s of milliseconds, trust me on this one");return{amount:u,type:a}}function v(){this.intervalId=void 0,this.intervalLength=void 0,this.intervalsToEmit={},this.currentTick=1,this.maxTicks=0,this.listeningForFocus=!1;var p=function(){var n=d(i.keys(this.intervalsToEmit)),u=!1;return this.intervalLength?n!==this.intervalLength&&(this.intervalLength=n,u=!0):this.intervalLength=n,this.maxTicks=i.max(i.map(i.keys(this.intervalsToEmit),function(a){return+a}))/this.intervalLength,u}.bind(this);this.on("newListener",function(n){if(!(n==="removeListener"||n==="newListener")){var u=E(n),a=u.amount;this.intervalsToEmit[+a]=i.union(this.intervalsToEmit[+a]||[],[n]),p()&&this.isStarted()&&this.stop().start()}}),this.on("removeListener",function(n){if(!(c.listenerCount(this,n)>0)){var u=E(n),a=u.amount,l=this.intervalsToEmit[+a].removeOne(n);this.intervalsToEmit[+a].length===0&&delete this.intervalsToEmit[+a],console.log("Determining interval length after removal of",l),p(),p()&&this.isStarted()&&this.stop().start()}})}v.inherits(c),v.prototype.tick=function(){var p=this.currentTick*this.intervalLength;return i.each(this.intervalsToEmit,function(n,u){p%u===0&&i.each(n,function(a){this.emit(a,a,u)}.bind(this))}.bind(this)),this.currentTick+=1,this.currentTick>this.maxTicks&&(this.currentTick=1),this},v.prototype.start=function(){if(!this.intervalLength)throw new Error("You haven't specified any interval callbacks. Use EventedLoop.on('500ms', function () { ... }) to do so, and then you can start");return this.intervalId?console.log("No need to start the loop again, it's already started."):(this.intervalId=setInterval(this.tick.bind(this),this.intervalLength),s&&!this.listeningForFocus&&s.addEventListener&&(s.addEventListener("focus",function(){this.start()}.bind(this)),s.addEventListener("blur",function(){this.stop()}.bind(this)),this.listeningForFocus=!0),this)},v.prototype.stop=function(){return clearInterval(this.intervalId),this.intervalId=void 0,this},v.prototype.isStarted=function(){return!!this.intervalId},v.prototype.every=v.prototype.on,typeof fe<"u"&&(typeof ye<"u"&&ye.exports&&(fe=ye.exports=v),fe.EventedLoop=v),typeof window<"u"&&(window.EventedLoop=v)}).call(fe)});CanvasRenderingContext2D.prototype.storeLoadedImage=function(c,i){this.images||(this.images={}),this.images[c]=i};CanvasRenderingContext2D.prototype.getLoadedImage=function(c){if(this.images[c])return this.images[c]};CanvasRenderingContext2D.prototype.followSprite=function(c){this.centralSprite=c};CanvasRenderingContext2D.prototype.getCentralPosition=function(){return{map:this.centralSprite.mapPosition,canvas:[Math.round(this.canvas.width*.5),Math.round(this.canvas.height*.5),0]}};CanvasRenderingContext2D.prototype.mapPositionToCanvasPosition=function(c){var i=this.getCentralPosition(),e=i.map,s=i.canvas,d=e[0]-c[0],E=e[1]-c[1];return[s[0]-d,s[1]-E]};CanvasRenderingContext2D.prototype.canvasPositionToMapPosition=function(c){var i=this.getCentralPosition(),e=i.map,s=i.canvas,d=s[0]-c[0],E=s[1]-c[1];return[e[0]-d,e[1]-E]};CanvasRenderingContext2D.prototype.getCentreOfViewport=function(){return(this.canvas.width/2).floor()};CanvasRenderingContext2D.prototype.getMiddleOfViewport=function(){return(this.canvas.height/2).floor()};CanvasRenderingContext2D.prototype.getBelowViewport=function(){return this.canvas.height.floor()};CanvasRenderingContext2D.prototype.getMapBelowViewport=function(){var c=this.getBelowViewport();return this.canvasPositionToMapPosition([0,c])[1]};CanvasRenderingContext2D.prototype.getRandomlyInTheCentreOfCanvas=function(c){var i=0,e=this.canvas.width;return c&&(i-=c,e+=c),Number.random(i,e)};CanvasRenderingContext2D.prototype.getRandomlyInTheCentreOfMap=function(c){var i=this.getRandomlyInTheCentreOfCanvas(c);return this.canvasPositionToMapPosition([i,0])[0]};CanvasRenderingContext2D.prototype.getRandomMapPositionBelowViewport=function(){var c=this.getRandomlyInTheCentreOfCanvas(),i=this.getBelowViewport();return this.canvasPositionToMapPosition([c,i])};CanvasRenderingContext2D.prototype.getRandomMapPositionAboveViewport=function(){var c=this.getRandomlyInTheCentreOfCanvas(),i=this.getAboveViewport();return this.canvasPositionToMapPosition([c,i])};CanvasRenderingContext2D.prototype.getTopOfViewport=function(){return this.canvasPositionToMapPosition([0,0])[1]};CanvasRenderingContext2D.prototype.getAboveViewport=function(){return 0-(this.canvas.height/4).floor()};Function.prototype.method=function(c,i){return Object.defineProperty(this.prototype,c,{value:i,enumerable:!1,writable:!0,configurable:!0}),this};Object.method("superior",function(c){var i=this,e=i[c];return function(){return e.apply(i,arguments)}});(function(){for(var c,i=function(){},e=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],s=e.length,d=window.console=window.console||{};s--;)c=e[s],d[c]||(d[c]=i)})();var Qe=we(xe(),1),J=we(Ce(),1);function at(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}var be=at;function ue(){return this.pushHandlers=[],this}ue.prototype=Object.create(Array.prototype);ue.prototype.onPush=function(c,i){this.pushHandlers.push(c),i&&this.each(c)};ue.prototype.push=function(c){Array.prototype.push.call(this,c),this.pushHandlers.each(function(i){i(c)})};ue.prototype.cull=function(){this.each(function(c,i){if(c.deleted)return delete this[i]})};var re=ue;function ut(){var c=function(){return Math.floor(Math.random()*65536).toString(16)};return c()+c()+"-"+c()+"-"+c()+"-"+c()+"-"+c()+c()+c()}var Ne=ut;function _e(c){var i={},e=[0],s=this,d;s.direction=void 0,s.mapPosition=[0,0,0],s.id=Ne(),s.canvasX=0,s.canvasY=0,s.canvasZ=0,s.height=0,s.speed=0,s.data=c||{parts:{}},s.movingToward=[0,0],s.metresDownTheMountain=0,s.movingWithConviction=!1,s.deleted=!1,s.data.parts||(s.data.parts={}),s.maxHeight=(function(){return Object.values(s.data.parts).map(function(a){return a[3]}).max()})(),s.isMoving=!0,c&&c.id&&(s.id=c.id),c&&c.zIndexesOccupied&&(e=c.zIndexesOccupied);function E(a){s.canvasX+=a.toNumber()}function v(a){s.canvasY+=a.toNumber()}function p(a){if(s.data.hitBoxes&&c.hitBoxes[a])return c.hitBoxes[a]}function n(a){return a=Math.round(a*2)/2,a}function u(){if(s.isMoving){var a=s.mapPosition[0],l=s.mapPosition[1];if(typeof s.direction<"u"){var y=s.direction-90;y<0&&(y=360+y),a+=n(s.speed*Math.cos(y*(Math.PI/180))),l+=n(s.speed*Math.sin(y*(Math.PI/180)))}else typeof s.movingToward[0]<"u"&&(a>s.movingToward[0]?a-=Math.min(s.getSpeedX(),Math.abs(a-s.movingToward[0])):a<s.movingToward[0]&&(a+=Math.min(s.getSpeedX(),Math.abs(a-s.movingToward[0])))),typeof s.movingToward[1]<"u"&&(l>s.movingToward[1]?l-=Math.min(s.getSpeedY(),Math.abs(l-s.movingToward[1])):l<s.movingToward[1]&&(l+=Math.min(s.getSpeedY(),Math.abs(l-s.movingToward[1]))));s.setMapPosition(a,l)}}return this.draw=function(a,l){var y=s.data.parts[l];s.height=y[3],s.width=y[2];var b=a.mapPositionToCanvasPosition(s.mapPosition);s.setCanvasPosition(b[0],b[1]),a.drawImage(a.getLoadedImage(s.data.$imageFile),y[0],y[1],y[2],y[3],s.canvasX,s.canvasY,y[2],y[3])},this.setMapPosition=function(a,l,y){typeof a>"u"&&(a=s.mapPosition[0]),typeof l>"u"&&(l=s.mapPosition[1]),typeof y>"u"?y=s.mapPosition[2]:s.zIndexesOccupied=[y],s.mapPosition=[a,l,y]},this.setCanvasPosition=function(a,l){a&&(Object.isString(a)&&(a.first()==="+"||a.first()==="-")?E(a):s.canvasX=a),l&&(Object.isString(l)&&(l.first()==="+"||l.first()==="-")?v(l):s.canvasY=l)},this.getCanvasPositionX=function(){return s.canvasX},this.getCanvasPositionY=function(){return s.canvasY},this.getLeftHitBoxEdge=function(a){a=a||0;var l=this.getCanvasPositionX();return p(a)&&(l+=p(a)[0]),l},this.getTopHitBoxEdge=function(a){a=a||0;var l=this.getCanvasPositionY();return p(a)&&(l+=p(a)[1]),l},this.getRightHitBoxEdge=function(a){return a=a||0,p(a)?s.canvasX+p(a)[2]:s.canvasX+s.width},this.getBottomHitBoxEdge=function(a){return a=a||0,p(a)?s.canvasY+p(a)[3]:s.canvasY+s.height},this.getPositionInFrontOf=function(){return[s.canvasX,s.canvasY+s.height]},this.setSpeed=function(a){s.speed=a,s.speedX=a,s.speedY=a},this.incrementSpeedBy=function(a){s.speed+=a},s.getSpeed=function(){return s.speed},s.getSpeedX=function(){return s.speed},s.getSpeedY=function(){return s.speed},this.setHeight=function(a){s.height=a},this.setWidth=function(a){s.width=a},this.getMaxHeight=function(){return s.maxHeight},s.getMovingTowardOpposite=function(){if(!s.isMoving)return[0,0];var a=s.movingToward[0]-s.mapPosition[0],l=s.movingToward[1]-s.mapPosition[1],y=Math.abs(a)>75?0-a:0,b=-l;return[y,b]},this.checkHittableObjects=function(){Object.keys(i,function(a,l){l.object.deleted?delete i[a]:l.object.hits(s)&&l.callbacks.each(function(y){y(s,l.object)})})},this.cycle=function(){s.checkHittableObjects(),d&&s.setMapPositionTarget(d.mapPosition[0],d.mapPosition[1],!0),u()},this.setMapPositionTarget=function(a,l,y){y&&(s.movingWithConviction=!1),s.movingWithConviction||(typeof a>"u"&&(a=s.movingToward[0]),typeof l>"u"&&(l=s.movingToward[1]),s.movingToward=[a,l],s.movingWithConviction=!1)},this.setDirection=function(a){a>=360&&(a=360-a),s.direction=a,s.movingToward=void 0},this.resetDirection=function(){s.direction=void 0},this.setMapPositionTargetWithConviction=function(a,l){s.setMapPositionTarget(a,l),s.movingWithConviction=!0},this.follow=function(a){d=a},this.stopFollowing=function(){d=!1},this.onHitting=function(a,l){if(i[a.id])return i[a.id].callbacks.push(l);i[a.id]={object:a,callbacks:[l]}},this.deleteOnNextCycle=function(){s.deleted=!0},this.occupiesZIndex=function(a){return e.indexOf(a)>=0},this.hits=function(a){var l=!1,y=!1;return a.getTopHitBoxEdge(s.mapPosition[2])<=s.getBottomHitBoxEdge(s.mapPosition[2])&&a.getBottomHitBoxEdge(s.mapPosition[2])>=s.getBottomHitBoxEdge(s.mapPosition[2])&&(l=!0),a.getTopHitBoxEdge(s.mapPosition[2])<=s.getTopHitBoxEdge(s.mapPosition[2])&&a.getBottomHitBoxEdge(s.mapPosition[2])>=s.getTopHitBoxEdge(s.mapPosition[2])&&(l=!0),a.getLeftHitBoxEdge(s.mapPosition[2])<=s.getRightHitBoxEdge(s.mapPosition[2])&&a.getRightHitBoxEdge(s.mapPosition[2])>=s.getRightHitBoxEdge(s.mapPosition[2])&&(y=!0),a.getLeftHitBoxEdge(s.mapPosition[2])<=s.getLeftHitBoxEdge(s.mapPosition[2])&&a.getRightHitBoxEdge(s.mapPosition[2])>=s.getLeftHitBoxEdge(s.mapPosition[2])&&(y=!0),l&&y},this.isAboveOnCanvas=function(a){return s.canvasY+s.height<a},this.isBelowOnCanvas=function(a){return s.canvasY>a},s}_e.createObjects=function(i,e){Array.isArray(i)||(i=[i]),e=Object.merge(e,{rateModifier:0,dropRate:1,position:[0,0]},!1,!1);function s(E){var v=e.position;if(Number.random(100+e.rateModifier)<=E.dropRate){var p=new _e(E.sprite);return p.setSpeed(0),Object.isFunction(v)&&(v=v()),p.setMapPosition(v[0],v[1]),E.sprite.hitBehaviour&&E.sprite.hitBehaviour.skier&&e.player&&p.onHitting(e.player,E.sprite.hitBehaviour.skier),p}}var d=i.map(s).remove(void 0);return d};var Z=_e;function ct(c){var i=new Z(c),e=i.superior("draw"),s=1,d=0,E=6;i.isEating=!1,i.isFull=!1,i.setSpeed(E),i.draw=function(p){var n=function(){var u=i.movingToward[0]-i.canvasX;if(i.isEating)return"eating"+d;if(s+.1>2?s=.1:s+=.1,u>=0)return"sEast"+Math.ceil(s);if(u<0)return"sWest"+Math.ceil(s)};return e(p,n())};function v(p){d+=1,i.isEating=!0,i.isMoving=!1,d<6?setTimeout(function(){v(p)},300):(d=0,i.isEating=!1,i.isMoving=!0,p())}return i.startEating=v,i}var De=ct;function ft(c){var i=new Z(c),e={draw:i.superior("draw"),cycle:i.superior("cycle")},s={sEast:function(v){return v>0},sWest:function(v){return v<=0}},d=3;i.setSpeed(d);function E(){var v=i.movingToward[0]-i.mapPosition[0],p=i.movingToward[1]-i.mapPosition[1];return s.sEast(v)?"sEast":"sWest"}return i.cycle=function(v){Number.random(10)===1&&(i.setMapPositionTarget(v.getRandomlyInTheCentreOfMap()),i.setSpeed(d+Number.random(-1,1))),i.setMapPositionTarget(void 0,v.getMapBelowViewport()+600),e.cycle()},i.draw=function(v){var p=function(){return E()};return e.draw(v,p())},i}var Re=ft;typeof navigator<"u"?navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate:globalThis.navigator={vibrate:!1};function lt(c){var i={west:270,wsWest:240,sWest:195,south:180,sEast:165,esEast:120,east:90},e=new Z(c),s={draw:e.superior("draw"),cycle:e.superior("cycle"),getSpeedX:e.superior("getSpeedX"),getSpeedY:e.superior("getSpeedY"),hits:e.superior("hits")},d={esEast:function(T){return T>300},sEast:function(T){return T>75},wsWest:function(T){return T<-300},sWest:function(T){return T<-75}},E,v,p=!0,n=[],u=0,a=5,l=2,y=70,b=0,P=0,S=0,x=1,F=0;e.isMoving=!0,e.hasBeenHit=!1,e.isJumping=!1,e.isPerformingTrick=!1,e.onHitObstacleCb=function(){},e.setSpeed(a),e.reset=function(){n=[],u=0,e.isMoving=!0,e.hasBeenHit=!1,p=!0,X()};function X(){e.setSpeed(a),e.isMoving=!0,e.hasBeenHit=!1,e.isJumping=!1,e.isPerformingTrick=!1,v&&clearInterval(v),e.setMapPosition(void 0,void 0,0)}function ne(){e.isMoving=!1,e.hasBeenHit=!0,e.isJumping=!1,e.isPerformingTrick=!1,v&&clearInterval(v),e.setMapPosition(void 0,void 0,0)}function ee(){var T=e.getSpeed();e.setSpeed(T+2),e.setSpeedY(T+2),e.isMoving=!0,e.hasBeenHit=!1,e.isJumping=!0,e.setMapPosition(void 0,void 0,1)}function H(){if(e.direction)return e.direction<=90?"east":e.direction>90&&e.direction<150?"esEast":e.direction>=150&&e.direction<180?"sEast":e.direction===180?"south":e.direction>180&&e.direction<=210?"sWest":e.direction>210&&e.direction<270?"wsWest":e.direction>=270?"west":"south";var T=e.movingToward[0]-e.mapPosition[0],V=e.movingToward[1]-e.mapPosition[1];return V<=0?T>0?"east":"west":d.esEast(T)?"esEast":d.sEast(T)?"sEast":d.wsWest(T)?"wsWest":d.sWest(T)?"sWest":"south"}function B(T){i[T]&&e.setDirection(i[T]),T==="west"||T==="east"?e.isMoving=!1:e.isMoving=!0}function o(){return"blank"}function I(){return"jumping"}function ie(){return console.log("Trick step is",F),F===0?"jumping":F===1?"somersault1":"somersault2"}e.stop=function(){e.direction>180?B("west"):B("east")},e.turnEast=function(){var T=H();switch(T){case"west":B("wsWest");break;case"wsWest":B("sWest");break;case"sWest":B("south");break;case"south":B("sEast");break;case"sEast":B("esEast");break;case"esEast":B("east");break;default:B("south");break}},e.turnWest=function(){var T=H();switch(T){case"east":B("esEast");break;case"esEast":B("sEast");break;case"sEast":B("south");break;case"south":B("sWest");break;case"sWest":B("wsWest");break;case"wsWest":B("west");break;default:B("south");break}},e.stepWest=function(){e.mapPosition[0]-=e.speed*2},e.stepEast=function(){e.mapPosition[0]+=e.speed*2},e.setMapPositionTarget=function(T,V){e.hasBeenHit||(Math.abs(e.mapPosition[0]-T)<=75&&(T=e.mapPosition[0]),e.movingToward=[T,V])},e.startMovingIfPossible=function(){!e.hasBeenHit&&!e.isBeingEaten&&(e.isMoving=!0)},e.setTurnEaseCycles=function(T){y=T},e.getPixelsTravelledDownMountain=function(){return u},e.resetSpeed=function(){e.setSpeed(a)},e.cycle=function(){e.getSpeedX()<=0&&e.getSpeedY()<=0&&(e.isMoving=!1),e.isMoving&&(u+=e.speed),e.isJumping&&e.setMapPositionTarget(void 0,e.mapPosition[1]+e.getSpeed()),s.cycle(),e.checkHittableObjects()},e.draw=function(T){var V=function(){return e.isBeingEaten?o():e.isJumping?e.isPerformingTrick?ie():I():e.hasBeenHit?"hit":H()};return s.draw(T,V())},e.hits=function(T){return n.indexOf(T.id)!==-1||!T.occupiesZIndex(e.mapPosition[2])?!1:!!s.hits(T)},e.speedBoost=function(){var T=e.speed;p&&(p=!1,e.setSpeed(e.speed*l),setTimeout(function(){e.setSpeed(T),setTimeout(function(){p=!0},1e4)},2e3))},e.attemptTrick=function(){e.isJumping&&(e.isPerformingTrick=!0,v=setInterval(function(){F>=2?F=0:F+=1},300))},e.getStandardSpeed=function(){return a};function W(T,V,m){return m===0||m===1?V:(T<V&&(T+=e.getSpeed()*(m/y)),T>V&&(T-=e.getSpeed()*(m/y)),T)}return e.getSpeedX=function(){return H()==="esEast"||H()==="wsWest"?(P=.5,b=W(b,e.getSpeed()*P,P),b):H()==="sEast"||H()==="sWest"?(P=.33,b=W(b,e.getSpeed()*P,P),b):(b=W(b,0,P),b)},e.setSpeedY=function(T){S=T},e.getSpeedY=function(){var T;return e.isJumping?S:H()==="esEast"||H()==="wsWest"?(x=.6,S=W(S,e.getSpeed()*.6,.6),S):H()==="sEast"||H()==="sWest"?(x=.85,S=W(S,e.getSpeed()*.85,.85),S):H()==="east"||H()==="west"?(x=1,S=0,S):(S=W(S,e.getSpeed(),x),S)},e.hasHitObstacle=function(T){ne(),navigator.vibrate&&navigator.vibrate(500),n.push(T.id),e.resetSpeed(),e.onHitObstacleCb(T),E&&clearTimeout(E),E=setTimeout(function(){X()},1500)},e.hasHitJump=function(){ee(),E&&clearTimeout(E),E=setTimeout(function(){X()},1e3)},e.isEatenBy=function(T,V){e.hasHitObstacle(T),T.startEating(V),n.push(T.id),e.isMoving=!1,e.isBeingEaten=!0},e.reset=function(){n=[],u=0,e.isMoving=!0,e.isJumping=!1,e.hasBeenHit=!1,p=!0},e.setHitObstacleCb=function(T){e.onHitObstacleCb=T||function(){}},e}var Ie=lt;function ht(c){var i=this;return i.lines=c.initialLines,i.top=c.position.top,i.right=c.position.right,i.bottom=c.position.bottom,i.left=c.position.left,i.width=c.width,i.height=c.height,i.setLines=function(e){i.lines=e},i.draw=function(e){e.font="11px monospace";var s=0;i.lines.each(function(d){var E=+e.font.slice(0,2),v=e.measureText(d).width,p=E*1.5,n,u;i.top?u=i.top+s:i.bottom&&(u=e.canvas.height-i.top-p+s),i.right?n=e.canvas.width-i.right-v:i.left&&(n=i.left),s+=p,e.fillText(d,n,u)})},i}var ke=ht;var Ke=we(Je(),1);function yt(c,i){var e=new re,s=new re,d=new re,E=c.getContext("2d"),v=E.getCentreOfViewport(),p=0,n=!1,u=this,a=[],l=[],y=new Ke.default;this.addStaticObject=function(P){e.push(P)},this.addStaticObjects=function(P){P.forEach(this.addStaticObject.bind(this))},this.addMovingObject=function(P,S){S&&e.onPush(function(x){x.data&&x.data.hitBehaviour[S]&&x.onHitting(P,x.data.hitBehaviour[S])},!0),s.push(P)},this.addUIElement=function(P){d.push(P)},this.beforeCycle=function(P){a.push(P)},this.afterCycle=function(P){l.push(P)},this.setMouseX=function(P){v=P},this.setMouseY=function(P){p=P},i.setMapPosition(0,0),i.setMapPositionTarget(0,-10),E.followSprite(i);var b=0;this.cycle=function(){a.each(function(S){S()});var P=E.canvasPositionToMapPosition([v,p]);i.isJumping||i.setMapPositionTarget(P[0],P[1]),b++,i.cycle(),s.each(function(S,x){S.cycle(E)}),e.cull(),e.each(function(S,x){S.cycle&&S.cycle()}),d.each(function(S,x){S.cycle&&S.cycle()}),l.each(function(S){S()})},u.draw=function(){c.width=c.width,i.draw(E),i.cycle(),s.each(function(P,S){P.draw(E)}),e.each(function(P,S){P.draw&&P.draw(E,"main")}),d.each(function(P,S){P.draw&&P.draw(E,"main")})},this.start=function(){y.start()},this.pause=function(){n=!0,y.stop()},this.isPaused=function(){return n},this.reset=function(){n=!1,e=new re,s=new re,v=E.getCentreOfViewport(),p=0,i.reset(),i.setMapPosition(0,0,0),this.start()}.bind(this),y.on("20",this.cycle),y.on("20",this.draw)}var $e=yt;var Q={skier:{$imageFile:"sprite-characters.png",parts:{blank:[0,0,0,0],east:[0,0,24,34],esEast:[24,0,24,34],sEast:[49,0,17,34],south:[65,0,17,34],sWest:[49,37,17,34],wsWest:[24,37,24,34],west:[0,37,24,34],hit:[0,78,31,31],jumping:[84,0,32,34],somersault1:[116,0,32,34],somersault2:[148,0,32,34]},hitBoxes:{0:[7,20,27,34]},id:"player",hitBehaviour:{}},smallTree:{$imageFile:"skifree-objects.png",parts:{main:[0,28,30,34]},hitBoxes:{0:[0,18,30,34]},hitBehaviour:{}},tallTree:{$imageFile:"skifree-objects.png",parts:{main:[95,66,32,64]},zIndexesOccupied:[0,1],hitBoxes:{0:[0,54,32,64],1:[0,10,32,54]},hitBehaviour:{}},thickSnow:{$imageFile:"skifree-objects.png",parts:{main:[143,53,43,10]},hitBehaviour:{}},rock:{$imageFile:"skifree-objects.png",parts:{main:[30,52,23,11]},hitBehaviour:{}},monster:{$imageFile:"sprite-characters.png",parts:{sEast1:[64,112,26,43],sEast2:[90,112,32,43],sWest1:[64,158,26,43],sWest2:[90,158,32,43],eating1:[122,112,34,43],eating2:[156,112,31,43],eating3:[187,112,31,43],eating4:[219,112,25,43],eating5:[243,112,26,43]},hitBehaviour:{}},jump:{$imageFile:"skifree-objects.png",parts:{main:[109,55,32,8]},hitBehaviour:{}},signStart:{$imageFile:"skifree-objects.png",parts:{main:[260,103,42,27]},hitBehaviour:{}},snowboarder:{$imageFile:"sprite-characters.png",parts:{sEast:[73,229,20,29],sWest:[95,228,26,30]},hitBehaviour:{}},emptyChairLift:{$imageFile:"skifree-objects.png",parts:{main:[92,136,26,30]},zIndexesOccupied:[1]}};function wt(c){c.deleteOnNextCycle()}Q.monster.hitBehaviour.tree=wt;function ze(c,i){i.deleteOnNextCycle()}Q.smallTree.hitBehaviour.monster=ze;Q.tallTree.hitBehaviour.monster=ze;function Ze(c,i){i.hasHitObstacle(c)}Q.smallTree.hitBehaviour.skier=Ze;Q.tallTree.hitBehaviour.skier=Ze;function _t(c,i){i.hasHitObstacle(c)}Q.rock.hitBehaviour.skier=_t;function Tt(c,i){i.hasHitJump(c)}Q.jump.hitBehaviour.skier=Tt;function Mt(c,i){i.hasHitObstacle(c)}Q.snowboarder.hitBehaviour.skier=Mt;var q=Q;var j=document.getElementById("skifree-canvas"),te=j.getContext("2d"),Pt=["sprite-characters.png","skifree-objects.png"],Me="Use the mouse or WASD to control the player";be()&&(Me="Tap or drag on the piste to control the player");var St=18,le=0,Ot=2e3,oe=5,pe=0,xt=!1,he={smallTree:4,tallTree:2,jump:1,thickSnow:1,rock:1};localStorage.getItem("highScore")&&(pe=localStorage.getItem("highScore"));function Ct(c,i){var e=0,s={};function d(){e+=1,e===c.length&&i(s)}c.each(function(E){var v=new Image;v.onload=d,v.src=E,te.storeLoadedImage(E,v)})}function bt(c,i){i.isEatenBy(c,function(){oe-=1,c.isFull=!0,c.isEating=!1,i.isBeingEaten=!1,c.setSpeed(i.getSpeed()),c.stopFollowing();var e=te.getRandomMapPositionAboveViewport();c.setMapPositionTarget(e[0],e[1])})}function Nt(c){var i,e,s,d;function E(){le=0,oe=5,pe=localStorage.getItem("highScore"),d.reset(),d.addStaticObject(e)}function v(){d.isPaused()||(pe=localStorage.setItem("highScore",le),s.setLines(["Game over!","Hit space to restart"]),d.pause(),d.cycle())}function p(l,y){var b=Math.max(800-j.width,0);Number.random(1e3+b)<=y&&l()}function n(){var l=new De(q.monster),y=te.getRandomMapPositionAboveViewport();l.setMapPosition(y[0],y[1]),l.follow(i),l.setSpeed(i.getStandardSpeed()),l.onHitting(i,bt),d.addMovingObject(l,"monster")}function u(){var l=new Re(q.snowboarder),y=te.getRandomMapPositionAboveViewport(),b=te.getRandomMapPositionBelowViewport();l.setMapPosition(y[0],y[1]),l.setMapPositionTarget(b[0],b[1]),l.onHitting(i,q.snowboarder.hitBehaviour.skier),d.addMovingObject(l)}i=new Ie(q.skier),i.setMapPosition(0,0),i.setMapPositionTarget(0,-10),xt&&i.setHitObstacleCb(function(){oe-=1}),d=new $e(j,i),e=new Z(q.signStart),d.addStaticObject(e),e.setMapPosition(-50,0),te.followSprite(i),s=new ke({initialLines:["SkiFree.js",Me,"Travelled 0m","High Score: "+pe,"Skiers left: "+oe,"Created by Dan Hough (@basicallydan)"],position:{top:15,right:10}}),d.beforeCycle(function(){var l=[];i.isMoving&&(l=Z.createObjects([{sprite:q.smallTree,dropRate:he.smallTree},{sprite:q.tallTree,dropRate:he.tallTree},{sprite:q.jump,dropRate:he.jump},{sprite:q.thickSnow,dropRate:he.thickSnow},{sprite:q.rock,dropRate:he.rock}],{rateModifier:Math.max(800-j.width,0),position:function(){return te.getRandomMapPositionBelowViewport()},player:i})),d.isPaused()||(d.addStaticObjects(l),p(u,.1),le=parseFloat(i.getPixelsTravelledDownMountain()/St).toFixed(1),le>Ot&&p(n,.001),s.setLines(["SkiFree.js",Me,"Travelled "+le+"m","Skiers left: "+oe,"High Score: "+pe,"Created by Dan Hough (@basicallydan)","Current Speed: "+i.getSpeed()]))}),d.afterCycle(function(){oe===0&&v()}),d.addUIElement(s),$(j).mousemove(function(l){d.setMouseX(l.pageX),d.setMouseY(l.pageY),i.resetDirection(),i.startMovingIfPossible()}).bind("click",function(l){d.setMouseX(l.pageX),d.setMouseY(l.pageY),i.resetDirection(),i.startMovingIfPossible()}).focus(),J.default.bind("f",i.speedBoost),J.default.bind("t",i.attemptTrick),J.default.bind(["w","up"],function(){i.stop()}),J.default.bind(["a","left"],function(){i.direction===270?i.stepWest():i.turnWest()}),J.default.bind(["s","down"],function(){i.setDirection(180),i.startMovingIfPossible()}),J.default.bind(["d","right"],function(){i.direction===90?i.stepEast():i.turnEast()}),J.default.bind("m",n),J.default.bind("b",u),J.default.bind("space",E);var a=(0,Qe.default)(j).on("press",function(l){l.preventDefault(),d.setMouseX(l.gesture.center.x),d.setMouseY(l.gesture.center.y)}).on("tap",function(l){d.setMouseX(l.gesture.center.x),d.setMouseY(l.gesture.center.y)}).on("pan",function(l){d.setMouseX(l.gesture.center.x),d.setMouseY(l.gesture.center.y),i.resetDirection(),i.startMovingIfPossible()}).on("doubletap",function(l){i.speedBoost()});i.isMoving=!1,i.setDirection(270),d.start()}function je(){j.width=window.innerWidth,j.height=window.innerHeight}window.addEventListener("resize",je,!1);je();Ct(Pt,Nt);})();
/*! Bundled license information:

hammerjs/hammer.js:
  (*! Hammer.JS - v1.0.7dev - 2014-02-18
   * http://eightmedia.github.com/hammer.js
   *
   * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
   * Licensed under the MIT license *)
*/

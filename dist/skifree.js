(()=>{var Nt=Object.create;var st=Object.defineProperty;var Rt=Object.getOwnPropertyDescriptor;var yt=Object.getOwnPropertyNames;var It=Object.getPrototypeOf,xt=Object.prototype.hasOwnProperty;var rt=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports);var Bt=(n,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let u of yt(t))!xt.call(n,u)&&u!==e&&st(n,u,{get:()=>t[u],enumerable:!(r=Rt(t,u))||r.enumerable});return n};var nt=(n,t,e)=>(e=n!=null?Nt(It(n)):{},Bt(t||!n||!n.__esModule?st(e,"default",{value:n,enumerable:!0}):e,n));var at=rt((he,X)=>{(function(n,t){"use strict";var e=function(h,i){return new e.Instance(h,i||{})};e.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},e.HAS_POINTEREVENTS=n.navigator.pointerEnabled||n.navigator.msPointerEnabled,e.HAS_TOUCHEVENTS="ontouchstart"in n,e.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,e.NO_MOUSEEVENTS=e.HAS_TOUCHEVENTS&&n.navigator.userAgent.match(e.MOBILE_REGEX),e.EVENT_TYPES={},e.DIRECTION_DOWN="down",e.DIRECTION_LEFT="left",e.DIRECTION_UP="up",e.DIRECTION_RIGHT="right",e.POINTER_MOUSE="mouse",e.POINTER_TOUCH="touch",e.POINTER_PEN="pen",e.UPDATE_VELOCITY_INTERVAL=20,e.EVENT_START="start",e.EVENT_MOVE="move",e.EVENT_END="end",e.DOCUMENT=n.document,e.plugins=e.plugins||{},e.gestures=e.gestures||{},e.READY=!1;function r(){e.READY||(e.event.determineEventTypes(),e.utils.each(e.gestures,function(h){e.detection.register(h)}),e.event.onTouch(e.DOCUMENT,e.EVENT_MOVE,e.detection.detect),e.event.onTouch(e.DOCUMENT,e.EVENT_END,e.detection.detect),e.READY=!0)}e.utils={extend:function(i,s,a){for(var c in s)i[c]!==t&&a||(i[c]=s[c]);return i},each:function(h,i,s){var a,c;if("forEach"in h)h.forEach(i,s);else if(h.length!==t){for(a=0,c=h.length;a<c;a++)if(i.call(s,h[a],a,h)===!1)return}else for(a in h)if(h.hasOwnProperty(a)&&i.call(s,h[a],a,h)===!1)return},hasParent:function(h,i){for(;h;){if(h==i)return!0;h=h.parentNode}return!1},getCenter:function(i){var s=[],a=[];return e.utils.each(i,function(c){s.push(typeof c.clientX<"u"?c.clientX:c.pageX),a.push(typeof c.clientY<"u"?c.clientY:c.pageY)}),{pageX:(Math.min.apply(Math,s)+Math.max.apply(Math,s))/2,pageY:(Math.min.apply(Math,a)+Math.max.apply(Math,a))/2}},getVelocity:function(i,s,a){return{x:Math.abs(s/i)||0,y:Math.abs(a/i)||0}},getAngle:function(i,s){var a=s.pageY-i.pageY,c=s.pageX-i.pageX;return Math.atan2(a,c)*180/Math.PI},getDirection:function(i,s){var a=Math.abs(i.pageX-s.pageX),c=Math.abs(i.pageY-s.pageY);return a>=c?i.pageX-s.pageX>0?e.DIRECTION_LEFT:e.DIRECTION_RIGHT:i.pageY-s.pageY>0?e.DIRECTION_UP:e.DIRECTION_DOWN},getDistance:function(i,s){var a=s.pageX-i.pageX,c=s.pageY-i.pageY;return Math.sqrt(a*a+c*c)},getScale:function(i,s){return i.length>=2&&s.length>=2?this.getDistance(s[0],s[1])/this.getDistance(i[0],i[1]):1},getRotation:function(i,s){return i.length>=2&&s.length>=2?this.getAngle(s[1],s[0])-this.getAngle(i[1],i[0]):0},isVertical:function(i){return i==e.DIRECTION_UP||i==e.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(i,s){!s||!i||!i.style||(e.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(a){e.utils.each(s,function(c,g){a&&(g=a+g.substring(0,1).toUpperCase()+g.substring(1)),g in i.style&&(i.style[g]=c)})}),s.userSelect=="none"&&(i.onselectstart=function(){return!1}),s.userDrag=="none"&&(i.ondragstart=function(){return!1}))},startDefaultBrowserBehavior:function(i,s){!s||!i||!i.style||(e.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(a){e.utils.each(s,function(c,g){a&&(g=a+g.substring(0,1).toUpperCase()+g.substring(1)),g in i.style&&(i.style[g]="")})}),s.userSelect=="none"&&(i.onselectstart=null),s.userDrag=="none"&&(i.ondragstart=null))}},e.Instance=function(h,i){var s=this;return r(),this.element=h,this.enabled=!0,this.options=e.utils.extend(e.utils.extend({},e.defaults),i||{}),this.options.stop_browser_behavior&&e.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),this._eventStartHandler=e.event.onTouch(h,e.EVENT_START,function(a){s.enabled&&e.detection.startDetect(s,a)}),this._eventHandler=[],this},e.Instance.prototype={on:function(i,s){var a=i.split(" ");return e.utils.each(a,function(c){this.element.addEventListener(c,s,!1),this._eventHandler.push({gesture:c,handler:s})},this),this},off:function(i,s){var a=i.split(" ");return e.utils.each(a,function(c){this.element.removeEventListener(c,s,!1);var g=-1;e.utils.each(this._eventHandler,function(P,T){g===-1&&P.gesture===c&&P.handler===s&&(g=T)},this),g>-1&&this._eventHandler.splice(g,1)},this),this},trigger:function(i,s){s||(s={});var a=e.DOCUMENT.createEvent("Event");a.initEvent(i,!0,!0),a.gesture=s;var c=this.element;return e.utils.hasParent(s.target,c)&&(c=s.target),c.dispatchEvent(a),this},enable:function(i){return this.enabled=i,this},dispose:function(){return this.options.stop_browser_behavior&&e.utils.startDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),e.utils.each(this._eventHandler,function(i){this.element.removeEventListener(i.gesture,i.handler,!1)},this),this._eventHandler.length=0,e.event.unbindDom(this.element,e.EVENT_TYPES[e.EVENT_START],this._eventStartHandler),this}};var u=null,d=!1,p=!1;e.event={bindDom:function(h,i,s){var a=i.split(" ");e.utils.each(a,function(c){h.addEventListener(c,s,!1)})},unbindDom:function(h,i,s){var a=i.split(" ");e.utils.each(a,function(c){h.removeEventListener(c,s,!1)})},onTouch:function(i,s,a){var c=this,g=function(T){var S=T.type.toLowerCase();if(!(S.match(/mouse/)&&p)){S.match(/touch/)||S.match(/pointerdown/)||S.match(/mouse/)&&T.which===1?d=!0:S.match(/mouse/)&&!T.which&&(d=!1),S.match(/touch|pointer/)&&(p=!0);var E=0;d&&(e.HAS_POINTEREVENTS&&s!=e.EVENT_END?E=e.PointerEvent.updatePointer(s,T):S.match(/touch/)?E=T.touches.length:p||(E=S.match(/up/)?0:1),E>0&&s==e.EVENT_END?s=e.EVENT_MOVE:E||(s=e.EVENT_END),(E||u===null)&&(u=T),a.call(e.detection,c.collectEventData(i,s,c.getTouchList(u,s),T)),e.HAS_POINTEREVENTS&&s==e.EVENT_END&&(E=e.PointerEvent.updatePointer(s,T))),E||(u=null,d=!1,p=!1,e.PointerEvent.reset())}};return this.bindDom(i,e.EVENT_TYPES[s],g),g},determineEventTypes:function(){var i;e.HAS_POINTEREVENTS?i=e.PointerEvent.getEvents():e.NO_MOUSEEVENTS?i=["touchstart","touchmove","touchend touchcancel"]:i=["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],e.EVENT_TYPES[e.EVENT_START]=i[0],e.EVENT_TYPES[e.EVENT_MOVE]=i[1],e.EVENT_TYPES[e.EVENT_END]=i[2]},getTouchList:function(i){return e.HAS_POINTEREVENTS?e.PointerEvent.getTouchList():i.touches?i.touches:(i.identifier=1,[i])},collectEventData:function(i,s,a,c){var g=e.POINTER_TOUCH;return(c.type.match(/mouse/)||e.PointerEvent.matchType(e.POINTER_MOUSE,c))&&(g=e.POINTER_MOUSE),{center:e.utils.getCenter(a),timeStamp:new Date().getTime(),target:c.target,touches:a,eventType:s,pointerType:g,srcEvent:c,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return e.detection.stopDetect()}}}},e.PointerEvent={pointers:{},getTouchList:function(){var h=this,i=[];return e.utils.each(h.pointers,function(s){i.push(s)}),i},updatePointer:function(h,i){return h==e.EVENT_END?delete this.pointers[i.pointerId]:(i.identifier=i.pointerId,this.pointers[i.pointerId]=i),Object.keys(this.pointers).length},matchType:function(h,i){if(!i.pointerType)return!1;var s=i.pointerType,a={};return a[e.POINTER_MOUSE]=s===i.MSPOINTER_TYPE_MOUSE||s===e.POINTER_MOUSE,a[e.POINTER_TOUCH]=s===i.MSPOINTER_TYPE_TOUCH||s===e.POINTER_TOUCH,a[e.POINTER_PEN]=s===i.MSPOINTER_TYPE_PEN||s===e.POINTER_PEN,a[h]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},e.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(i,s){this.current||(this.stopped=!1,this.current={inst:i,startEvent:e.utils.extend({},s),lastEvent:!1,lastVEvent:!1,velocity:!1,name:""},this.detect(s))},detect:function(i){if(!(!this.current||this.stopped)){i=this.extendEventData(i);var s=this.current.inst.options;return e.utils.each(this.gestures,function(a){if(!this.stopped&&s[a.name]!==!1&&a.handler.call(a,i,this.current.inst)===!1)return this.stopDetect(),!1},this),this.current&&(this.current.lastEvent=i),i.eventType==e.EVENT_END&&!i.touches.length-1&&this.stopDetect(),i}},stopDetect:function(){this.previous=e.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(i){var s=this.current.startEvent,a=this.current.lastVEvent;s&&(i.touches.length!=s.touches.length||i.touches===s.touches)&&(s.touches=[],e.utils.each(i.touches,function(U){s.touches.push(e.utils.extend({},U))}));var c=i.timeStamp-s.timeStamp,g=i.center.pageX-s.center.pageX,P=i.center.pageY-s.center.pageY,T,S,E=this.current.velocity;return a!==!1&&i.timeStamp-a.timeStamp>e.UPDATE_VELOCITY_INTERVAL?(E=e.utils.getVelocity(i.timeStamp-a.timeStamp,i.center.pageX-a.center.pageX,i.center.pageY-a.center.pageY),this.current.lastVEvent=i,E.x>0&&E.y>0&&(this.current.velocity=E)):this.current.velocity===!1&&(E=e.utils.getVelocity(c,g,P),this.current.velocity=E,this.current.lastVEvent=i),i.eventType==="end"?(T=this.current.lastEvent&&this.current.lastEvent.interimAngle,S=this.current.lastEvent&&this.current.lastEvent.interimDirection):(T=this.current.lastEvent&&e.utils.getAngle(this.current.lastEvent.center,i.center),S=this.current.lastEvent&&e.utils.getDirection(this.current.lastEvent.center,i.center)),e.utils.extend(i,{deltaTime:c,deltaX:g,deltaY:P,velocityX:E.x,velocityY:E.y,distance:e.utils.getDistance(s.center,i.center),angle:e.utils.getAngle(s.center,i.center),interimAngle:T,direction:e.utils.getDirection(s.center,i.center),interimDirection:S,scale:e.utils.getScale(s.touches,i.touches),rotation:e.utils.getRotation(s.touches,i.touches),startEvent:s}),i},register:function(i){var s=i.defaults||{};return s[i.name]===t&&(s[i.name]=!0),e.utils.extend(e.defaults,s,!0),i.index=i.index||1e3,this.gestures.push(i),this.gestures.sort(function(a,c){return a.index<c.index?-1:a.index>c.index?1:0}),this.gestures}},e.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(i,s){if(e.detection.current.name!=this.name&&this.triggered){s.trigger(this.name+"end",i),this.triggered=!1;return}if(!(s.options.drag_max_touches>0&&i.touches.length>s.options.drag_max_touches))switch(i.eventType){case e.EVENT_START:this.triggered=!1;break;case e.EVENT_MOVE:if(i.distance<s.options.drag_min_distance&&e.detection.current.name!=this.name)return;if(e.detection.current.name!=this.name&&(e.detection.current.name=this.name,s.options.correct_for_drag_min_distance&&i.distance>0)){var a=Math.abs(s.options.drag_min_distance/i.distance);e.detection.current.startEvent.center.pageX+=i.deltaX*a,e.detection.current.startEvent.center.pageY+=i.deltaY*a,i=e.detection.extendEventData(i)}(e.detection.current.lastEvent.drag_locked_to_axis||s.options.drag_lock_to_axis&&s.options.drag_lock_min_distance<=i.distance)&&(i.drag_locked_to_axis=!0);var c=e.detection.current.lastEvent.direction;i.drag_locked_to_axis&&c!==i.direction&&(e.utils.isVertical(c)?i.direction=i.deltaY<0?e.DIRECTION_UP:e.DIRECTION_DOWN:i.direction=i.deltaX<0?e.DIRECTION_LEFT:e.DIRECTION_RIGHT),this.triggered||(s.trigger(this.name+"start",i),this.triggered=!0),s.trigger(this.name,i),s.trigger(this.name+i.direction,i),(s.options.drag_block_vertical&&e.utils.isVertical(i.direction)||s.options.drag_block_horizontal&&!e.utils.isVertical(i.direction))&&i.preventDefault();break;case e.EVENT_END:this.triggered&&s.trigger(this.name+"end",i),this.triggered=!1;break}}},e.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(i,s){switch(i.eventType){case e.EVENT_START:clearTimeout(this.timer),e.detection.current.name=this.name,this.timer=setTimeout(function(){e.detection.current.name=="hold"&&s.trigger("hold",i)},s.options.hold_timeout);break;case e.EVENT_MOVE:i.distance>s.options.hold_threshold&&clearTimeout(this.timer);break;case e.EVENT_END:clearTimeout(this.timer);break}}},e.gestures.Release={name:"release",index:1/0,handler:function(i,s){i.eventType==e.EVENT_END&&s.trigger(this.name,i)}},e.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(i,s){if(i.eventType==e.EVENT_END){if(s.options.swipe_max_touches>0&&i.touches.length<s.options.swipe_min_touches&&i.touches.length>s.options.swipe_max_touches)return;(i.velocityX>s.options.swipe_velocity||i.velocityY>s.options.swipe_velocity)&&(s.trigger(this.name,i),s.trigger(this.name+i.direction,i))}}},e.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(i,s){if(i.eventType==e.EVENT_MOVE&&!e.detection.current.reachedTapMaxDistance)e.detection.current.reachedTapMaxDistance=i.distance>s.options.tap_max_distance;else if(i.eventType==e.EVENT_END&&i.srcEvent.type!="touchcancel"){var a=e.detection.previous,c=!1;if(e.detection.current.reachedTapMaxDistance||i.deltaTime>s.options.tap_max_touchtime)return;a&&a.name=="tap"&&i.timeStamp-a.lastEvent.timeStamp<s.options.doubletap_interval&&i.distance<s.options.doubletap_distance&&(s.trigger("doubletap",i),c=!0),(!c||s.options.tap_always)&&(e.detection.current.name="tap",s.trigger(e.detection.current.name,i))}}},e.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(i,s){if(s.options.prevent_mouseevents&&i.pointerType==e.POINTER_MOUSE){i.stopDetect();return}s.options.prevent_default&&i.preventDefault(),i.eventType==e.EVENT_START&&s.trigger(this.name,i)}},e.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(i,s){if(e.detection.current.name!=this.name&&this.triggered){s.trigger(this.name+"end",i),this.triggered=!1;return}if(!(i.touches.length<2))switch(s.options.transform_always_block&&i.preventDefault(),i.eventType){case e.EVENT_START:this.triggered=!1;break;case e.EVENT_MOVE:var a=Math.abs(1-i.scale),c=Math.abs(i.rotation);if(a<s.options.transform_min_scale&&c<s.options.transform_min_rotation)return;e.detection.current.name=this.name,this.triggered||(s.trigger(this.name+"start",i),this.triggered=!0),s.trigger(this.name,i),c>s.options.transform_min_rotation&&s.trigger("rotate",i),a>s.options.transform_min_scale&&(s.trigger("pinch",i),s.trigger("pinch"+(i.scale<1?"in":"out"),i));break;case e.EVENT_END:this.triggered&&s.trigger(this.name+"end",i),this.triggered=!1;break}}},typeof define=="function"&&define.amd?define(function(){return e}):typeof X=="object"&&X.exports?X.exports=e:n.Hammer=e})(window)});var ot=rt((ce,L)=>{(function(){for(var n={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},t={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},e={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},r={option:"alt",command:"meta",return:"enter",escape:"esc"},u,d={},p={},h={},i,s=!1,a=!1,c=1;c<20;++c)n[111+c]="f"+c;for(c=0;c<=9;++c)n[c+96]=c;function g(o,l,f){if(o.addEventListener){o.addEventListener(l,f,!1);return}o.attachEvent("on"+l,f)}function P(o){return o.type=="keypress"?String.fromCharCode(o.which):n[o.which]?n[o.which]:t[o.which]?t[o.which]:String.fromCharCode(o.which).toLowerCase()}function T(o,l){return o.sort().join(",")===l.sort().join(",")}function S(o){o=o||{};var l=!1,f;for(f in h){if(o[f]){l=!0;continue}h[f]=0}l||(a=!1)}function E(o,l,f,_,y){var M,v,m=[],I=f.type;if(!d[o])return[];for(I=="keyup"&&j(o)&&(l=[o]),M=0;M<d[o].length;++M)v=d[o][M],!(v.seq&&h[v.seq]!=v.level)&&I==v.action&&(I=="keypress"&&!f.metaKey&&!f.ctrlKey||T(l,v.modifiers))&&(_&&v.combo==y&&d[o].splice(M,1),m.push(v));return m}function U(o){var l=[];return o.shiftKey&&l.push("shift"),o.altKey&&l.push("alt"),o.ctrlKey&&l.push("ctrl"),o.metaKey&&l.push("meta"),l}function W(o,l){o(l)===!1&&(l.preventDefault&&l.preventDefault(),l.stopPropagation&&l.stopPropagation(),l.returnValue=!1,l.cancelBubble=!0)}function bt(o,l){if(!Y.stopCallback(l,l.target||l.srcElement)){var f=E(o,U(l),l),_,y={},M=!1;for(_=0;_<f.length;++_){if(f[_].seq){M=!0,y[f[_].seq]=1,W(f[_].callback,l);continue}!M&&!a&&W(f[_].callback,l)}l.type==a&&!j(o)&&S(y)}}function F(o){o.which=typeof o.which=="number"?o.which:o.keyCode;var l=P(o);if(l){if(o.type=="keyup"&&s==l){s=!1;return}bt(l,o)}}function j(o){return o=="shift"||o=="ctrl"||o=="alt"||o=="meta"}function wt(){clearTimeout(i),i=setTimeout(S,1e3)}function Dt(){if(!u){u={};for(var o in n)o>95&&o<112||n.hasOwnProperty(o)&&(u[n[o]]=o)}return u}function et(o,l,f){return f||(f=Dt()[o]?"keydown":"keypress"),f=="keypress"&&l.length&&(f="keydown"),f}function Pt(o,l,f,_){h[o]=0,_||(_=et(l[0],[]));var y=function(m){a=_,++h[o],wt()},M=function(m){W(f,m),_!=="keyup"&&(s=P(m)),setTimeout(S,10)},v;for(v=0;v<l.length;++v)it(l[v],v<l.length-1?y:M,_,o,v)}function it(o,l,f,_,y){o=o.replace(/\s+/g," ");var M=o.split(" "),v,m,I,H=[];if(M.length>1){Pt(o,M,l,f);return}for(I=o==="+"?["+"]:o.split("+"),v=0;v<I.length;++v)m=I[v],r[m]&&(m=r[m]),f&&f!="keypress"&&e[m]&&(m=e[m],H.push("shift")),j(m)&&H.push(m);f=et(m,H,f),d[m]||(d[m]=[]),E(m,H,{type:f},!_,o),d[m][_?"unshift":"push"]({callback:l,modifiers:H,action:f,seq:_,level:y,combo:o})}function Ot(o,l,f){for(var _=0;_<o.length;++_)it(o[_],l,f)}g(document,"keypress",F),g(document,"keydown",F),g(document,"keyup",F);var Y={bind:function(o,l,f){return Ot(o instanceof Array?o:[o],l,f),p[o+":"+f]=l,this},unbind:function(o,l){return p[o+":"+l]&&(delete p[o+":"+l],this.bind(o,function(){},l)),this},trigger:function(o,l){return p[o+":"+l](),this},reset:function(){return d={},p={},this},stopCallback:function(o,l){return(" "+l.className+" ").indexOf(" mousetrap ")>-1?!1:l.tagName=="INPUT"||l.tagName=="SELECT"||l.tagName=="TEXTAREA"||l.contentEditable&&l.contentEditable=="true"}};window.Mousetrap=Y,typeof define=="function"&&define.amd&&define("mousetrap",function(){return Y}),typeof L=="object"&&L.exports&&(L.exports=Y)})()});var St=nt(at(),1),D=nt(ot(),1);function Ht(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}var ht=Ht;var K=class n{constructor(t){this._ctx=t,this._images={},this._centralSprite=null}logicalWidth(){let t=this._ctx.canvas.style.width;return t?parseFloat(t):this._ctx.canvas.width}logicalHeight(){let t=this._ctx.canvas.style.height;return t?parseFloat(t):this._ctx.canvas.height}storeLoadedImage(t,e){this._images[t]=e}getLoadedImage(t){return this._images[t]}followSprite(t){this._centralSprite=t}getCentralPosition(){return{map:this._centralSprite.mapPosition,canvas:[Math.round(this.logicalWidth()*.5),Math.round(this.logicalHeight()*.5),0]}}mapPositionToCanvasPosition(t){var e=this.getCentralPosition(),r=e.map[0]-t[0],u=e.map[1]-t[1];return[e.canvas[0]-r,e.canvas[1]-u]}canvasPositionToMapPosition(t){var e=this.getCentralPosition(),r=e.canvas[0]-t[0],u=e.canvas[1]-t[1];return[e.map[0]-r,e.map[1]-u]}getCentreOfViewport(){return Math.floor(this.logicalWidth()/2)}getMiddleOfViewport(){return Math.floor(this.logicalHeight()/2)}getBelowViewport(){return Math.floor(this.logicalHeight())}getMapBelowViewport(){var t=this.getBelowViewport();return this.canvasPositionToMapPosition([0,t])[1]}getAboveViewport(){return 0-Math.floor(this.logicalHeight()/4)}getTopOfViewport(){return this.canvasPositionToMapPosition([0,0])[1]}getRandomlyInTheCentreOfCanvas(t){var e=0,r=this.logicalWidth();return t&&(e-=t,r+=t),Math.floor(Math.random()*(r-e+1))+e}getRandomlyInTheCentreOfMap(t){var e=this.getRandomlyInTheCentreOfCanvas(t);return this.canvasPositionToMapPosition([e,0])[0]}getRandomMapPositionBelowViewport(){var t=this.getRandomlyInTheCentreOfCanvas(),e=this.getBelowViewport();return this.canvasPositionToMapPosition([t,e])}getRandomMapPositionAboveViewport(){var t=this.getRandomlyInTheCentreOfCanvas(),e=this.getAboveViewport();return this.canvasPositionToMapPosition([t,e])}static create(t){let e=new n(t);return new Proxy(e,{get(r,u){if(u in r){let p=r[u];return typeof p=="function"?p.bind(r):p}let d=t[u];return typeof d=="function"?d.bind(t):d},set(r,u,d){return u in r?r[u]=d:t[u]=d,!0}})}},ct=K;function Ct(){var n=function(){return Math.floor(Math.random()*65536).toString(16)};return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()}var ut=Ct;var G=class n{constructor(t){this._hittableObjects={},this._zIndexesOccupied=[0],this._trackedSpriteToMoveToward=void 0,this.direction=void 0,this.mapPosition=[0,0,0],this.id=ut(),this.canvasX=0,this.canvasY=0,this.canvasZ=0,this.height=0,this.speed=0,this.data=t||{parts:{}},this.movingToward=[0,0],this.metresDownTheMountain=0,this.movingWithConviction=!1,this.deleted=!1,this.data.parts||(this.data.parts={});let e=Object.values(this.data.parts).map(r=>r[3]);this.maxHeight=e.length?Math.max(...e):void 0,this.isMoving=!0,t&&t.id&&(this.id=t.id),t&&t.zIndexesOccupied&&(this._zIndexesOccupied=t.zIndexesOccupied)}_incrementX(t){this.canvasX+=parseFloat(t)}_incrementY(t){this.canvasY+=parseFloat(t)}_getHitBox(t){if(this.data.hitBoxes&&this.data.hitBoxes[t])return this.data.hitBoxes[t]}_roundHalf(t){return Math.round(t*2)/2}_move(t=1){if(this.isMoving){var e=this.mapPosition[0],r=this.mapPosition[1];if(typeof this.direction<"u"){var u=this.direction-90;u<0&&(u=360+u),e+=this._roundHalf(this.speed*t*Math.cos(u*(Math.PI/180))),r+=this._roundHalf(this.speed*t*Math.sin(u*(Math.PI/180)))}else typeof this.movingToward[0]<"u"&&(e>this.movingToward[0]?e-=Math.min(this.getSpeedX()*t,Math.abs(e-this.movingToward[0])):e<this.movingToward[0]&&(e+=Math.min(this.getSpeedX()*t,Math.abs(e-this.movingToward[0])))),typeof this.movingToward[1]<"u"&&(r>this.movingToward[1]?r-=Math.min(this.getSpeedY()*t,Math.abs(r-this.movingToward[1])):r<this.movingToward[1]&&(r+=Math.min(this.getSpeedY()*t,Math.abs(r-this.movingToward[1]))));this.setMapPosition(e,r)}}draw(t,e){var r=this.data.parts[e];this.height=r[3],this.width=r[2];var u=t.mapPositionToCanvasPosition(this.mapPosition);this.setCanvasPosition(u[0],u[1]),t.drawImage(t.getLoadedImage(this.data.$imageFile),r[0],r[1],r[2],r[3],this.canvasX,this.canvasY,r[2],r[3])}setMapPosition(t,e,r){typeof t>"u"&&(t=this.mapPosition[0]),typeof e>"u"&&(e=this.mapPosition[1]),typeof r>"u"?r=this.mapPosition[2]:this._zIndexesOccupied=[r],this.mapPosition=[t,e,r]}setCanvasPosition(t,e){t&&(typeof t=="string"&&(t[0]==="+"||t[0]==="-")?this._incrementX(t):this.canvasX=t),e&&(typeof e=="string"&&(e[0]==="+"||e[0]==="-")?this._incrementY(e):this.canvasY=e)}getCanvasPositionX(){return this.canvasX}getCanvasPositionY(){return this.canvasY}getLeftHitBoxEdge(t){t=t||0;var e=this.getCanvasPositionX();return this._getHitBox(t)&&(e+=this._getHitBox(t)[0]),e}getTopHitBoxEdge(t){t=t||0;var e=this.getCanvasPositionY();return this._getHitBox(t)&&(e+=this._getHitBox(t)[1]),e}getRightHitBoxEdge(t){return t=t||0,this._getHitBox(t)?this.canvasX+this._getHitBox(t)[2]:this.canvasX+this.width}getBottomHitBoxEdge(t){return t=t||0,this._getHitBox(t)?this.canvasY+this._getHitBox(t)[3]:this.canvasY+this.height}getPositionInFrontOf(){return[this.canvasX,this.canvasY+this.height]}setSpeed(t){this.speed=t,this.speedX=t,this.speedY=t}incrementSpeedBy(t){this.speed+=t}getSpeed(){return this.speed}getSpeedX(){return this.speed}getSpeedY(){return this.speed}setHeight(t){this.height=t}setWidth(t){this.width=t}getMaxHeight(){return this.maxHeight}getMovingTowardOpposite(){if(!this.isMoving)return[0,0];var t=this.movingToward[0]-this.mapPosition[0],e=this.movingToward[1]-this.mapPosition[1],r=Math.abs(t)>75?0-t:0;return[r,-e]}checkHittableObjects(){Object.keys(this._hittableObjects).forEach(t=>{var e=this._hittableObjects[t];e.object.deleted?delete this._hittableObjects[t]:e.object.hits(this)&&e.callbacks.forEach(r=>r(this,e.object))})}cycle(t=1){this.checkHittableObjects(),this._trackedSpriteToMoveToward&&this.setMapPositionTarget(this._trackedSpriteToMoveToward.mapPosition[0],this._trackedSpriteToMoveToward.mapPosition[1],!0),this._move(t)}setMapPositionTarget(t,e,r){r&&(this.movingWithConviction=!1),this.movingWithConviction||(typeof t>"u"&&(t=this.movingToward[0]),typeof e>"u"&&(e=this.movingToward[1]),this.movingToward=[t,e],this.movingWithConviction=!1)}setDirection(t){t>=360&&(t=360-t),this.direction=t,this.movingToward=void 0}resetDirection(){this.direction=void 0}setMapPositionTargetWithConviction(t,e){this.setMapPositionTarget(t,e),this.movingWithConviction=!0}follow(t){this._trackedSpriteToMoveToward=t}stopFollowing(){this._trackedSpriteToMoveToward=!1}onHitting(t,e){if(this._hittableObjects[t.id])return this._hittableObjects[t.id].callbacks.push(e);this._hittableObjects[t.id]={object:t,callbacks:[e]}}deleteOnNextCycle(){this.deleted=!0}occupiesZIndex(t){return this._zIndexesOccupied.indexOf(t)>=0}hits(t){var e=!1,r=!1,u=this.mapPosition[2];return t.getTopHitBoxEdge(u)<=this.getBottomHitBoxEdge(u)&&t.getBottomHitBoxEdge(u)>=this.getBottomHitBoxEdge(u)&&(e=!0),t.getTopHitBoxEdge(u)<=this.getTopHitBoxEdge(u)&&t.getBottomHitBoxEdge(u)>=this.getTopHitBoxEdge(u)&&(e=!0),t.getLeftHitBoxEdge(u)<=this.getRightHitBoxEdge(u)&&t.getRightHitBoxEdge(u)>=this.getRightHitBoxEdge(u)&&(r=!0),t.getLeftHitBoxEdge(u)<=this.getLeftHitBoxEdge(u)&&t.getRightHitBoxEdge(u)>=this.getLeftHitBoxEdge(u)&&(r=!0),e&&r}isAboveOnCanvas(t){return this.canvasY+this.height<t}isBelowOnCanvas(t){return this.canvasY>t}static createObjects(t,e){Array.isArray(t)||(t=[t]),e=Object.assign({rateModifier:0,dropRate:1,position:[0,0]},e);function r(u){var d=e.position;if(Math.floor(Math.random()*(101+e.rateModifier))<=u.dropRate){var p=new n(u.sprite);return p.setSpeed(0),typeof d=="function"&&(d=d()),p.setMapPosition(d[0],d[1]),u.sprite.hitBehaviour&&u.sprite.hitBehaviour.skier&&e.player&&p.onHitting(e.player,u.sprite.hitBehaviour.skier),p}}return t.map(r).filter(u=>u!==void 0)}},O=G;var J=class extends O{constructor(t){super(t),this._spriteVersion=1,this._eatingStage=0,this.isEating=!1,this.isFull=!1,this.setSpeed(6)}draw(t){let e=()=>{var r=this.movingToward[0]-this.canvasX;return this.isEating?"eating"+this._eatingStage:(this._spriteVersion+.1>2?this._spriteVersion=.1:this._spriteVersion+=.1,r>=0?"sEast"+Math.ceil(this._spriteVersion):"sWest"+Math.ceil(this._spriteVersion))};return super.draw(t,e())}startEating(t){this._eatingStage+=1,this.isEating=!0,this.isMoving=!1,this._eatingStage<6?setTimeout(()=>this.startEating(t),300):(this._eatingStage=0,this.isEating=!1,this.isMoving=!0,t())}},lt=J;var q=class extends O{constructor(t){super(t),this._standardSpeed=3,this._camera=null,this.setSpeed(this._standardSpeed)}_getDirection(){var t=this.movingToward[0]-this.mapPosition[0];return t>0?"sEast":"sWest"}cycle(t=1){Math.floor(Math.random()*11)===1&&(this.setMapPositionTarget(this._camera.getRandomlyInTheCentreOfMap()),this.setSpeed(this._standardSpeed+Math.floor(Math.random()*3)-1)),this.setMapPositionTarget(void 0,this._camera.getMapBelowViewport()+600),super.cycle(t)}draw(t){return super.draw(t,this._getDirection())}},ft=q;typeof navigator<"u"?navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate:globalThis.navigator={vibrate:!1};var gt={west:270,wsWest:240,sWest:195,south:180,sEast:165,esEast:120,east:90},$=class extends O{constructor(t){super(t),this._cancelableStateTimeout=null,this._cancelableStateInterval=null,this._canSpeedBoost=!0,this._obstaclesHit=[],this._pixelsTravelled=0,this._standardSpeed=5,this._turnEaseCycles=70,this._speedX=0,this._speedXFactor=0,this._speedY=0,this._speedYFactor=1,this._trickStep=0,this.isMoving=!0,this.hasBeenHit=!1,this.isJumping=!1,this.isPerformingTrick=!1,this.onHitObstacleCb=function(){},this.setSpeed(this._standardSpeed)}_setNormal(){this.setSpeed(this._standardSpeed),this.isMoving=!0,this.hasBeenHit=!1,this.isJumping=!1,this.isPerformingTrick=!1,this._cancelableStateInterval&&clearInterval(this._cancelableStateInterval),this.setMapPosition(void 0,void 0,0)}_setCrashed(){this.isMoving=!1,this.hasBeenHit=!0,this.isJumping=!1,this.isPerformingTrick=!1,this._cancelableStateInterval&&clearInterval(this._cancelableStateInterval),this.setMapPosition(void 0,void 0,0)}_setJumping(){var t=this.getSpeed();this.setSpeed(t+2),this.setSpeedY(t+2),this.isMoving=!0,this.hasBeenHit=!1,this.isJumping=!0,this.setMapPosition(void 0,void 0,1)}_getDiscreteDirection(){if(this.direction)return this.direction<=90?"east":this.direction>90&&this.direction<150?"esEast":this.direction>=150&&this.direction<180?"sEast":this.direction===180?"south":this.direction>180&&this.direction<=210?"sWest":this.direction>210&&this.direction<270?"wsWest":this.direction>=270?"west":"south";var t=this.movingToward[0]-this.mapPosition[0],e=this.movingToward[1]-this.mapPosition[1];return e<=0?t>0?"east":"west":t>300?"esEast":t>75?"sEast":t<-300?"wsWest":t<-75?"sWest":"south"}_setDiscreteDirection(t){gt[t]&&this.setDirection(gt[t]),this.isMoving=t!=="west"&&t!=="east"}_getBeingEatenSprite(){return"blank"}_getJumpingSprite(){return"jumping"}_getTrickSprite(){return console.log("Trick step is",this._trickStep),this._trickStep===0?"jumping":this._trickStep===1?"somersault1":"somersault2"}_easeSpeedToTargetUsingFactor(t,e,r){return r===0||r===1?e:(t<e&&(t+=this.getSpeed()*(r/this._turnEaseCycles)),t>e&&(t-=this.getSpeed()*(r/this._turnEaseCycles)),t)}stop(){this.direction>180?this._setDiscreteDirection("west"):this._setDiscreteDirection("east")}turnEast(){if(!this.hasBeenHit)switch(this._getDiscreteDirection()){case"west":this._setDiscreteDirection("wsWest");break;case"wsWest":this._setDiscreteDirection("sWest");break;case"sWest":this._setDiscreteDirection("south");break;case"south":this._setDiscreteDirection("sEast");break;case"sEast":this._setDiscreteDirection("esEast");break;case"esEast":this._setDiscreteDirection("east");break;default:this._setDiscreteDirection("south");break}}turnWest(){if(!this.hasBeenHit)switch(this._getDiscreteDirection()){case"east":this._setDiscreteDirection("esEast");break;case"esEast":this._setDiscreteDirection("sEast");break;case"sEast":this._setDiscreteDirection("south");break;case"south":this._setDiscreteDirection("sWest");break;case"sWest":this._setDiscreteDirection("wsWest");break;case"wsWest":this._setDiscreteDirection("west");break;default:this._setDiscreteDirection("south");break}}stepWest(){this.hasBeenHit||(this.mapPosition[0]-=this.speed*2)}stepEast(){this.hasBeenHit||(this.mapPosition[0]+=this.speed*2)}setMapPositionTarget(t,e){this.hasBeenHit||(Math.abs(this.mapPosition[0]-t)<=75&&(t=this.mapPosition[0]),this.movingToward=[t,e])}startMovingIfPossible(){!this.hasBeenHit&&!this.isBeingEaten&&(this.isMoving=!0)}setTurnEaseCycles(t){this._turnEaseCycles=t}getPixelsTravelledDownMountain(){return this._pixelsTravelled}getStandardSpeed(){return this._standardSpeed}resetSpeed(){this.setSpeed(this._standardSpeed)}setSpeedY(t){this._speedY=t}getSpeedX(){var t=this._getDiscreteDirection();return t==="esEast"||t==="wsWest"?(this._speedXFactor=.5,this._speedX=this._easeSpeedToTargetUsingFactor(this._speedX,this.getSpeed()*.5,.5),this._speedX):t==="sEast"||t==="sWest"?(this._speedXFactor=.33,this._speedX=this._easeSpeedToTargetUsingFactor(this._speedX,this.getSpeed()*.33,.33),this._speedX):(this._speedX=this._easeSpeedToTargetUsingFactor(this._speedX,0,this._speedXFactor),this._speedX)}getSpeedY(){var t=this._getDiscreteDirection();return this.isJumping?this._speedY:t==="esEast"||t==="wsWest"?(this._speedYFactor=.6,this._speedY=this._easeSpeedToTargetUsingFactor(this._speedY,this.getSpeed()*.6,.6),this._speedY):t==="sEast"||t==="sWest"?(this._speedYFactor=.85,this._speedY=this._easeSpeedToTargetUsingFactor(this._speedY,this.getSpeed()*.85,.85),this._speedY):t==="east"||t==="west"?(this._speedYFactor=1,this._speedY=0,this._speedY):(this._speedY=this._easeSpeedToTargetUsingFactor(this._speedY,this.getSpeed(),this._speedYFactor),this._speedY)}cycle(t=1){this.getSpeedX()<=0&&this.getSpeedY()<=0&&(this.isMoving=!1),this.isMoving&&(this._pixelsTravelled+=this.speed*t),this.isJumping&&this.setMapPositionTarget(void 0,this.mapPosition[1]+this.getSpeed()*t),super.cycle(t),this.checkHittableObjects()}draw(t){let e=()=>this.isBeingEaten?this._getBeingEatenSprite():this.isJumping?this.isPerformingTrick?this._getTrickSprite():this._getJumpingSprite():this.hasBeenHit?"hit":this._getDiscreteDirection();return super.draw(t,e())}hits(t){return this._obstaclesHit.indexOf(t.id)!==-1||!t.occupiesZIndex(this.mapPosition[2])?!1:super.hits(t)}speedBoost(){var t=this.speed;this._canSpeedBoost&&(this._canSpeedBoost=!1,this.setSpeed(this.speed*2),setTimeout(()=>{this.setSpeed(t),setTimeout(()=>{this._canSpeedBoost=!0},1e4)},2e3))}attemptTrick(){this.isJumping&&(this.isPerformingTrick=!0,this._cancelableStateInterval=setInterval(()=>{this._trickStep=this._trickStep>=2?0:this._trickStep+1},300))}hasHitObstacle(t){this._setCrashed(),navigator.vibrate&&navigator.vibrate(500),this._obstaclesHit.push(t.id),this.resetSpeed(),this.onHitObstacleCb(t),this._cancelableStateTimeout&&clearTimeout(this._cancelableStateTimeout),this._cancelableStateTimeout=setTimeout(()=>this._setNormal(),1500)}hasHitJump(){this._setJumping(),this._cancelableStateTimeout&&clearTimeout(this._cancelableStateTimeout),this._cancelableStateTimeout=setTimeout(()=>this._setNormal(),1e3)}isEatenBy(t,e){this.hasHitObstacle(t),t.startEating(e),this._obstaclesHit.push(t.id),this.isMoving=!1,this.isBeingEaten=!0}reset(){this._obstaclesHit=[],this._pixelsTravelled=0,this.isMoving=!0,this.isJumping=!1,this.hasBeenHit=!1,this._canSpeedBoost=!0}setHitObstacleCb(t){this.onHitObstacleCb=t||function(){}}},_t=$;var Z=class{constructor(t){this.lines=t.initialLines,this.top=t.position.top,this.right=t.position.right,this.bottom=t.position.bottom,this.left=t.position.left,this.width=t.width,this.height=t.height}setLines(t){this.lines=t}draw(t){t.font="11px monospace";var e=0;this.lines.forEach(r=>{var u=+t.font.slice(0,2),d=t.measureText(r).width,p=u*1.5,h,i;this.top?i=this.top+e:this.bottom&&(i=t.canvas.height-this.top-p+e),this.right?h=t.canvas.width-this.right-d:this.left&&(h=this.left),e+=p,t.fillText(r,h,i)})}},mt=Z;var z=class extends Array{constructor(){super(),this.pushHandlers=[]}onPush(t,e){this.pushHandlers.push(t),e&&this.forEach(t)}push(t){super.push(t),this.pushHandlers.forEach(e=>e(t))}cull(){this.forEach((t,e)=>{t&&t.deleted&&delete this[e]})}},x=z;var Jt=20,Q=class{constructor(t,e){this._camera=t,this._player=e,this._staticObjects=new x,this._movingObjects=new x,this._uiElements=new x,this._mouseX=t.getCentreOfViewport(),this._mouseY=0,this._paused=!1,this._beforeCycleCallbacks=[],this._afterCycleCallbacks=[],this._rafId=null,this._lastTimestamp=null,e.setMapPosition(0,0),e.setMapPositionTarget(0,-10),t.followSprite(e)}addStaticObject(t){this._staticObjects.push(t)}addStaticObjects(t){t.forEach(this.addStaticObject.bind(this))}addMovingObject(t,e){t._camera=this._camera,e&&this._staticObjects.onPush(r=>{r.data&&r.data.hitBehaviour[e]&&r.onHitting(t,r.data.hitBehaviour[e])},!0),this._movingObjects.push(t)}addUIElement(t){this._uiElements.push(t)}beforeCycle(t){this._beforeCycleCallbacks.push(t)}afterCycle(t){this._afterCycleCallbacks.push(t)}setMouseX(t){this._mouseX=t}setMouseY(t){this._mouseY=t}_tick(t){this._lastTimestamp===null&&(this._lastTimestamp=t);let r=Math.min(t-this._lastTimestamp,100)/Jt;this._lastTimestamp=t,this.cycle(r),this.draw(),this._rafId=requestAnimationFrame(u=>this._tick(u))}start(){this._rafId||(this._lastTimestamp=null,this._rafId=requestAnimationFrame(t=>this._tick(t)))}pause(){this._paused=!0,this._rafId&&(cancelAnimationFrame(this._rafId),this._rafId=null)}isPaused(){return this._paused}reset(){this._paused=!1,this._staticObjects=new x,this._movingObjects=new x,this._mouseX=this._camera.getCentreOfViewport(),this._mouseY=0,this._player.reset(),this._player.setMapPosition(0,0,0),this._lastTimestamp=null,this.start()}cycle(t=1){this._beforeCycleCallbacks.forEach(r=>r());var e=this._camera.canvasPositionToMapPosition([this._mouseX,this._mouseY]);this._player.isJumping||this._player.setMapPositionTarget(e[0],e[1]),this._player.cycle(t),this._movingObjects.forEach(r=>r.cycle(t)),this._staticObjects.cull(),this._staticObjects.forEach(r=>{r.cycle&&r.cycle(t)}),this._uiElements.forEach(r=>{r.cycle&&r.cycle(t)}),this._afterCycleCallbacks.forEach(r=>r())}draw(){this._camera.clearRect(0,0,this._camera.logicalWidth(),this._camera.logicalHeight()),this._player.draw(this._camera),this._player.cycle(),this._movingObjects.forEach(t=>t.draw(this._camera)),this._staticObjects.forEach(t=>{t.draw&&t.draw(this._camera,"main")}),this._uiElements.forEach(t=>{t.draw&&t.draw(this._camera,"main")})}},Et=Q;var N={skier:{$imageFile:"sprite-characters.png",parts:{blank:[0,0,0,0],east:[0,0,24,34],esEast:[24,0,24,34],sEast:[49,0,17,34],south:[65,0,17,34],sWest:[49,37,17,34],wsWest:[24,37,24,34],west:[0,37,24,34],hit:[0,78,31,31],jumping:[84,0,32,34],somersault1:[116,0,32,34],somersault2:[148,0,32,34]},hitBoxes:{0:[7,20,27,34]},id:"player",hitBehaviour:{}},smallTree:{$imageFile:"skifree-objects.png",parts:{main:[0,28,30,34]},hitBoxes:{0:[0,18,30,34]},hitBehaviour:{}},tallTree:{$imageFile:"skifree-objects.png",parts:{main:[95,66,32,64]},zIndexesOccupied:[0,1],hitBoxes:{0:[0,54,32,64],1:[0,10,32,54]},hitBehaviour:{}},thickSnow:{$imageFile:"skifree-objects.png",parts:{main:[143,53,43,10]},hitBehaviour:{}},rock:{$imageFile:"skifree-objects.png",parts:{main:[30,52,23,11]},hitBehaviour:{}},monster:{$imageFile:"sprite-characters.png",parts:{sEast1:[64,112,26,43],sEast2:[90,112,32,43],sWest1:[64,158,26,43],sWest2:[90,158,32,43],eating1:[122,112,34,43],eating2:[156,112,31,43],eating3:[187,112,31,43],eating4:[219,112,25,43],eating5:[243,112,26,43]},hitBehaviour:{}},jump:{$imageFile:"skifree-objects.png",parts:{main:[109,55,32,8]},hitBehaviour:{}},signStart:{$imageFile:"skifree-objects.png",parts:{main:[260,103,42,27]},hitBehaviour:{}},snowboarder:{$imageFile:"sprite-characters.png",parts:{sEast:[73,229,20,29],sWest:[95,228,26,30]},hitBehaviour:{}},emptyChairLift:{$imageFile:"skifree-objects.png",parts:{main:[92,136,26,30]},zIndexesOccupied:[1]}};function qt(n){n.deleteOnNextCycle()}N.monster.hitBehaviour.tree=qt;function vt(n,t){t.deleteOnNextCycle()}N.smallTree.hitBehaviour.monster=vt;N.tallTree.hitBehaviour.monster=vt;function Tt(n,t){t.hasHitObstacle(n)}N.smallTree.hitBehaviour.skier=Tt;N.tallTree.hitBehaviour.skier=Tt;function $t(n,t){t.hasHitObstacle(n)}N.rock.hitBehaviour.skier=$t;function Zt(n,t){t.hasHitJump(n)}N.jump.hitBehaviour.skier=Zt;function zt(n,t){t.hasHitObstacle(n)}N.snowboarder.hitBehaviour.skier=zt;var b=N;var w=document.getElementById("skifree-canvas"),R=ct.create(w.getContext("2d")),ee=["sprite-characters.png","skifree-objects.png"],tt="Use the mouse or WASD to control the player";ht()&&(tt="Tap or drag on the piste to control the player");var k=0,ie=2e3,B=5,V=0,se=!1,A={smallTree:4,tallTree:2,jump:1,thickSnow:1,rock:1};localStorage.getItem("highScore")&&(V=localStorage.getItem("highScore"));function re(n,t){var e=0,r={};function u(){e+=1,e===n.length&&t(r)}n.forEach(function(d){var p=new Image;p.onload=u,p.src=d,R.storeLoadedImage(d,p)})}function ne(n,t){t.isEatenBy(n,function(){B-=1,n.isFull=!0,n.isEating=!1,t.isBeingEaten=!1,n.setSpeed(t.getSpeed()),n.stopFollowing();var e=R.getRandomMapPositionAboveViewport();n.setMapPositionTarget(e[0],e[1])})}function ae(){var n,t,e,r;function u(){k=0,B=5,V=localStorage.getItem("highScore"),r.reset(),r.addStaticObject(t)}function d(){r.isPaused()||(V=localStorage.setItem("highScore",k),e.setLines(["Game over!","Hit space to restart"]),r.pause(),r.cycle(),r.draw())}function p(s,a){var c=Math.max(800-w.width,0);Math.floor(Math.random()*(1001+c))<=a&&s()}function h(){var s=new lt(b.monster),a=R.getRandomMapPositionAboveViewport();s.setMapPosition(a[0],a[1]),s.follow(n),s.setSpeed(n.getStandardSpeed()),s.onHitting(n,ne),r.addMovingObject(s,"monster")}function i(){var s=new ft(b.snowboarder),a=R.getRandomMapPositionAboveViewport(),c=R.getRandomMapPositionBelowViewport();s.setMapPosition(a[0],a[1]),s.setMapPositionTarget(c[0],c[1]),s.onHitting(n,b.snowboarder.hitBehaviour.skier),r.addMovingObject(s)}n=new _t(b.skier),n.setMapPosition(0,0),n.setMapPositionTarget(0,-10),se&&n.setHitObstacleCb(function(){B-=1}),r=new Et(R,n),t=new O(b.signStart),r.addStaticObject(t),t.setMapPosition(-50,0),e=new mt({initialLines:["SkiFree.js",tt,"Travelled 0m","High Score: "+V,"Skiers left: "+B,"Created by Dan Hough (@basicallydan)"],position:{top:15,right:10}}),r.beforeCycle(function(){var s=[];n.isMoving&&(s=O.createObjects([{sprite:b.smallTree,dropRate:A.smallTree},{sprite:b.tallTree,dropRate:A.tallTree},{sprite:b.jump,dropRate:A.jump},{sprite:b.thickSnow,dropRate:A.thickSnow},{sprite:b.rock,dropRate:A.rock}],{rateModifier:Math.max(800-w.width,0),position:function(){return R.getRandomMapPositionBelowViewport()},player:n})),r.isPaused()||(r.addStaticObjects(s),p(i,.1),k=parseFloat(n.getPixelsTravelledDownMountain()/18).toFixed(1),k>ie&&p(h,.001),e.setLines(["SkiFree.js",tt,"Travelled "+k+"m","Skiers left: "+B,"High Score: "+V,"Created by Dan Hough (@basicallydan)","Current Speed: "+n.getSpeed()]))}),r.afterCycle(function(){B===0&&d()}),r.addUIElement(e),w.addEventListener("mousemove",function(s){r.setMouseX(s.pageX),r.setMouseY(s.pageY),n.resetDirection(),n.startMovingIfPossible()}),w.addEventListener("click",function(s){r.setMouseX(s.pageX),r.setMouseY(s.pageY),n.resetDirection(),n.startMovingIfPossible()}),w.focus(),D.default.bind("f",n.speedBoost.bind(n)),D.default.bind("t",n.attemptTrick.bind(n)),D.default.bind(["w","up"],function(){n.stop()}),D.default.bind(["a","left"],function(){n.direction===270?n.stepWest():n.turnWest()}),D.default.bind(["s","down"],function(){n.setDirection(180),n.startMovingIfPossible()}),D.default.bind(["d","right"],function(){n.direction===90?n.stepEast():n.turnEast()}),D.default.bind("m",h),D.default.bind("b",i),D.default.bind("space",u),(0,St.default)(w).on("press",function(s){s.preventDefault(),r.setMouseX(s.gesture.center.x),r.setMouseY(s.gesture.center.y)}).on("tap",function(s){r.setMouseX(s.gesture.center.x),r.setMouseY(s.gesture.center.y)}).on("pan",function(s){r.setMouseX(s.gesture.center.x),r.setMouseY(s.gesture.center.y),n.resetDirection(),n.startMovingIfPossible()}).on("doubletap",function(){n.speedBoost()}),n.isMoving=!1,n.setDirection(270),r.start()}function Mt(){let n=window.devicePixelRatio||1;w.style.width=window.innerWidth+"px",w.style.height=window.innerHeight+"px",w.width=Math.round(window.innerWidth*n),w.height=Math.round(window.innerHeight*n),R.scale(n,n),R.imageSmoothingEnabled=!1}window.addEventListener("resize",Mt,!1);Mt();re(ee,ae);})();
/*! Bundled license information:

hammerjs/hammer.js:
  (*! Hammer.JS - v1.0.7dev - 2014-02-18
   * http://eightmedia.github.com/hammer.js
   *
   * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
   * Licensed under the MIT license *)
*/

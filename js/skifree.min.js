(function e(t,n,r){function i(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return i(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var s=typeof require=="function"&&require;for(var o=0;o<r.length;o++)i(r[o]);return i})({1:[function(e,t,n){var r=e("./lib/spriteArray"),i=e("eventedloop");(function(e){function t(e,t){var n=new r,s=new r,o=new r,u=e.getContext("2d"),a=u.getCentreOfViewport(),f=0,l=!1,c=this,h=[],p=[],d=new i;this.addStaticObject=function(e){n.push(e)},this.addMovingObject=function(e,t){t&&n.onPush(function(n){n.data&&n.data.hitBehaviour[t]&&n.onHitting(e,n.data.hitBehaviour[t])},!0),s.push(e)},this.addUIElement=function(e){o.push(e)},this.beforeCycle=function(e){h.push(e)},this.afterCycle=function(e){p.push(e)},this.setMouseX=function(e){a=e},this.setMouseY=function(e){f=e},t.setMapPosition(0,0),t.setMapPositionTarget(0,-10),u.followSprite(t);var v=0;this.cycle=function(){h.each(function(e){e()});var e=u.canvasPositionToMapPosition([a,f]);t.isJumping||(v===0&&console.log("Skier targets: "+t.movingToward[0]+", "+t.movingToward[1]),t.setMapPositionTarget(e[0],e[1]),v===0&&console.log("Skier targets: "+t.movingToward[0]+", "+t.movingToward[1])),v++,t.cycle(),s.each(function(e,t){e.cycle(u)}),n.cull(),n.each(function(e,t){e.cycle&&e.cycle()}),o.each(function(e,t){e.cycle&&e.cycle()}),p.each(function(e){e()})},c.draw=function(){e.width=e.width,t.draw(u),t.cycle(),s.each(function(e,t){e.draw(u)}),n.each(function(e,t){e.draw&&e.draw(u,"main")}),o.each(function(e,t){e.draw&&e.draw(u,"main")})},this.start=function(){d.start()},this.pause=function(){l=!0,d.stop()},this.isPaused=function(){return l},this.reset=function(){l=!1,n=new r,s=new r,a=u.getCentreOfViewport(),f=0,t.reset(),t.setMapPosition(0,0,0),this.start()}.bind(this),d.on("20",this.cycle),d.on("20",this.draw)}e.game=t})(this),typeof t!="undefined"&&(t.exports=this.game)},{"./lib/spriteArray":4,eventedloop:11}],2:[function(e,t,n){(function(e){function t(e){var t=this;return t.lines=e.initialLines,t.top=e.position.top,t.right=e.position.right,t.bottom=e.position.bottom,t.left=e.position.left,t.width=e.width,t.height=e.height,t.setLines=function(e){t.lines=e},t.draw=function(e){e.font="11px monospace";var n=0;t.lines.each(function(r){var i=+e.font.slice(0,2),s=e.measureText(r).width,o=i*1.5,u,a;t.top?a=t.top+n:t.bottom&&(a=e.canvas.height-t.top-o+n),t.right?u=e.canvas.width-t.right-s:t.left&&(u=t.left),n+=o,e.fillText(r,u,a)})},t}e.infoBox=t})(this),typeof t!="undefined"&&(t.exports=this.infoBox)},{}],3:[function(e,t,n){(function(e){function t(){var e=function(){return Math.floor(Math.random()*65536).toString(16)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}e.guid=t})(this),typeof t!="undefined"&&(t.exports=this.guid)},{}],4:[function(e,t,n){(function(e){function t(){return this.pushHandlers=[],this}t.prototype=Object.create(Array.prototype),t.prototype.onPush=function(e,t){this.pushHandlers.push(e),t&&this.each(e)},t.prototype.push=function(e){Array.prototype.push.call(this,e),this.pushHandlers.each(function(t){t(e)})},t.prototype.cull=function(){this.each(function(e,t){if(e.deleted)return delete this[t]})},e.spriteArray=t})(this),typeof t!="undefined"&&(t.exports=this.spriteArray)},{}],5:[function(e,t,n){function E(e,t){function s(){n+=1,n===e.length&&t(r)}var n=0,r={};e.each(function(e){var t=new Image;t.onload=s,t.src=e,i.storeLoadedImage(e,t)})}function S(e,t){t.isEatenBy(e,function(){b-=1,e.isFull=!0,e.isEating=!1,t.isBeingEaten=!1,e.setSpeed(t.getSpeed()),e.stopFollowing();var n=i.getRandomMapPositionAboveViewport();e.setMapPositionTarget(n[0],n[1])})}function x(e){function a(){g=!1,y=0,b=5,w=localStorage.getItem("highScore"),o.reset(),o.addStaticObject(n)}function E(){o.isPaused()||(w=localStorage.setItem("highScore",y),s.setLines(["Game over!","Hit space to restart"]),o.pause(),o.cycle())}function x(e,n){var s=Math.max(800-r.width,0);if(Number.random(100+s)<=n&&t.isMoving){var u=new l(e);u.setSpeed(0);var a=i.getRandomMapPositionBelowViewport();u.setMapPosition(a[0],a[1]),e.hitBehaviour.skier&&u.onHitting(t,e.hitBehaviour.skier),o.addStaticObject(u)}}function T(e,t){var n=Math.max(800-r.width,0);Number.random(1e3+n)<=t&&e()}function N(){var e=new f(v.monster),n=i.getRandomMapPositionAboveViewport();e.setMapPosition(n[0],n[1]),e.follow(t),e.onHitting(t,S),o.addMovingObject(e,"monster")}function C(){var e=new c(v.snowboarder),n=i.getRandomMapPositionAboveViewport(),r=i.getRandomMapPositionBelowViewport();e.setMapPosition(n[0],n[1]),e.setMapPositionTarget(r[0],r[1]),e.onHitting(t,v.snowboarder.hitBehaviour.skier),o.addMovingObject(e)}var t,n,s,o;t=new h(v.skier),t.setMapPosition(0,0),t.setMapPositionTarget(0,-10),o=new d(r,t),n=new l(v.signStart),o.addStaticObject(n),n.setMapPosition(-50,0),i.followSprite(t),s=new p({initialLines:["SkiFree.js",u,"Travelled 0m","High Score: "+w,"Skiers left: "+b,"Created by Dan Hough (@basicallydan)"],position:{top:15,right:10}}),o.beforeCycle(function(){x(v.smallTree,4),x(v.tallTree,2),x(v.jump,1),x(v.thickSnow,1),x(v.rock,1),T(C,.01),y=parseFloat(t.getPixelsTravelledDownMountain()/m).toFixed(1),o.isPaused()||s.setLines(["SkiFree.js",u,"Travelled "+y+"m","Skiers left: "+b,"High Score: "+w,"Created by Dan Hough (@basicallydan)","Current Speed: "+t.getSpeed()])}),o.afterCycle(function(){b===0&&E()}),o.addUIElement(s),$(r).mousemove(function(e){o.setMouseX(e.pageX),o.setMouseY(e.pageY)}).bind("click",function(e){o.setMouseX(e.pageX),o.setMouseY(e.pageY)}).bind("keydown",function(e){console.log(e.keyCode),(e.keyCode===70||e.keyCode===102)&&t.speedBoost(),e.keyCode===84&&t.attemptTrick();if(e.Keycode===87||e.keyCode===119||e.keyCode===38)o.setMouseX(0),o.setMouseY(0);if(e.keyCode===65||e.keyCode===97||e.keyCode===37)o.setMouseX(0),o.setMouseY(r.height);if(e.keyCode===83||e.keyCode===115||e.keyCode===40)o.setMouseX(r.width/2),o.setMouseY(r.height);if(e.keyCode===68||e.keyCode===100||e.keyCode===39)o.setMouseX(r.width),o.setMouseY(r.height);(e.keyCode===77||e.keyCode===109)&&N(),(e.keyCode===66||e.keyCode===98)&&C(),e.keyCode===32&&a()}).hammer({}).bind("hold",function(e){o.setMouseX(e.position[0].x),o.setMouseY(e.position[0].y)}).bind("tap",function(e){o.setMouseX(e.position[0].x),o.setMouseY(e.position[0].y)}).bind("drag",function(e){o.setMouseX(e.position.x),o.setMouseY(e.position.y)}).bind("doubletap",function(e){t.speedBoost()}).focus(),o.start()}function T(){r.width=window.innerWidth,r.height=window.innerHeight}function N(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?!0:!1}var r=document.getElementById("skifree-canvas"),i=r.getContext("2d"),s=["sprite-characters.png","skifree-objects.png"],o=this,u="Use the mouse or WASD to control the player";N()&&(u="Tap or drag on the piste to control the player");var a=e("./lib/spriteArray"),f=e("./monster"),l=e("./sprite"),c=e("./snowboarder"),h=e("./skier"),p=e("./infoBox"),d=e("./game"),v=e("./spriteInfo"),m=18,g=!1,y=0,b=5,w=0;localStorage.getItem("highScore")&&(w=localStorage.getItem("highScore")),window.addEventListener("resize",T,!1),T(),E(s,x)},{"./game":1,"./infoBox":2,"./lib/spriteArray":4,"./monster":6,"./skier":7,"./snowboarder":8,"./sprite":9,"./spriteInfo":10}],6:[function(e,t,n){var r=e("./sprite");(function(e){function t(e){function u(e){s+=1,t.isEating=!0,t.isMoving=!1,s<6?setTimeout(function(){u(e)},300):(s=0,t.isEating=!1,t.isMoving=!0,e())}var t=new r(e),n=t.superior("draw"),i=1,s=0,o=6;return t.isEating=!1,t.isFull=!1,t.setSpeed(o),t.draw=function(e){var r=function(){var e=t.movingToward[0]-t.canvasX;if(t.isEating)return"eating"+s;i+.1>2?i=.1:i+=.1;if(e>=0)return"sEast"+Math.ceil(i);if(e<0)return"sWest"+Math.ceil(i)};return n(e,r())},t.startEating=u,t}e.monster=t})(this),typeof t!="undefined"&&(t.exports=this.monster)},{"./sprite":9}],7:[function(e,t,n){var r=e("./sprite");navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,function(e){function t(e){function g(){t.setSpeed(l),t.isMoving=!0,t.hasBeenHit=!1,t.isJumping=!1,t.isPerformingTrick=!1,o&&clearInterval(o),t.setMapPosition(undefined,undefined,0)}function y(){t.isMoving=!1,t.hasBeenHit=!0,t.isJumping=!1,t.isPerformingTrick=!1,o&&clearInterval(o),t.setMapPosition(undefined,undefined,0)}function b(){var e=t.getSpeed();t.setSpeed(e+2),t.setSpeedY(e+2),t.isMoving=!0,t.hasBeenHit=!1,t.isJumping=!0,t.setMapPosition(undefined,undefined,1)}function w(){var e=t.movingToward[0]-t.mapPosition[0],n=t.movingToward[1]-t.mapPosition[1];return n<=0?e>0?"east":"west":i.esEast(e)?"esEast":i.sEast(e)?"sEast":i.wsWest(e)?"wsWest":i.sWest(e)?"sWest":"south"}function E(){return"blank"}function S(){return"jumping"}function x(){return console.log("Trick step is",m),m===0?"jumping":m===1?"somersault1":"somersault2"}function T(e,n,r){return r===0||r===1?n:(e<n&&(e+=t.getSpeed()*(r/c)),e>n&&(e-=t.getSpeed()*(r/c)),e)}var t=new r(e),n={draw:t.superior("draw"),cycle:t.superior("cycle"),getSpeedX:t.superior("getSpeedX"),getSpeedY:t.superior("getSpeedY"),hits:t.superior("hits")},i={esEast:function(e){return e>300},sEast:function(e){return e>75},wsWest:function(e){return e<-300},sWest:function(e){return e<-75}},s,o,u=!0,a=[],f=0,l=5,c=70,h=0,p=0,d=0,v=1,m=0;return t.isMoving=!0,t.hasBeenHit=!1,t.isJumping=!1,t.isPerformingTrick=!1,t.setSpeed(l),t.reset=function(){a=[],f=0,t.isMoving=!0,t.hasBeenHit=!1,u=!0,g()},t.setMapPositionTarget=function(e,n){if(t.hasBeenHit)return;n>t.mapPosition[1]?t.isMoving=!0:t.isMoving=!1,Math.abs(t.mapPosition[0]-e)<=75&&(e=t.mapPosition[0]),t.movingToward=[e,n]},t.setTurnEaseCycles=function(e){c=e},t.getPixelsTravelledDownMountain=function(){return f},t.resetSpeed=function(){t.setSpeed(l)},t.cycle=function(){t.isMoving&&(f+=t.speed),t.isJumping&&t.setMapPositionTarget(undefined,t.mapPosition[1]+t.getSpeed()),n.cycle(),t.checkHittableObjects()},t.draw=function(e){var r=function(){return t.isBeingEaten?E():t.isJumping?t.isPerformingTrick?x():S():t.hasBeenHit?"hit":w()};return n.draw(e,r())},t.hits=function(e){return a.indexOf(e.id)!==-1?!1:e.occupiesZIndex(t.mapPosition[2])?n.hits(e)?!0:!1:!1},t.speedBoost=function(){var e=t.speed;u&&(u=!1,t.setSpeed(t.speed*2),setTimeout(function(){t.setSpeed(e),setTimeout(function(){u=!0},1e4)},2e3))},t.attemptTrick=function(){t.isJumping&&(t.isPerformingTrick=!0,o=setInterval(function(){m>=2?m=0:m+=1},300))},t.getSpeedX=function(){return w()==="esEast"||w()==="wsWest"?(p=.5,h=T(h,t.getSpeed()*p,p),h):w()==="sEast"||w()==="sWest"?(p=.33,h=T(h,t.getSpeed()*p,p),h):(h=T(h,0,p),h)},t.setSpeedY=function(e){d=e},t.getSpeedY=function(){var e;return t.isJumping?d:w()==="esEast"||w()==="wsWest"?(v=.6,d=T(d,t.getSpeed()*.6,.6),d):w()==="sEast"||w()==="sWest"?(v=.85,d=T(d,t.getSpeed()*.85,.85),d):w()==="east"||w()==="west"?(v=1,d=0,d):(d=T(d,t.getSpeed(),v),d)},t.hasHitObstacle=function(e){y(),navigator.vibrate&&navigator.vibrate(500),a.push(e.id),t.resetSpeed(),s&&clearTimeout(s),s=setTimeout(function(){g()},1500)},t.hasHitJump=function(){b(),s&&clearTimeout(s),s=setTimeout(function(){g()},1e3)},t.isEatenBy=function(e,n){t.hasHitObstacle(e),e.startEating(n),a.push(e.id),t.isMoving=!1,t.isBeingEaten=!0},t.reset=function(){a=[],f=0,t.isMoving=!0,t.isJumping=!1,t.hasBeenHit=!1,u=!0},t}e.skier=t}(this),typeof t!="undefined"&&(t.exports=this.skier)},{"./sprite":9}],8:[function(e,t,n){var r=e("./sprite");(function(e){function t(e){function o(){var e=t.movingToward[0]-t.mapPosition[0],n=t.movingToward[1]-t.mapPosition[1];return i.sEast(e)?"sEast":"sWest"}var t=new r(e),n={draw:t.superior("draw"),cycle:t.superior("cycle")},i={sEast:function(e){return e>0},sWest:function(e){return e<=0}},s=3;return t.setSpeed(s),t.cycle=function(e){Number.random(10)===1&&(t.setMapPositionTarget(e.getRandomlyInTheCentreOfMap()),t.setSpeed(s+Number.random(-1,1))),t.setMapPositionTarget(undefined,e.getMapBelowViewport()+600),n.cycle()},t.draw=function(e){var t=function(){return o()};return n.draw(e,t())},t}e.snowboarder=t})(this),typeof t!="undefined"&&(t.exports=this.snowboarder)},{"./sprite":9}],9:[function(e,t,n){(function(t){function r(e){function u(e){i.canvasX+=e.toNumber()}function a(e){i.canvasY+=e.toNumber()}function f(t){if(i.data.hitBoxes&&e.hitBoxes[t])return e.hitBoxes[t]}function l(){if(!i.isMoving)return;var e=i.mapPosition[0],t=i.mapPosition[1];if(!o||typeof i.movingToward[0]!="undefined"||typeof i.movingToward[1]!="undefined")typeof i.movingToward[0]!="undefined"&&(e>i.movingToward[0]?e-=Math.min(i.getSpeedX(),Math.abs(e-i.movingToward[0])):e<i.movingToward[0]&&(e+=Math.min(i.getSpeedX(),Math.abs(e-i.movingToward[0])))),typeof i.movingToward[1]!="undefined"&&(t>i.movingToward[1]?t-=Math.min(i.getSpeedY(),Math.abs(t-i.movingToward[1])):t<i.movingToward[1]&&(t+=Math.min(i.getSpeedY(),Math.abs(t-i.movingToward[1]))));i.setMapPosition(e,t)}var t={},r=[0],i=this,s,o;return i.mapPosition=[0,0,0],i.id=n(),i.canvasX=0,i.canvasY=0,i.canvasZ=0,i.height=0,i.speed=0,i.data=e||{parts:{}},i.movingToward=[0,0],i.metresDownTheMountain=0,i.movingWithConviction=!1,i.deleted=!1,i.maxHeight=function(){return Object.values(i.data.parts).map(function(e){return e[3]}).max()}(),i.isMoving=!0,i.data.parts||(i.data.parts={}),e&&e.id&&(i.id=e.id),e&&e.zIndexesOccupied&&(r=e.zIndexesOccupied),this.draw=function(e,t){var n=i.data.parts[t];i.height=n[3],i.width=n[2];var r=e.mapPositionToCanvasPosition(i.mapPosition);i.setCanvasPosition(r[0],r[1]),e.drawImage(e.getLoadedImage(i.data.$imageFile),n[0],n[1],n[2],n[3],i.canvasX,i.canvasY,n[2],n[3])},this.setMapPosition=function(e,t,n){typeof e=="undefined"&&(e=i.mapPosition[0]),typeof t=="undefined"&&(t=i.mapPosition[1]),typeof n=="undefined"?n=i.mapPosition[2]:i.zIndexesOccupied=[n],i.mapPosition=[e,t,n]},this.setCanvasPosition=function(e,t){e&&(!Object.isString(e)||e.first()!=="+"&&e.first()!=="-"?i.canvasX=e:u(e)),t&&(!Object.isString(t)||t.first()!=="+"&&t.first()!=="-"?i.canvasY=t:a(t))},this.getCanvasPositionX=function(){return i.canvasX},this.getCanvasPositionY=function(){return i.canvasY},this.getLeftHitBoxEdge=function(e){e=e||0;var t=this.getCanvasPositionX();return f(e)&&(t+=f(e)[0]),t},this.getTopHitBoxEdge=function(e){e=e||0;var t=this.getCanvasPositionY();return f(e)&&(t+=f(e)[1]),t},this.getRightHitBoxEdge=function(e){return e=e||0,f(e)?i.canvasX+f(e)[2]:i.canvasX+i.width},this.getBottomHitBoxEdge=function(e){return e=e||0,f(e)?i.canvasY+f(e)[3]:i.canvasY+i.height},this.getPositionInFrontOf=function(){return[i.canvasX,i.canvasY+i.height]},this.setSpeed=function(e){i.speed=e,i.speedX=e,i.speedY=e},this.incrementSpeedBy=function(e){i.speed+=e},i.getSpeed=function(){return i.speed},i.getSpeedX=function(){return i.speed},i.getSpeedY=function(){return i.speed},this.setHeight=function(e){i.height=e},this.setWidth=function(e){i.width=e},this.getMaxHeight=function(){return i.maxHeight},i.getMovingTowardOpposite=function(){if(!i.isMoving)return[0,0];var e=i.movingToward[0]-i.mapPosition[0],t=i.movingToward[1]-i.mapPosition[1],n=Math.abs(e)>75?0-e:0,r=-t;return[n,r]},this.checkHittableObjects=function(){Object.keys(t,function(e,n){n.object.deleted?delete t[e]:n.object.hits(i)&&n.callbacks.each(function(e){e(i,n.object)})})},this.cycle=function(){i.checkHittableObjects(),s&&i.setMapPositionTarget(s.mapPosition[0],s.mapPosition[1],!0),l()},this.setMapPositionTarget=function(e,t,n){n&&(i.movingWithConviction=!1),i.movingWithConviction||(typeof e=="undefined"&&(e=i.movingToward[0]),typeof t=="undefined"&&(t=i.movingToward[1]),i.movingToward=[e,t],i.movingWithConviction=!1)},this.setDirection=function(e){e>=360&&(e=360-e),o=e},this.setMapPositionTargetWithConviction=function(e,t){i.setMapPositionTarget(e,t),i.movingWithConviction=!0},this.follow=function(e){s=e},this.stopFollowing=function(){s=!1},this.onHitting=function(e,n){if(t[e.id])return t[e.id].callbacks.push(n);t[e.id]={object:e,callbacks:[n]}},this.deleteOnNextCycle=function(){i.deleted=!0},this.occupiesZIndex=function(e){return r.indexOf(e)>=0},this.hits=function(e){var t=!1,n=!1;return e.getTopHitBoxEdge(i.mapPosition[2])<=i.getBottomHitBoxEdge(i.mapPosition[2])&&e.getBottomHitBoxEdge(i.mapPosition[2])>=i.getBottomHitBoxEdge(i.mapPosition[2])&&(t=!0),e.getTopHitBoxEdge(i.mapPosition[2])<=i.getTopHitBoxEdge(i.mapPosition[2])&&e.getBottomHitBoxEdge(i.mapPosition[2])>=i.getTopHitBoxEdge(i.mapPosition[2])&&(t=!0),e.getLeftHitBoxEdge(i.mapPosition[2])<=i.getRightHitBoxEdge(i.mapPosition[2])&&e.getRightHitBoxEdge(i.mapPosition[2])>=i.getRightHitBoxEdge(i.mapPosition[2])&&(n=!0),e.getLeftHitBoxEdge(i.mapPosition[2])<=i.getLeftHitBoxEdge(i.mapPosition[2])&&e.getRightHitBoxEdge(i.mapPosition[2])>=i.getLeftHitBoxEdge(i.mapPosition[2])&&(n=!0),t&&n},this.isAboveOnCanvas=function(e){return i.canvasY+i.height<e},this.isBelowOnCanvas=function(e){return i.canvasY>e},i}var n=e("./lib/guid");t.sprite=r})(this),typeof t!="undefined"&&(t.exports=this.sprite)},{"./lib/guid":3}],10:[function(e,t,n){(function(e){function n(e){e.deleteOnNextCycle()}function r(e,t){t.deleteOnNextCycle()}function i(e,t){e.hasHitObstacle(t)}function s(e,t){t.hasHitObstacle(e)}function o(e,t){t.hasHitObstacle(e)}function u(e,t){e.hasHitJump(t)}function a(e,t){t.hasHitJump(e)}function f(e,t){t.hasHitObstacle(e)}var t={skier:{$imageFile:"sprite-characters.png",parts:{blank:[0,0,0,0],east:[0,0,24,34],esEast:[24,0,24,34],sEast:[49,0,17,34],south:[65,0,17,34],sWest:[49,37,17,34],wsWest:[24,37,24,34],west:[0,37,24,34],hit:[0,78,31,31],jumping:[84,0,32,34],somersault1:[116,0,32,34],somersault2:[148,0,32,34]},hitBoxes:{0:[7,20,27,34]},id:"player",hitBehaviour:{}},smallTree:{$imageFile:"skifree-objects.png",parts:{main:[0,28,30,34]},hitBoxes:{0:[0,18,30,34]},hitBehaviour:{}},tallTree:{$imageFile:"skifree-objects.png",parts:{main:[95,66,32,64]},zIndexesOccupied:[0,1],hitBoxes:{0:[0,54,32,64],1:[0,10,32,54]},hitBehaviour:{}},thickSnow:{$imageFile:"skifree-objects.png",parts:{main:[143,53,43,10]},hitBehaviour:{}},rock:{$imageFile:"skifree-objects.png",parts:{main:[30,52,23,11]},hitBehaviour:{}},monster:{$imageFile:"sprite-characters.png",parts:{sEast1:[64,112,26,43],sEast2:[90,112,32,43],sWest1:[64,158,26,43],sWest2:[90,158,32,43],eating1:[122,112,34,43],eating2:[156,112,31,43],eating3:[187,112,31,43],eating4:[219,112,25,43],eating5:[243,112,26,43]},hitBehaviour:{}},jump:{$imageFile:"skifree-objects.png",parts:{main:[109,55,32,8]},hitBehaviour:{}},signStart:{$imageFile:"skifree-objects.png",parts:{main:[260,103,42,27]},hitBehaviour:{}},snowboarder:{$imageFile:"sprite-characters.png",parts:{sEast:[73,229,20,29],sWest:[95,228,26,30]},hitBehaviour:{}}};t.monster.hitBehaviour.tree=n,t.smallTree.hitBehaviour.monster=r,t.tallTree.hitBehaviour.monster=r,t.smallTree.hitBehaviour.skier=s,t.tallTree.hitBehaviour.skier=s,t.rock.hitBehaviour.skier=o,t.jump.hitBehaviour.skier=a,t.snowboarder.hitBehaviour.skier=f,e.spriteInfo=t})(this),typeof t!="undefined"&&(t.exports=this.spriteInfo)},{}],11:[function(e,t,n){(function(r){(function(){function a(e){var t=1,n=o.min(e);while(t!==0)t=o.reduce(e,function(e,t){return e+t%n},0),t!==0&&(n-=10);return n}function f(e){var t=u.exec(e);if(!t)throw new Error("I don't understand that particular interval");var n=+t[1],r=t[2]||"ms";if(r==="s")n*=1e3;else if(r==="m")n=n*1e3*60;else if(r==="h")n=n*1e3*60*60;else if(!!r&&r!=="ms")throw new Error("You can only specify intervals of ms, s, m, or h");if(n<10||n%10!==0)throw new Error("You can only specify 10s of milliseconds, trust me on this one");return{amount:n,type:r}}function l(){this.intervalId=undefined,this.intervalLength=undefined,this.intervalsToEmit={},this.currentTick=1,this.maxTicks=0,this.listeningForFocus=!1;var e=function(){var e=a(o.keys(this.intervalsToEmit)),t=!1;return this.intervalLength?e!==this.intervalLength&&(this.intervalLength=e,t=!0):this.intervalLength=e,this.maxTicks=o.max(o.map(o.keys(this.intervalsToEmit),function(e){return+e}))/this.intervalLength,t}.bind(this);this.on("newListener",function(t){if(t==="removeListener"||t==="newListener")return;var n=f(t),r=n.amount;this.intervalsToEmit[+r]=o.union(this.intervalsToEmit[+r]||[],[t]),e()&&this.isStarted()&&this.stop().start()}),this.on("removeListener",function(t){if(s.listenerCount(this,t)>0)return;var n=f(t),r=n.amount,i=this.intervalsToEmit[+r].removeOne(t);this.intervalsToEmit[+r].length===0&&delete this.intervalsToEmit[+r],console.log("Determining interval length after removal of",i),e(),e()&&this.isStarted()&&this.stop().start()})}var i=this,s=e("events").EventEmitter,o=e("underscore"),u=/([0-9\.]+)(ms|s|m|h)?/,i=r||window;typeof Function.prototype.inherits=="undefined"&&(Function.prototype.inherits=function(e){this.prototype=Object.create(e.prototype)}),typeof Array.prototype.removeOne=="undefined"&&(Array.prototype.removeOne=function(){var e,t=arguments,n=t.length,r;while(n&&this.length){e=t[--n];while((r=this.indexOf(e))!==-1)return this.splice(r,1)}}),l.inherits(s),l.prototype.tick=function(){var e=this.currentTick*this.intervalLength;return o.each(this.intervalsToEmit,function(t,n){e%n===0&&o.each(t,function(e){this.emit(e,e,n)}.bind(this))}.bind(this)),this.currentTick+=1,this.currentTick>this.maxTicks&&(this.currentTick=1),this},l.prototype.start=function(){if(!this.intervalLength)throw new Error("You haven't specified any interval callbacks. Use EventedLoop.on('500ms', function () { ... }) to do so, and then you can start");return this.intervalId?console.log("No need to start the loop again, it's already started."):(this.intervalId=setInterval(this.tick.bind(this),this.intervalLength),i&&!this.listeningForFocus&&i.addEventListener&&(i.addEventListener("focus",function(){this.start()}.bind(this)),i.addEventListener("blur",function(){this.stop()}.bind(this)),this.listeningForFocus=!0),this)},l.prototype.stop=function(){return clearInterval(this.intervalId),this.intervalId=undefined,this},l.prototype.isStarted=function(){return!!this.intervalId},l.prototype.every=l.prototype.on,typeof n!="undefined"&&(typeof t!="undefined"&&t.exports&&(n=t.exports=l),n.EventedLoop=l),typeof window!="undefined"&&(window.EventedLoop=l)}).call(this)}).call(this,typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{events:13,underscore:12}],12:[function(e,t,n){(function(){var e=this,r=e._,i={},s=Array.prototype,o=Object.prototype,u=Function.prototype,a=s.push,f=s.slice,l=s.concat,c=o.toString,h=o.hasOwnProperty,p=s.forEach,d=s.map,v=s.reduce,m=s.reduceRight,g=s.filter,y=s.every,b=s.some,w=s.indexOf,E=s.lastIndexOf,S=Array.isArray,x=Object.keys,T=u.bind,N=function(e){if(e instanceof N)return e;if(!(this instanceof N))return new N(e);this._wrapped=e};typeof n!="undefined"?(typeof t!="undefined"&&t.exports&&(n=t.exports=N),n._=N):e._=N,N.VERSION="1.6.0";var C=N.each=N.forEach=function(e,t,n){if(e==null)return e;if(p&&e.forEach===p)e.forEach(t,n);else if(e.length===+e.length){for(var r=0,s=e.length;r<s;r++)if(t.call(n,e[r],r,e)===i)return}else{var o=N.keys(e);for(var r=0,s=o.length;r<s;r++)if(t.call(n,e[o[r]],o[r],e)===i)return}return e};N.map=N.collect=function(e,t,n){var r=[];return e==null?r:d&&e.map===d?e.map(t,n):(C(e,function(e,i,s){r.push(t.call(n,e,i,s))}),r)};var k="Reduce of empty array with no initial value";N.reduce=N.foldl=N.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(v&&e.reduce===v)return r&&(t=N.bind(t,r)),i?e.reduce(t,n):e.reduce(t);C(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError(k);return n},N.reduceRight=N.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(m&&e.reduceRight===m)return r&&(t=N.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=N.keys(e);s=o.length}C(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError(k);return n},N.find=N.detect=function(e,t,n){var r;return L(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},N.filter=N.select=function(e,t,n){var r=[];return e==null?r:g&&e.filter===g?e.filter(t,n):(C(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)}),r)},N.reject=function(e,t,n){return N.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},N.every=N.all=function(e,t,n){t||(t=N.identity);var r=!0;return e==null?r:y&&e.every===y?e.every(t,n):(C(e,function(e,s,o){if(!(r=r&&t.call(n,e,s,o)))return i}),!!r)};var L=N.some=N.any=function(e,t,n){t||(t=N.identity);var r=!1;return e==null?r:b&&e.some===b?e.some(t,n):(C(e,function(e,s,o){if(r||(r=t.call(n,e,s,o)))return i}),!!r)};N.contains=N.include=function(e,t){return e==null?!1:w&&e.indexOf===w?e.indexOf(t)!=-1:L(e,function(e){return e===t})},N.invoke=function(e,t){var n=f.call(arguments,2),r=N.isFunction(t);return N.map(e,function(e){return(r?t:e[t]).apply(e,n)})},N.pluck=function(e,t){return N.map(e,N.property(t))},N.where=function(e,t){return N.filter(e,N.matches(t))},N.findWhere=function(e,t){return N.find(e,N.matches(t))},N.max=function(e,t,n){if(!t&&N.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);var r=-Infinity,i=-Infinity;return C(e,function(e,s,o){var u=t?t.call(n,e,s,o):e;u>i&&(r=e,i=u)}),r},N.min=function(e,t,n){if(!t&&N.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);var r=Infinity,i=Infinity;return C(e,function(e,s,o){var u=t?t.call(n,e,s,o):e;u<i&&(r=e,i=u)}),r},N.shuffle=function(e){var t,n=0,r=[];return C(e,function(e){t=N.random(n++),r[n-1]=r[t],r[t]=e}),r},N.sample=function(e,t,n){return t==null||n?(e.length!==+e.length&&(e=N.values(e)),e[N.random(e.length-1)]):N.shuffle(e).slice(0,Math.max(0,t))};var A=function(e){return e==null?N.identity:N.isFunction(e)?e:N.property(e)};N.sortBy=function(e,t,n){return t=A(t),N.pluck(N.map(e,function(e,r,i){return{value:e,index:r,criteria:t.call(n,e,r,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index-t.index}),"value")};var O=function(e){return function(t,n,r){var i={};return n=A(n),C(t,function(s,o){var u=n.call(r,s,o,t);e(i,u,s)}),i}};N.groupBy=O(function(e,t,n){N.has(e,t)?e[t].push(n):e[t]=[n]}),N.indexBy=O(function(e,t,n){e[t]=n}),N.countBy=O(function(e,t){N.has(e,t)?e[t]++:e[t]=1}),N.sortedIndex=function(e,t,n,r){n=A(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},N.toArray=function(e){return e?N.isArray(e)?f.call(e):e.length===+e.length?N.map(e,N.identity):N.values(e):[]},N.size=function(e){return e==null?0:e.length===+e.length?e.length:N.keys(e).length},N.first=N.head=N.take=function(e,t,n){return e==null?void 0:t==null||n?e[0]:t<0?[]:f.call(e,0,t)},N.initial=function(e,t,n){return f.call(e,0,e.length-(t==null||n?1:t))},N.last=function(e,t,n){return e==null?void 0:t==null||n?e[e.length-1]:f.call(e,Math.max(e.length-t,0))},N.rest=N.tail=N.drop=function(e,t,n){return f.call(e,t==null||n?1:t)},N.compact=function(e){return N.filter(e,N.identity)};var M=function(e,t,n){return t&&N.every(e,N.isArray)?l.apply(n,e):(C(e,function(e){N.isArray(e)||N.isArguments(e)?t?a.apply(n,e):M(e,t,n):n.push(e)}),n)};N.flatten=function(e,t){return M(e,t,[])},N.without=function(e){return N.difference(e,f.call(arguments,1))},N.partition=function(e,t){var n=[],r=[];return C(e,function(e){(t(e)?n:r).push(e)}),[n,r]},N.uniq=N.unique=function(e,t,n,r){N.isFunction(t)&&(r=n,n=t,t=!1);var i=n?N.map(e,n,r):e,s=[],o=[];return C(i,function(n,r){if(t?!r||o[o.length-1]!==n:!N.contains(o,n))o.push(n),s.push(e[r])}),s},N.union=function(){return N.uniq(N.flatten(arguments,!0))},N.intersection=function(e){var t=f.call(arguments,1);return N.filter(N.uniq(e),function(e){return N.every(t,function(t){return N.contains(t,e)})})},N.difference=function(e){var t=l.apply(s,f.call(arguments,1));return N.filter(e,function(e){return!N.contains(t,e)})},N.zip=function(){var e=N.max(N.pluck(arguments,"length").concat(0)),t=new Array(e);for(var n=0;n<e;n++)t[n]=N.pluck(arguments,""+n);return t},N.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},N.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=N.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(w&&e.indexOf===w)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},N.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(E&&e.lastIndexOf===E)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},N.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var _=function(){};N.bind=function(e,t){var n,r;if(T&&e.bind===T)return T.apply(e,f.call(arguments,1));if(!N.isFunction(e))throw new TypeError;return n=f.call(arguments,2),r=function(){if(this instanceof r){_.prototype=e.prototype;var i=new _;_.prototype=null;var s=e.apply(i,n.concat(f.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(f.call(arguments)))}},N.partial=function(e){var t=f.call(arguments,1);return function(){var n=0,r=t.slice();for(var i=0,s=r.length;i<s;i++)r[i]===N&&(r[i]=arguments[n++]);while(n<arguments.length)r.push(arguments[n++]);return e.apply(this,r)}},N.bindAll=function(e){var t=f.call(arguments,1);if(t.length===0)throw new Error("bindAll must be passed function names");return C(t,function(t){e[t]=N.bind(e[t],e)}),e},N.memoize=function(e,t){var n={};return t||(t=N.identity),function(){var r=t.apply(this,arguments);return N.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},N.delay=function(e,t){var n=f.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},N.defer=function(e){return N.delay.apply(N,[e,1].concat(f.call(arguments,1)))},N.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:N.now(),o=null,s=e.apply(r,i),r=i=null};return function(){var f=N.now();!u&&n.leading===!1&&(u=f);var l=t-(f-u);return r=this,i=arguments,l<=0?(clearTimeout(o),o=null,u=f,s=e.apply(r,i),r=i=null):!o&&n.trailing!==!1&&(o=setTimeout(a,l)),s}},N.debounce=function(e,t,n){var r,i,s,o,u,a=function(){var f=N.now()-o;f<t?r=setTimeout(a,t-f):(r=null,n||(u=e.apply(s,i),s=i=null))};return function(){s=this,i=arguments,o=N.now();var f=n&&!r;return r||(r=setTimeout(a,t)),f&&(u=e.apply(s,i),s=i=null),u}},N.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},N.wrap=function(e,t){return N.partial(t,e)},N.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},N.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},N.keys=function(e){if(!N.isObject(e))return[];if(x)return x(e);var t=[];for(var n in e)N.has(e,n)&&t.push(n);return t},N.values=function(e){var t=N.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=e[t[i]];return r},N.pairs=function(e){var t=N.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},N.invert=function(e){var t={},n=N.keys(e);for(var r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},N.functions=N.methods=function(e){var t=[];for(var n in e)N.isFunction(e[n])&&t.push(n);return t.sort()},N.extend=function(e){return C(f.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},N.pick=function(e){var t={},n=l.apply(s,f.call(arguments,1));return C(n,function(n){n in e&&(t[n]=e[n])}),t},N.omit=function(e){var t={},n=l.apply(s,f.call(arguments,1));for(var r in e)N.contains(n,r)||(t[r]=e[r]);return t},N.defaults=function(e){return C(f.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e},N.clone=function(e){return N.isObject(e)?N.isArray(e)?e.slice():N.extend({},e):e},N.tap=function(e,t){return t(e),e};var D=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof N&&(e=e._wrapped),t instanceof N&&(t=t._wrapped);var i=c.call(e);if(i!=c.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;var o=e.constructor,u=t.constructor;if(o!==u&&!(N.isFunction(o)&&o instanceof 
o&&N.isFunction(u)&&u instanceof u)&&"constructor"in e&&"constructor"in t)return!1;n.push(e),r.push(t);var a=0,f=!0;if(i=="[object Array]"){a=e.length,f=a==t.length;if(f)while(a--)if(!(f=D(e[a],t[a],n,r)))break}else{for(var l in e)if(N.has(e,l)){a++;if(!(f=N.has(t,l)&&D(e[l],t[l],n,r)))break}if(f){for(l in t)if(N.has(t,l)&&!(a--))break;f=!a}}return n.pop(),r.pop(),f};N.isEqual=function(e,t){return D(e,t,[],[])},N.isEmpty=function(e){if(e==null)return!0;if(N.isArray(e)||N.isString(e))return e.length===0;for(var t in e)if(N.has(e,t))return!1;return!0},N.isElement=function(e){return!!e&&e.nodeType===1},N.isArray=S||function(e){return c.call(e)=="[object Array]"},N.isObject=function(e){return e===Object(e)},C(["Arguments","Function","String","Number","Date","RegExp"],function(e){N["is"+e]=function(t){return c.call(t)=="[object "+e+"]"}}),N.isArguments(arguments)||(N.isArguments=function(e){return!!e&&!!N.has(e,"callee")}),typeof /./!="function"&&(N.isFunction=function(e){return typeof e=="function"}),N.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},N.isNaN=function(e){return N.isNumber(e)&&e!=+e},N.isBoolean=function(e){return e===!0||e===!1||c.call(e)=="[object Boolean]"},N.isNull=function(e){return e===null},N.isUndefined=function(e){return e===void 0},N.has=function(e,t){return h.call(e,t)},N.noConflict=function(){return e._=r,this},N.identity=function(e){return e},N.constant=function(e){return function(){return e}},N.property=function(e){return function(t){return t[e]}},N.matches=function(e){return function(t){if(t===e)return!0;for(var n in e)if(e[n]!==t[n])return!1;return!0}},N.times=function(e,t,n){var r=Array(Math.max(0,e));for(var i=0;i<e;i++)r[i]=t.call(n,i);return r},N.random=function(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},N.now=Date.now||function(){return(new Date).getTime()};var P={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};P.unescape=N.invert(P.escape);var H={escape:new RegExp("["+N.keys(P.escape).join("")+"]","g"),unescape:new RegExp("("+N.keys(P.unescape).join("|")+")","g")};N.each(["escape","unescape"],function(e){N[e]=function(t){return t==null?"":(""+t).replace(H[e],function(t){return P[e][t]})}}),N.result=function(e,t){if(e==null)return void 0;var n=e[t];return N.isFunction(n)?n.call(e):n},N.mixin=function(e){C(N.functions(e),function(t){var n=N[t]=e[t];N.prototype[t]=function(){var e=[this._wrapped];return a.apply(e,arguments),q.call(this,n.apply(N,e))}})};var B=0;N.uniqueId=function(e){var t=++B+"";return e?e+t:t},N.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var j=/(.)^/,F={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},I=/\\|'|\r|\n|\t|\u2028|\u2029/g;N.template=function(e,t,n){var r;n=N.defaults({},n,N.templateSettings);var i=new RegExp([(n.escape||j).source,(n.interpolate||j).source,(n.evaluate||j).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(I,function(e){return"\\"+F[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,N);var a=function(e){return r.call(this,e,N)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},N.chain=function(e){return N(e).chain()};var q=function(e){return this._chain?N(e).chain():e};N.mixin(N),C(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=s[e];N.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],q.call(this,n)}}),C(["concat","join","slice"],function(e){var t=s[e];N.prototype[e]=function(){return q.call(this,t.apply(this._wrapped,arguments))}}),N.extend(N.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),typeof define=="function"&&define.amd&&define("underscore",[],function(){return N})}).call(this)},{}],13:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||undefined}function i(e){return typeof e=="function"}function s(e){return typeof e=="number"}function o(e){return typeof e=="object"&&e!==null}function u(e){return e===void 0}t.exports=r,r.EventEmitter=r,r.prototype._events=undefined,r.prototype._maxListeners=undefined,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!s(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,s,a,f;this._events||(this._events={});if(e==="error")if(!this._events.error||o(this._events.error)&&!this._events.error.length)throw t=arguments[1],t instanceof Error?t:TypeError('Uncaught, unspecified "error" event.');n=this._events[e];if(u(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:r=arguments.length,s=new Array(r-1);for(a=1;a<r;a++)s[a-1]=arguments[a];n.apply(this,s)}else if(o(n)){r=arguments.length,s=new Array(r-1);for(a=1;a<r;a++)s[a-1]=arguments[a];f=n.slice(),r=f.length;for(a=0;a<r;a++)f[a].apply(this,s)}return!0},r.prototype.addListener=function(e,t){var n;if(!i(t))throw TypeError("listener must be a function");this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t;if(o(this._events[e])&&!this._events[e].warned){var n;u(this._maxListeners)?n=r.defaultMaxListeners:n=this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}return this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var n=!1;return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var n,r,s,u;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;n=this._events[e],s=n.length,r=-1;if(n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(u=s;u-->0;)if(n[u]===t||n[u].listener&&n[u].listener===t){r=u;break}if(r<0)return this;n.length===1?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[e]&&delete this._events[e],this;if(arguments.length===0){for(t in this._events){if(t==="removeListener")continue;this.removeAllListeners(t)}return this.removeAllListeners("removeListener"),this._events={},this}n=this._events[e];if(i(n))this.removeListener(e,n);else while(n.length)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return!this._events||!this._events[e]?t=[]:i(this._events[e])?t=[this._events[e]]:t=this._events[e].slice(),t},r.listenerCount=function(e,t){var n;return!e._events||!e._events[t]?n=0:i(e._events[t])?n=1:n=e._events[t].length,n}},{}]},{},[5]);